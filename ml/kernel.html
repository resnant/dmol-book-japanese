
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<meta content="Deep Learning for Molecules &amp; Materials Book" lang="en" name="description" xml:lang="en" />
<meta content="en_US" property="og:locale" />
<meta content="summary" name="twitter:card" />
<meta content="Deep Learning for Molecules &amp; Materials Book" name="twitter:description" />
<meta content="dmol.pub ğŸ“–" name="twitter:title" />
<meta content="https://dmol.pub/_static/logo.png" name="twitter:image" />
<meta content="&#64;andrewwhite01" name="twitter:site" />

    <title>5. ã‚«ãƒ¼ãƒãƒ«å­¦ç¿’ &#8212; deep learning for molecules &amp; materials</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/a11y.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/custom.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="canonical" href="https://resnant.github.io/dmol-book-japanese/ml/kernel.html" />
    <link rel="shortcut icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6. ãƒ‡ã‚£ãƒ¼ãƒ—ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°ã®æ¦‚è¦" href="../dl/introduction.html" />
    <link rel="prev" title="4. Classification" href="classification.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">deep learning for molecules & materials</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   ã“ã®æœ¬ã®æ¦‚è¦
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  A. Math Review
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../math/tensors-and-shapes.html">
   1. Tensors and Shapes
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  B. Machine Learning
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="introduction.html">
   2. æ©Ÿæ¢°å­¦ç¿’å…¥é–€
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="regression.html">
   3. Regression &amp; Model Assessment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="classification.html">
   4. Classification
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   5. ã‚«ãƒ¼ãƒãƒ«å­¦ç¿’
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  C. Deep Learning
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../dl/introduction.html">
   6. ãƒ‡ã‚£ãƒ¼ãƒ—ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°ã®æ¦‚è¦
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dl/layers.html">
   7. Standard Layers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dl/gnn.html">
   8. Graph Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dl/data.html">
   9. Input Data &amp; Equivariances
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dl/Equivariant.html">
   10. Equivariant Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dl/molnets.html">
   11. Modern Molecular NNs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dl/xai.html">
   12. äºˆæ¸¬ã‚’èª¬æ˜ã™ã‚‹
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dl/attention.html">
   13. ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ãƒ¬ã‚¤ãƒ¤ãƒ¼
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dl/NLP.html">
   15. Deep Learning on Sequences
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dl/VAE.html">
   16. Variational Autoencoder
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dl/flows.html">
   17. Normalizing Flows
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  D. Applications
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../applied/QM9.html">
   18. GNNã«ã‚ˆã‚‹DFTã‚¨ãƒãƒ«ã‚®ãƒ¼ã®äºˆæ¸¬
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../applied/MolGenerator.html">
   19. Generative RNN in Browser
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  E. Contributed Chapters
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../dl/Hyperparameter_tuning.html">
   20. Hyperparameter Tuning
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  F. Appendix
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../style.html">
   21. Style Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../changelog.html">
   22. Changelog
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  <script async defer src="https://api.dmol.pub/latest.js"></script><noscript><img src="https://api.dmol.pub/noscript.gif" alt="" referrerpolicy="no-referrer-when-downgrade" /></noscript> By <a href="https://twitter.com/andrewwhite01">Andrew White</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/ml/kernel.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/resnant/dmol-book-japanese/"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/resnant/dmol-book-japanese//issues/new?title=Issue%20on%20page%20%2Fml/kernel.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/resnant/dmol-book-japanese/blob/master/ml/kernel.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   5.1. æº¶è§£åº¦ã®ä¾‹
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#notebook">
   5.2. Notebookã®å®Ÿè¡Œ
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id5">
   5.3. ã‚«ãƒ¼ãƒãƒ«ã®å®šç¾©
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id6">
   5.4. ãƒ¢ãƒ‡ãƒ«å®šç¾©
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id7">
   5.5. ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id8">
   5.6. æ­£å‰‡åŒ–
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id9">
   5.7. å­¦ç¿’æ›²ç·š
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id10">
   5.8. ç·´ç¿’å•é¡Œ
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id11">
   5.9. ç« ã®ã¾ã¨ã‚
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cited-references">
   5.10. Cited References
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>ã‚«ãƒ¼ãƒãƒ«å­¦ç¿’</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   5.1. æº¶è§£åº¦ã®ä¾‹
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#notebook">
   5.2. Notebookã®å®Ÿè¡Œ
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id5">
   5.3. ã‚«ãƒ¼ãƒãƒ«ã®å®šç¾©
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id6">
   5.4. ãƒ¢ãƒ‡ãƒ«å®šç¾©
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id7">
   5.5. ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id8">
   5.6. æ­£å‰‡åŒ–
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id9">
   5.7. å­¦ç¿’æ›²ç·š
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id10">
   5.8. ç·´ç¿’å•é¡Œ
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id11">
   5.9. ç« ã®ã¾ã¨ã‚
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cited-references">
   5.10. Cited References
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1><span class="section-number">5. </span>ã‚«ãƒ¼ãƒãƒ«å­¦ç¿’<a class="headerlink" href="#id1" title="Permalink to this headline">Â¶</a></h1>
<p>ã‚«ãƒ¼ãƒãƒ«å­¦ç¿’ã¯åˆ†é¡ã€ã¾ãŸã¯å›å¸°å•é¡Œã§ç‰¹å¾´é‡ã‚’å¤‰æ›ã™ã‚‹ï¼‘ã¤ã®æ–¹æ³•ã§ã™ã€‚å›å¸°å•é¡Œã§ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ãªå›å¸°å¼ã‚’ç”¨ã„ã¾ã™ã€‚</p>
<div class="amsmath math notranslate nohighlight" id="equation-d34be902-10ae-434a-a267-323e29443540">
<span class="eqno">(5.1)<a class="headerlink" href="#equation-d34be902-10ae-434a-a267-323e29443540" title="Permalink to this equation">Â¶</a></span>\[\begin{equation}
    \hat{y} = \vec{w}\vec{x} + b
\end{equation}\]</div>
<p>ã“ã“ã§ã€ <span class="math notranslate nohighlight">\(\vec{x}\)</span>ã¯æ¬¡å…ƒ<span class="math notranslate nohighlight">\(D\)</span>ã®ç‰¹å¾´ãƒ™ã‚¯ãƒˆãƒ«ã§ã™ã€‚ã‚«ãƒ¼ãƒãƒ«å­¦ç¿’ã§ã¯æ¬¡å…ƒ<span class="math notranslate nohighlight">\(D\)</span>ã®ç‰¹å¾´ãƒ™ã‚¯ãƒˆãƒ«ã‹ã‚‰æ¬¡å…ƒ<span class="math notranslate nohighlight">\(N\)</span>ã®<em>è¨“ç·´ãƒ‡ãƒ¼ã‚¿ç‚¹ã¸ã®è·é›¢</em>ã«å¤‰æ›ã—ã¾ã™ã€‚ã“ã®ã¨ãã®<span class="math notranslate nohighlight">\(N\)</span>ã¯è¨“ç·´ãƒ‡ãƒ¼ã‚¿ç‚¹ã®å€‹æ•°ã§ã™ã€‚</p>
<div class="amsmath math notranslate nohighlight" id="equation-e5d29b6e-c864-4113-a97d-54d536abc797">
<span class="eqno">(5.2)<a class="headerlink" href="#equation-e5d29b6e-c864-4113-a97d-54d536abc797" title="Permalink to this equation">Â¶</a></span>\[\begin{equation}
    \hat{y} = \sum_i^N w_i \left&lt;\vec{x}, \vec{x}_i\right&gt;+ b
\end{equation}\]</div>
<p>ä¸Šå¼ã®<span class="math notranslate nohighlight">\(\left&lt;\cdot\right&gt;\)</span>ã¯ï¼’ã¤ã®ç‰¹å¾´ãƒ™ã‚¯ãƒˆãƒ«é–“ã®è·é›¢ã§ã‚ã‚Š<span class="math notranslate nohighlight">\(\vec{x}_i\)</span>ã¯<span class="math notranslate nohighlight">\(i\)</span>ç•ªç›®ã®è¨“ç·´ãƒ‡ãƒ¼ã‚¿ç‚¹ã§ã™ã€‚<span class="math notranslate nohighlight">\(\vec{x}_i\)</span>ã¯æ—¢çŸ¥ã®å€¤ã§ã™ãŒã€<span class="math notranslate nohighlight">\(\vec{x}\)</span>ã¯é–¢æ•°ã®å¼•æ•°ã§ã™ã€‚</p>
<div class="admonition- admonition">
<p class="admonition-title">ã“ã®ç« ã®å¯¾è±¡èª­è€…ã¨ç›®çš„</p>
<p>ã“ã®ç« ã¯<a class="reference internal" href="regression.html"><span class="doc">Regression &amp; Model Assessment</span></a>ã¨<a class="reference internal" href="classification.html"><span class="doc">Classification</span></a>ã«åŸºã¥ã„ã¦é€²ã‚ã‚‰ã‚Œã¾ã™ã€‚ã“ã®ç« ã‚’ä¿®äº†ã™ã‚‹ã¨</p>
<ul class="simple">
<li><p>ä¸»å½¢å¼ã¨åŒå¯¾å½¢å¼ã®é•ã„ã‚’è¦‹æŠœã‘ã‚‰ã‚Œã¾ã™ã€‚</p></li>
<li><p>ã‚«ãƒ¼ãƒãƒ«å­¦ç¿’ãŒä¸Šæ‰‹ãã„ããã†ã ã¨æ€ã£ãŸã¨ãã«ã‚«ãƒ¼ãƒãƒ«å­¦ç¿’ã‚’ãƒãƒ§ã‚¤ã‚¹ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p></li>
<li><p>å­¦ç¿’æ›²ç·šã®åŸç†ã‚„è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚ºã¨ç‰¹å¾´é‡ã®å€‹æ•°ã®é–“ã®é–¢ä¿‚ã‚’ç†è§£ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p></li>
</ul>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>è·é›¢ã¨ã„ã†ãƒ¯ãƒ¼ãƒ‰ã‚’ä½¿ã£ã¦ã„ãã¾ã™ãŒå®Ÿéš›ã«ã¯<span class="math notranslate nohighlight">\(\left&lt;\cdot\right&gt;\)</span>ã¯å†…ç©ã§ã‚ã£ã¦è·é›¢ã‚ˆã‚Šã‚‚ãƒ•ãƒ¬ã‚­ã‚·ãƒ–ãƒ«ãªã‚‚ã®ã«ãªã‚Šã¾ã™ã€‚</p>
</aside>
<p>ã“ã®å¤‰æ›ã«ã‚ˆã‚‹å¸°çµã¨ã—ã¦ã€è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã®é‡ã¿ãƒ™ã‚¯ãƒˆãƒ«ãŒç‰¹å¾´é‡ã®å€‹æ•°ã«å…¨ãä¾å­˜ã—ãªããªã‚Šã¾ã™ã€‚**ãã®ä»£ã‚ã‚Šã«é‡ã¿ã®å€‹æ•°ã¯è¨“ç·´ãƒ‡ãƒ¼ã‚¿ç‚¹ã®å€‹æ•°ã«ä¾å­˜ã—ã¾ã™ã€‚**ã“ã‚ŒãŒã‚«ãƒ¼ãƒãƒ«å­¦ç¿’ã‚’ç”¨ã„ã‚‹ç†ç”±ã«ãªã‚Šã¾ã™ã€‚è¨“ç·´ãƒ‡ãƒ¼ã‚¿ãŒã»ã‚“ã®å°‘ã—ã—ã‹ãªã„ã®ã«ç‰¹å¾´é‡ãƒ™ã‚¯ãƒˆãƒ«ã®æ¬¡å…ƒãŒå¤§ãã„(<span class="math notranslate nohighlight">\(N &lt; D\)</span>)ã¨ã„ã£ãŸã“ã¨ã¯ã‚ˆãã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ã‚«ãƒ¼ãƒãƒ«å®šå¼åŒ–ã‚’ä½¿ã†ã“ã¨ã§é‡ã¿ã®å€‹æ•°ã‚’æ¸›ã‚‰ã™ã“ã¨ãŒã§ãã¾ã™ã€‚ç‰¹å¾´ç©ºé–“ãŒç·šå½¢æ–¹ç¨‹å¼ã§ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã™ã‚‹ã“ã¨ãŒå›°é›£ãªæ™‚ã§ã‚‚ã€ãã®ç‰¹å¾´ç©ºé–“ã‚’è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã¨ã®è·é›¢ã¨ã¿ãªã™ã“ã¨ã§ç·šå½¢ã¨ã—ã¦æ‰±ãˆã¾ã™(å¤šãã®å ´åˆã€<span class="math notranslate nohighlight">\(N &gt; D\)</span>)ã€‚æœ€å¾Œã«ã€ç‰¹å¾´ãƒ™ã‚¯ãƒˆãƒ«ãŒç„¡é™æ¬¡å…ƒ(i.e. ãƒ™ã‚¯ãƒˆãƒ«ã§ã¯ãªãé–¢æ•°ã®ã¨ã)ã¨ãªã£ãŸã‚Šã€ä½•ã‚‰ã‹ã®ç†ç”±ã§ç‰¹å¾´ãƒ™ã‚¯ãƒˆãƒ«ã‚’è¨ˆç®—ã§ããªã„ã¨ãã‚‚ã‚ã£ãŸã‚Šã—ã¾ã™ã€‚ã‚«ãƒ¼ãƒãƒ«å­¦ç¿’ã§ã¯ã€<em>ã‚«ãƒ¼ãƒãƒ«é–¢æ•°</em><span class="math notranslate nohighlight">\(\left&lt;\cdot\right&gt;\)</span>ã‚’å®šç¾©ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã ã‘ã§ç‰¹å¾´ãƒ™ã‚¯ãƒˆãƒ«ã‚’æ˜ç¤ºçš„ã«æ‰±ã†å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
<p>è·é›¢é–¢æ•°ã¯<em>ã‚«ãƒ¼ãƒãƒ«é–¢æ•°</em><span class="math notranslate nohighlight">\(\left&lt;\cdot\right&gt;\)</span>ã¨å‘¼ã°ã‚Œã¦ã„ã¾ã™ã€‚ã‚«ãƒ¼ãƒãƒ«é–¢æ•°ã¯äºŒå¤‰æ•°é–¢æ•°ï¼ˆï¼’ã¤ã®å¼•æ•°ã‚’å—ã‘å–ã‚‹ï¼‰ã§ã‚ã£ã¦ã‚¹ã‚«ãƒ©ãƒ¼å€¤ã‚’å‡ºåŠ›ã—ã€ä»¥ä¸‹ã®ã‚ˆã†ãªæ€§è³ªã‚’æŒã¡ã¾ã™ã€‚</p>
<ol class="simple">
<li><p>æ­£å®šæ€§(Positive): <span class="math notranslate nohighlight">\(\left&lt;x, x'\right&gt; \geq 0\)</span></p></li>
<li><p>å¯¾ç§°æ€§(Symmetric): <span class="math notranslate nohighlight">\(\left&lt;x, x'\right&gt; = \left&lt;x', x \right&gt;\)</span></p></li>
<li><p>Point-seperating: <span class="math notranslate nohighlight">\(\left&lt;x, x'\right&gt; = 0\)</span> if and only if <span class="math notranslate nohighlight">\(x = x'\)</span></p></li>
</ol>
<p>è¨³è€…æ³¨ï¼šPoint-separatingã«ãµã•ã‚ã—ã„è¨³èªãŒç„¡ã‹ã£ãŸãŸã‚åŸè‘—ã®è‹±èªã®ã¿ã‚’è¨˜è¼‰ã—ãŸã€‚3ç•ªç›®ã®æ€§è³ªã«é¡ä¼¼ã—ãŸã‚‚ã®ã¨ã—ã¦è·é›¢é–¢æ•°ã®å®šç¾©ã®1ã¤ã®éé€€åŒ–æ€§ãŒã‚ã‚‹ã€‚</p>
<p>å¤å…¸çš„ãªã‚«ãƒ¼ãƒãƒ«é–¢æ•°ã®ä¾‹ã¨ã—ã¦<span class="math notranslate nohighlight">\(l_2\)</span>ãƒãƒ«ãƒ ï¼ˆãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰è·é›¢ï¼‰ãŒã‚ã‚Šã¾ã™ã€‚<span class="math notranslate nohighlight">\(\left&lt;\vec{x}, \vec{x}'\right&gt;=\sqrt{\sum^D_i (x_i - x_i^{'})^2}\)</span>. æœ€ã‚‚èˆˆå‘³æ·±ã„ã‚«ãƒ¼ãƒãƒ«å­¦ç¿’ã®å¿œç”¨ã®ä¸­ã«ã¯<span class="math notranslate nohighlight">\(x\)</span>ãŒãƒ™ã‚¯ãƒˆãƒ«ã§ã¯ãªãé–¢æ•°ã‚„ä»–ã®æ§‹é€ åŒ–ã•ã‚ŒãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã‚ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</p>
<div class="tip admonition">
<p class="admonition-title">ä¸»å½¢å¼ã¨åŒå¯¾å½¢å¼</p>
<p><strong>åŒå¯¾å½¢å¼</strong>ã¨ã¯ã‚«ãƒ¼ãƒãƒ«ã‚’ä½¿ã†ã¨ãã«å‘¼ã°ã‚Œã‚‹ãƒ¢ãƒ‡ãƒ«å¼ã®ã“ã¨ã§ã™ã€‚<span class="math notranslate nohighlight">\(\hat{y} = \sum_i^N w_i \left&lt;\vec{x}, \vec{x}_i\right&gt;+ b\)</span>. åŒå¯¾å½¢å¼ã¨åŒºåˆ¥ã™ã‚‹ãŸã‚ã«é€šå¸¸ã®ãƒ¢ãƒ‡ãƒ«å¼ã‚’<strong>ä¸»å½¢å¼</strong>ã¨è¨€ã†ã“ã¨ã‚‚ã§ãã¾ã™ã€‚<span class="math notranslate nohighlight">\(\hat{y} = \vec{w}\vec{x} + b\)</span>. ä¸»å½¢å¼ã‚‚ã‚¯ãƒ¼ãƒ«ã«èã“ãˆã¾ã™ã­ã€‚</p>
</div>
<p>ã‚«ãƒ¼ãƒãƒ«å­¦ç¿’ã¯åˆ†å­ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã®éš›ã«ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã‚¨ãƒãƒ«ã‚®ãƒ¼é–¢æ•°ã‚„åŠ›å ´ã‚’å­¦ç¿’ã™ã‚‹ãŸã‚ã®æ–¹æ³•ã¨ã—ã¦åºƒãä½¿ã‚ã‚Œã¦ã„ã¾ã™ã€‚<span id="id2">[<a class="reference internal" href="#id26" title="Matthias Rupp, Alexandre Tkatchenko, Klaus-Robert MÃ¼ller, and O Anatole Von Lilienfeld. Fast and accurate modeling of molecular atomization energies with machine learning. Physical review letters, 108(5):058301, 2012.">RTMullerVL12</a>, <a class="reference internal" href="#id27" title="Christoph Scherer, ReneÌ Scheid, Denis Andrienko, and Tristan Bereau. Kernel-based machine learning for efficient simulations of molecular liquids. Journal of Chemical Theory and Computation, 16(5):3194â€“3204, 2020.">SSAB20</a>]</span></p>
<section id="id3">
<h2><span class="section-number">5.1. </span>æº¶è§£åº¦ã®ä¾‹<a class="headerlink" href="#id3" title="Permalink to this headline">Â¶</a></h2>
<p>ãã‚Œã§ã¯<a class="reference internal" href="regression.html"><span class="doc">Regression &amp; Model Assessment</span></a>ã®æº¶è§£åº¦ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆAqqSolDB<span id="id4">[<a class="reference internal" href="regression.html#id25" title="Murat Cihan Sorkun, Abhishek Khetan, and SÃ¼leyman Er. AqSolDB, a curated reference set of aqueous solubility and 2D descriptors for a diverse set of compounds. Sci. Data, 6(1):143, 2019. doi:10.1038/s41597-019-0151-1.">SKE19</a>]</span>ã‚’å†ã³è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ãã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«ã¯æ°´ã®æº¶è§£åº¦ã®æ¸¬å®šå€¤(ãƒ©ãƒ™ãƒ«)ã¨17å€‹ã®åˆ†å­ã®è¨˜è¿°å­ï¼ˆç‰¹å¾´é‡ï¼‰ã‚’ã‚‚ã£ãŸç´„10,000ä»¶ã®ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªåŒ–åˆç‰©ãŒã‚ã‚‹ã¨ã„ã†ã“ã¨ã‚’æ€ã„å‡ºã—ã¦ãã ã•ã„ã€‚</p>
</section>
<section id="notebook">
<h2><span class="section-number">5.2. </span>Notebookã®å®Ÿè¡Œ<a class="headerlink" href="#notebook" title="Permalink to this headline">Â¶</a></h2>
<p>ä¸Šã®Â <i aria-label="Launch interactive content" class="fas fa-rocket"></i>Â ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªGoogle Colabã§ã“ã®ãƒšãƒ¼ã‚¸ã‚’é–‹å§‹ã—ã¾ã—ã‚‡ã†ã€‚è©³ç´°ã¯ä¸‹è¨˜ã®ã‚¤ãƒ³ã‚¹ãƒˆâ€•ãƒªãƒ³ã‚°ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚</p>
<div class="dropdown admonition tip">
<p class="admonition-title">Tip</p>
<p>ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã«ã¯æ–°ã—ã„ã‚»ãƒ«ã§ã“ã®ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!pip install dmol-book
</pre></div>
</div>
<p>ã‚‚ã—ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§å•é¡ŒãŒã‚ã‚Œã°ã€<a class="reference external" href="https://github.com/whitead/dmol-book/blob/master/package/requirements.txt">ã“ã®ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯</a>ã§ä½¿ã‚ã‚Œã¦ã„ã‚‹æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p>
</div>
<p>ã„ã¤ã‚‚ã¨åŒã˜ã‚ˆã†ã«ã€ä¸‹è¨˜ã®ã‚³ãƒ¼ãƒ‰ã¯èª­ã¿è¾¼ã¿ã‚’è¡Œã£ã¦ã„ã¾ã™ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">jnp</span>
<span class="kn">import</span> <span class="nn">jax</span>
<span class="kn">import</span> <span class="nn">dmol</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># soldata = pd.read_csv(&#39;https://dataverse.harvard.edu/api/access/datafile/3407241?format=original&amp;gbrecs=true&#39;)</span>
<span class="n">soldata</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;https://github.com/whitead/dmol-book/raw/master/data/curated-solubility-dataset.csv&quot;</span>
<span class="p">)</span>
<span class="n">features_start_at</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">soldata</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;MolWt&quot;</span><span class="p">)</span>
<span class="n">feature_names</span> <span class="o">=</span> <span class="n">soldata</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">features_start_at</span><span class="p">:]</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># standardize the features</span>
<span class="n">soldata</span><span class="p">[</span><span class="n">feature_names</span><span class="p">]</span> <span class="o">-=</span> <span class="n">soldata</span><span class="p">[</span><span class="n">feature_names</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">soldata</span><span class="p">[</span><span class="n">feature_names</span><span class="p">]</span> <span class="o">/=</span> <span class="n">soldata</span><span class="p">[</span><span class="n">feature_names</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id5">
<h2><span class="section-number">5.3. </span>ã‚«ãƒ¼ãƒãƒ«ã®å®šç¾©<a class="headerlink" href="#id5" title="Permalink to this headline">Â¶</a></h2>
<p>ã‚«ãƒ¼ãƒãƒ«é–¢æ•°ã‚’ä½œã‚‹ã¨ã“ã‚ã‹ã‚‰å§‹ã‚ã¾ã—ã‚‡ã†ã€‚*ã‚«ãƒ¼ãƒãƒ«é–¢æ•°ã¯å¾®åˆ†å¯èƒ½ã§ã‚ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚*æ·±å±¤å­¦ç¿’ã§ã‚ˆãè¦‹ã‚‹é–¢æ•°ã¨ã¯å¯¾ç…§çš„ã«ã€ã‚«ãƒ¼ãƒãƒ«æ³•ã§ã¯æ´—ç·´ã•ã‚ŒãŸå¾®åˆ†ä¸å¯èƒ½ãªé–¢æ•°ã‚’ä½¿ã†ã“ã¨ãŒã§ãã¾ã™ã€‚ä¾‹ãˆã°ã€2åˆ†å­é–“ã®ã‚«ãƒ¼ãƒãƒ«ã‚’è¨ˆç®—ã™ã‚‹ãŸã‚ã«ï¼’æˆåˆ†ç³»ã®åˆ†å­å‹•åŠ›å­¦ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç”¨ã„ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚åŠ¹ç‡æ€§ã¨ã“ã‚Œã¾ã§ã®å†…å®¹ã¨ã®ä¸€è²«æ€§ã®ãŸã‚ã€ã“ã®ä¾‹ã§ã‚‚JAXã‚’ç”¨ã„ã¦ã‚«ãƒ¼ãƒãƒ«é–¢æ•°ã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã™ã€‚ã‚«ãƒ¼ãƒãƒ«ã¯ï¼’ã¤ã®ç‰¹å¾´ãƒ™ã‚¯ãƒˆãƒ«ã‚’å—ã‘å–ã£ã¦ã‚¹ã‚«ãƒ©ãƒ¼ã‚’è¿”ã™ã¨ã„ã†ã“ã¨ã‚’æ€ã„å‡ºã—ã¦ãã ã•ã„ã€‚ã“ã®ä¾‹ã§ã¯ã€ã‚·ãƒ³ãƒ—ãƒ«ã«<span class="math notranslate nohighlight">\(l_2\)</span>ãƒãƒ«ãƒ ã‚’ä½¿ã„ã¾ã™ã€‚ãŸã ã€æ¬¡å…ƒæ•°ã§é™¤ç®—ã™ã‚‹ã“ã¨ã§ã‚«ãƒ¼ãƒãƒ«ã«å°‘ã—ã²ã­ã‚Šã‚’ä¸ãˆã¦ã‚„ã‚Šã¾ã™ã€‚ã“ã†ã™ã‚‹ã“ã¨ã§ã‚«ãƒ¼ãƒãƒ«é–¢æ•°ã®å‡ºåŠ›ã®ã‚¹ã‚±ãƒ¼ãƒ«ã¯<span class="math notranslate nohighlight">\(x\)</span>ã®æ¬¡å…ƒæ•°ã«ä¾å­˜ã—ãªããªã‚Šã¾ã™ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">kernel</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id6">
<h2><span class="section-number">5.4. </span>ãƒ¢ãƒ‡ãƒ«å®šç¾©<a class="headerlink" href="#id6" title="Permalink to this headline">Â¶</a></h2>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>ç·šå½¢å›å¸°ã‚’è¡Œã£ã¦ã„ã‚‹ã®ã§ç·šå½¢ä»£æ•°ã®æ“ä½œã‚’ã™ã‚‹ã ã‘ã§å›å¸°ä¿‚æ•°ã‚’è¨ˆç®—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ä»–ã«ã‚‚ãƒ¢ãƒ‡ãƒ«ç‰¹æœ‰ã®åŠ¹ç‡çš„ãªæœ€é©åŒ–æ‰‹æ³•ãŒå¤šãã‚ã‚Šã¾ã™ãŒã€ã“ã“ã§ã¯å‹¾é…é™ä¸‹æ³•ã‚’ç”¨ã„ã¦ã“ã®å•é¡Œã«ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã—ã¦ã„ãã“ã¨ã«ã—ã¾ã™ã€‚</p>
</aside>
<p>ã“ã“ã§ã¯ã€å›å¸°ãƒ¢ãƒ‡ãƒ«å¼ã‚’<em>åŒå¯¾å½¢å¼</em>ã§å®šç¾©ã—ã¾ã™ã€‚ä»»æ„ã®ç‚¹ã¨ã®è·é›¢ã‚’è¨ˆç®—ã™ã‚‹ãŸã‚ã«ã‚«ãƒ¼ãƒãƒ«é–¢æ•°ã¯å¸¸ã«è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã‚’å¼•æ•°ã«æŒãŸãªã‘ã‚Œã°ãªã‚‰ãªã„ã¨ã„ã†ã“ã¨ã‚’æ€ã„å‡ºã—ã¾ã—ã‚‡ã†ã€‚æ–°ã—ã„å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦åŒæ™‚ã«å…¨ã¦ã®ã‚«ãƒ¼ãƒãƒ«ã‚’è¨ˆç®—ã™ã‚‹ãŸã‚ã«JAXã®ãƒãƒƒãƒç‰¹å¾´é‡ã‚’ä½¿ã„ã¾ã™ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">train_x</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="c1"># make vectorized version of kernel</span>
    <span class="n">vkernel</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">out_axes</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1"># compute kernel with all training data</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">vkernel</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">train_x</span><span class="p">)</span>
    <span class="c1"># dual form</span>
    <span class="n">yhat</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span>
    <span class="k">return</span> <span class="n">yhat</span>


<span class="c1"># make batched version that can handle multiple xs</span>
<span class="n">batch_model</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">out_axes</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id7">
<h2><span class="section-number">5.5. </span>ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°<a class="headerlink" href="#id7" title="Permalink to this headline">Â¶</a></h2>
<p>ã“ã®æ™‚ç‚¹ã§è¨“ç·´å¯èƒ½ãªé‡ã¿ã¨ãƒ¢ãƒ‡ãƒ«å¼ãŒã‚ã‚Šã¾ã™ã€‚ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã‚’å§‹ã‚ã‚‹ãŸã‚ã«ã€æå¤±é–¢æ•°ã¨ãã®å‹¾é…ã‚’å®šç¾©ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã“ã§ã¯ã„ã¤ã‚‚ã¨åŒã˜ã‚ˆã†ã«å¹³å‡äºŒä¹—èª¤å·®ã‚’æå¤±é–¢æ•°ã¨ã—ã¦ç”¨ã„ã¾ã™ã€‚å‰å›è¦‹ãŸã‚ˆã†ã«ã€æ­£å‰‡åŒ–ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ãŒä»Šã®ã¨ã“ã‚ã¯ã‚¹ã‚­ãƒƒãƒ—ã—ã¦ãŠãã¾ã—ã‚‡ã†ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span> <span class="nf">loss</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">train_x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">batch_model</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">train_x</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>


<span class="n">loss_grad</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">grad</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>


<span class="c1"># Get 80/20 split</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">soldata</span><span class="p">)</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">soldata</span><span class="p">[:</span> <span class="nb">int</span><span class="p">(</span><span class="n">N</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)]</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">soldata</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">N</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span> <span class="p">:]</span>

<span class="c1"># convert from pandas dataframe to numpy arrays</span>
<span class="n">train_x</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">feature_names</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">train_y</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s2">&quot;Solubility&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">test_x</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="n">feature_names</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">test_y</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s2">&quot;Solubility&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
<p>æå¤±é–¢æ•°ã‚’å®šç¾©ã—ã€ãƒ‡ãƒ¼ã‚¿ã‚’è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã¨ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã«åˆ†ã‘ã¾ã—ãŸã€‚ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã‚’ãƒãƒƒãƒã«åˆ†ã‘ã‚‹ã“ã¨ã‚‚å«ã‚ã¦ã€è¨“ç·´ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã‚’ã“ã“ã§è¨­å®šã—ã¦ã„ãã¾ã™ã€‚<strong>ã‚¨ãƒãƒƒã‚¯</strong>ã¨ã¯ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆå…¨ä½“ã‚’é€šã—ã¦ã®1å›ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eta</span> <span class="o">=</span> <span class="mf">1e-5</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">epochs</span> <span class="o">=</span> <span class="mi">10</span>


<span class="c1"># reshape into batches</span>
<span class="n">batch_num</span> <span class="o">=</span> <span class="n">train_x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="n">batch_size</span>
<span class="c1"># first truncate data so it&#39;s whole nubmer of batches</span>
<span class="n">trunc</span> <span class="o">=</span> <span class="n">batch_num</span> <span class="o">*</span> <span class="n">batch_size</span>
<span class="n">train_x</span> <span class="o">=</span> <span class="n">train_x</span><span class="p">[:</span><span class="n">trunc</span><span class="p">]</span>
<span class="n">train_y</span> <span class="o">=</span> <span class="n">train_y</span><span class="p">[:</span><span class="n">trunc</span><span class="p">]</span>
<span class="c1"># split into batches</span>
<span class="n">x_batches</span> <span class="o">=</span> <span class="n">train_x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">train_x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">y_batches</span> <span class="o">=</span> <span class="n">train_y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">)</span>


<span class="c1"># make trainable parameters</span>
<span class="c1"># w = np.random.normal(scale = 1e-30, size=train_x.shape[0])</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">train_x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">train_y</span><span class="p">)</span>  <span class="c1"># just set to mean, since it&#39;s a good first guess</span>
</pre></div>
</div>
</div>
</div>
<p>å­¦ç¿’ç‡<span class="math notranslate nohighlight">\(\eta\)</span>ãŒ<span class="math notranslate nohighlight">\(10^{-5}\)</span>ã¨æ™®é€šã‚ˆã‚Šå°ã•ã„ã“ã¨ã«æ°—ãŒä»˜ã„ãŸäººãŒã„ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ã“ã®ç†ç”±ã¯ã¨ã„ã†ã¨ã€ç´„8,000å€‹ã‚ã‚‹ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ç‚¹ã®ãã‚Œãã‚ŒãŒæœ€å¾Œã®<span class="math notranslate nohighlight">\(\hat{y}\)</span>ã«å¯„ä¸ã—ã¦ã„ã‚‹ã‹ã‚‰ã§ã™ã€‚ãã‚Œã‚†ãˆã€ã‚‚ã—å­¦ç¿’ã‚¹ãƒ†ãƒƒãƒ—ã‚’å¤§ããã—ã¦ã—ã¾ã†ã¨<span class="math notranslate nohighlight">\(\hat{y}\)</span>ã«å¤§ããªå¤‰åŒ–ã‚’åŠã¼ã—ã¦ã—ã¾ã†å¯èƒ½æ€§ãŒã‚ã‚‹ã®ã§ã™ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loss_progress</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">test_loss_progress</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
    <span class="c1"># go in random order</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">batch_num</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">batch_num</span><span class="p">):</span>
        <span class="c1"># update step</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x_batches</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">y_batches</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">loss_progress</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">train_x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
        <span class="n">test_loss_progress</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">train_x</span><span class="p">,</span> <span class="n">test_x</span><span class="p">,</span> <span class="n">test_y</span><span class="p">))</span>
        <span class="n">grad</span> <span class="o">=</span> <span class="n">loss_grad</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">train_x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">w</span> <span class="o">-=</span> <span class="n">eta</span> <span class="o">*</span> <span class="n">grad</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">b</span> <span class="o">-=</span> <span class="n">eta</span> <span class="o">*</span> <span class="n">grad</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">loss_progress</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Training Loss&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_loss_progress</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Testing Loss&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Step&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Loss&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:absl:No GPU/TPU found, falling back to CPU. (Set TF_CPP_MIN_LOG_LEVEL=0 and rerun for more info.)
</pre></div>
</div>
<img alt="../_images/kernel_15_1.png" src="../_images/kernel_15_1.png" />
</div>
</div>
<p>å…ˆã»ã©ã®ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ«ãƒ¼ãƒ—ã¨ã®é•ã„ã¯<code class="docutils literal notranslate"><span class="pre">for</span></code>ãƒ«ãƒ¼ãƒ—ã§ãƒãƒƒãƒã‚’ãƒ©ãƒ³ãƒ€ãƒ åŒ–ã—ãŸã“ã¨ã§ã™ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">yhat</span> <span class="o">=</span> <span class="n">batch_model</span><span class="p">(</span><span class="n">test_x</span><span class="p">,</span> <span class="n">train_x</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_y</span><span class="p">,</span> <span class="n">test_y</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_y</span><span class="p">,</span> <span class="n">yhat</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;correlation = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">test_y</span><span class="p">,</span> <span class="n">yhat</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;loss = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">test_y</span> <span class="o">-</span> <span class="n">yhat</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Testing Data&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/kernel_17_0.png" src="../_images/kernel_17_0.png" />
</div>
</div>
<p>ã“ã®çµæœã¯éå°é©åˆã—ã¦ã„ã‚‹ã¨è¦‹å—ã‘ã‚‰ã‚Œã¾ã™ã€‚ã„ã¤ã‚‚ã¨åŒã˜ã‚ˆã†ã«ã€ã“ã®ã‚³ãƒ¼ãƒ‰ã‚’é«˜é€Ÿã«å®Ÿè¡Œã•ã›ãŸã„ã®ã§ã€å¤§ãã„ã‚¨ãƒãƒƒã‚¯æ•°ã§ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã›ã‚“ã§ã—ãŸã€‚ã€‚ã‚¨ãƒãƒƒã‚¯æ•°ã‚’å¢—ã‚„ã—ã¦æå¤±ã¨ç›¸é–¢ãŒæ™‚é–“çµŒéã¨ã¨ã‚‚ã«æ”¹å–„ã•ã‚Œã¦ã„ãã¨ã“ã‚ã‚’è¦‹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p>
</section>
<section id="id8">
<h2><span class="section-number">5.6. </span>æ­£å‰‡åŒ–<a class="headerlink" href="#id8" title="Permalink to this headline">Â¶</a></h2>
<p>èª­è€…ã®ä¸­ã«ã¯ã€è¨“ç·´å¯èƒ½ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼æ•°ãŒæ„å›³çš„ã«è¨“ç·´ãƒ‡ãƒ¼ã‚¿ç‚¹ã®å€‹æ•°ã¨ç­‰ã—ãã—ã¦ã‚ã‚‹ã“ã¨ã«æ°—ã¥ã„ãŸäººãŒã„ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ã‚‚ã—ä»®ã«æ“¬ä¼¼é€†è¡Œåˆ—ã‚’ç”¨ã„ã¦å›å¸°ä¿‚æ•°ã‚’ç›´æ¥è¨ˆç®—ã—ãŸå ´åˆã€ã“ã‚Œã®ã›ã„ã§å•é¡Œã«ç›´é¢ã™ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ãã‚Œã‚†ãˆã€è¡Œåˆ—è¨ˆç®—ã®è§£ãŒæ•°å­¦çš„ã«æ‰±ã„ã‚„ã™ãã§ãã‚‹ã‚ˆã†ã«ã€ãã—ã¦è¨“ç·´å¯èƒ½ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ãŒå¤šã„ã»ã†ãŒè³¢æ˜ã ã¨æ€ã‚ã‚Œã‚‹ã®ã§æ­£å‰‡åŒ–é …ã‚’è¿½åŠ ã—ã¾ã™ã€‚ç·šå½¢å›å¸°ãƒ¢ãƒ‡ãƒ«ã§è¦‹ã¦ããŸã‚ˆã†ã«ã€L1å›å¸°ã¯<strong>ãƒ©ãƒƒã‚½ãƒ»ãƒªãƒƒã‚¸å›å¸°</strong>ã¨ã—ã¦çŸ¥ã‚‰ã‚Œã€L2å›å¸°ã¯<strong>ã‚«ãƒ¼ãƒãƒ«ãƒªãƒƒã‚¸å›å¸°</strong>ã¨ã—ã¦çŸ¥ã‚‰ã‚Œã¾ã™ã€‚L1å›å¸°ã¯ç‰¹å¾´é‡ã®é‡è¦åº¦ã‚’è§£é‡ˆã™ã‚‹ã®ã«ä½¿ãˆã‚‹ç‰¹å®šã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã‚’æ´—ã„å‡ºã™ã“ã¨ãŒã§ãã‚‹ã“ã¨ã‚’æ€ã„å‡ºã—ã¦ãã ã•ã„ã€‚ã—ã‹ã—ãªãŒã‚‰ã€ã‚«ãƒ¼ãƒãƒ«æ³•ã§ã¯ç‰¹å®šã®è¨“ç·´ãƒ‡ãƒ¼ã‚¿ç‚¹ã¨ã®é–¢ä¿‚ã‚’ç¤ºã™ã ã‘ã§ä½•ã‚‚ç¾å®Ÿçš„ãªæ´å¯Ÿã‚’ä¸ãˆã¦ã¯ãã‚Œã¾ã›ã‚“(<a class="reference internal" href="../dl/xai.html"><span class="doc">äºˆæ¸¬ã‚’èª¬æ˜ã™ã‚‹</span></a>)å‚ç…§)ã€‚ãã†ã„ã†ã‚ã‘ã§ã‚«ãƒ¼ãƒãƒ«ãƒªãƒƒã‚¸å›å¸°ã¯ã‚«ãƒ¼ãƒãƒ«æ³•ã®ç¯„ç–‡ã§ã¯æœ‰åã§ã™ã€‚</p>
</section>
<section id="id9">
<h2><span class="section-number">5.7. </span>å­¦ç¿’æ›²ç·š<a class="headerlink" href="#id9" title="Permalink to this headline">Â¶</a></h2>
<p>ï¼ˆ<a class="reference internal" href="regression.html"><span class="doc">Regression &amp; Model Assessment</span></a>ã®ãƒã‚¤ã‚¢ã‚¹-ãƒãƒªã‚¢ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ã¯ã€ãƒ¢ãƒ‡ãƒ«ã®è¤‡é›‘ã•ã‚’å¢—åŠ ã•ã›ã‚‹ã¨ã€ãƒ¢ãƒ‡ãƒ«ã®ãƒãƒªã‚¢ãƒ³ã‚¹ï¼ˆãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã®é¸æŠã®ä»•æ–¹ã¨é‡ã«ã‚ˆã‚Šå¼·ãå½±éŸ¿ã‚’å—ã‘ã‚‹ï¼‰ã®å¢—åŠ ã‚’çŠ ç‰²ã«ã—ã¦ã©ã‚Œã»ã©ãƒ¢ãƒ‡ãƒ«ã®ãƒã‚¤ã‚¢ã‚¹ï¼ˆã‚ˆã‚Šè¡¨ç¾åŠ›ãŒé«˜ãã€ã‚ˆã‚Šè‰¯ããƒ‡ãƒ¼ã‚¿ã«é©åˆã§ãã‚‹ï¼‰ã‚’è»½æ¸›ã§ãã‚‹ã‹ã«ã¤ã„ã¦ç¤ºã—ã¾ã—ãŸã€‚ãƒ¢ãƒ‡ãƒ«ã®è¤‡é›‘ã•ã¯ç‰¹å¾´é‡ã®å€‹æ•°ã‚’èª¿æ•´ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦åˆ¶å¾¡ã™ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚ã‚«ãƒ¼ãƒãƒ«æ³•ã§ã¯ç‰¹å¾´é‡ã®å€‹æ•°ã‚’ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã—ã¾ã›ã‚“ã€‚ã¨ã„ã†ã®ã‚‚ãã‚ŒãŒè¨“ç·´ãƒ‡ãƒ¼ã‚¿ç‚¹ã®å€‹æ•°ã¨å¸¸ã«ä¸€è‡´ã™ã‚‹ã‹ã‚‰ã§ã™ã€‚ãã‚Œã‚†ãˆã€ã‚«ãƒ¼ãƒãƒ«ã®é¸æŠã‚„æ­£å‰‡åŒ–ã€å­¦ç¿’ç‡ãªã©ã®ã‚ˆã†ãªãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã‚’ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã™ã‚‹ã ã‘ã«ãªã‚Šã¾ã™ã€‚ã“ã®ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®åŠ¹æœã‚’è©•ä¾¡ã™ã‚‹ãŸã‚ã«ãƒ†ã‚¹ãƒˆã®æå¤±ã‚’è¨ˆç®—ã™ã‚‹ã ã‘ã§ã¯çµ‚ã‚ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚ãªãœãªã‚‰ãã®æå¤±ãŒãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã®é‡ã«å¼·ãé–¢ä¿‚ã—ã¦ã„ã‚‹ã‹ã‚‰ã§ã™ã€‚å¤šãã®è¨“ç·´ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹ã¨ã„ã†ã“ã¨ã¯ãƒ¢ãƒ‡ãƒ«ãŒã‚ˆã‚Šæ´—ç·´ã•ã‚Œã‚‹ã¨ã„ã†ã“ã¨ã‚’æ„å‘³ã—ã€æå¤±ã®å€¤ãŒæ¸›å°‘ã—ã¾ã™ã€‚ãªã®ã§ã€ã¨ã‚Šã‚ã‘ã‚«ãƒ¼ãƒãƒ«å­¦ç¿’ã§ã¯ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã®é‡ã«å¯¾ã—ã¦ãƒ†ã‚¹ãƒˆæå¤±ã®å€¤ãŒã©ã‚Œã»ã©å¤‰ã‚ã‚‹ã®ã‹ã‚’ç¤ºã™ã¨ã„ã†ã“ã¨ã¯å¸¸è­˜çš„ãªã“ã¨ã§ã™ã€‚å€¤ãŒå¤§ããªã‚¹ã‚±ãƒ¼ãƒ«ã§å¤‰åŒ–ã™ã‚‹ã®ã§ã“ã‚Œã‚‰ã¯å¯¾æ•°-å¯¾æ•°ãƒ—ãƒ­ãƒƒãƒˆã§ç¤ºã•ã‚Œã¾ã™ã€‚ã“ã‚Œã‚‰ã¯<strong>å­¦ç¿’æ›²ç·š</strong>(ã‚‚ã—ãã¯<strong>Learning curves</strong>)ã¨å‘¼ã°ã‚Œã¦ã„ã¾ã™ã€‚å­¦ç¿’æ›²ç·šã¯æ©Ÿæ¢°å­¦ç¿’ã‚„æ·±å±¤å­¦ç¿’ã§åºƒãä½¿ã‚ã‚Œã¦ã„ã¾ã™ãŒã€ã‚«ãƒ¼ãƒãƒ«å­¦ç¿’ã§ã‚‚é »ç¹ã«è¦‹ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚</p>
<p>æº¶è§£åº¦ã®ãƒ¢ãƒ‡ãƒ«ã«å†ã³æˆ»ã£ã¦å­¦ç¿’æ›²ç·šã‚’ç”¨ã„ã¦L1ã¨L2ã®æ­£å‰‡åŒ–ã‚’æ¯”è¼ƒã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚æ³¨æ„ã—ã¦ãŠãã¾ã™ãŒã€<span class="math notranslate nohighlight">\(M\)</span>å€‹ã®ãƒ¢ãƒ‡ãƒ«ï¼ˆ<span class="math notranslate nohighlight">\(M\)</span>ã¯å­¦ç¿’æ›²ç·šã§å–å¾—ã—ãŸã„ç‚¹ã®å€‹æ•°ï¼‰ã‚’è¨ˆç®—ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ã®ã§ã€ã“ã®ã‚³ãƒ¼ãƒ‰ã¯éå¸¸ã«é…ããªã‚Šã¾ã™ã€‚ã“ã®ãƒ†ã‚­ã‚¹ãƒˆã§ã¯åŠ¹ç‡æ€§ã‚’ä¿ã¤ãŸã‚ã«å­¦ç¿’æ›²ç·šä¸Šã®ç‚¹ã¨ã—ã¦æ•°å€‹ã‚’ç”¨ã„ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚</p>
<p>æœ€åˆã«ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã®éç¨‹ã‚’é–¢æ•°ã«ã¾ã¨ã‚ã¾ã™ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fit_model</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">25</span><span class="p">):</span>

    <span class="n">sample_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">train_x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">npoints</span>
    <span class="p">)</span>
    <span class="n">sample_x</span> <span class="o">=</span> <span class="n">train_x</span><span class="p">[</span><span class="n">sample_idx</span><span class="p">,</span> <span class="p">:]</span>
    <span class="n">sample_y</span> <span class="o">=</span> <span class="n">train_y</span><span class="p">[</span><span class="n">sample_idx</span><span class="p">]</span>

    <span class="c1"># reshape into batches</span>
    <span class="n">batch_num</span> <span class="o">=</span> <span class="n">npoints</span> <span class="o">//</span> <span class="n">batch_size</span>
    <span class="c1"># first truncate data so it&#39;s whole nubmer of batches</span>
    <span class="n">trunc</span> <span class="o">=</span> <span class="n">batch_num</span> <span class="o">*</span> <span class="n">batch_size</span>
    <span class="n">sample_x</span> <span class="o">=</span> <span class="n">sample_x</span><span class="p">[:</span><span class="n">trunc</span><span class="p">]</span>
    <span class="n">sample_y</span> <span class="o">=</span> <span class="n">sample_y</span><span class="p">[:</span><span class="n">trunc</span><span class="p">]</span>
    <span class="c1"># split into batches</span>
    <span class="n">x_batches</span> <span class="o">=</span> <span class="n">sample_x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">sample_x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">y_batches</span> <span class="o">=</span> <span class="n">sample_y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">)</span>

    <span class="c1"># get loss grad</span>
    <span class="n">loss_grad</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">grad</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="c1"># make trainable parameters</span>
    <span class="c1"># w = np.random.normal(scale = 1e-30, size=train_x.shape[0])</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">sample_x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample_y</span><span class="p">)</span>  <span class="c1"># just set to mean, since it&#39;s a good first guess</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
        <span class="c1"># go in random order</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">batch_num</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">batch_num</span><span class="p">):</span>
            <span class="c1"># update step</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">x_batches</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">y_batches</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">grad</span> <span class="o">=</span> <span class="n">loss_grad</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">sample_x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
            <span class="n">w</span> <span class="o">-=</span> <span class="n">eta</span> <span class="o">*</span> <span class="n">grad</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">b</span> <span class="o">-=</span> <span class="n">eta</span> <span class="o">*</span> <span class="n">grad</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">loss</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">sample_x</span><span class="p">,</span> <span class="n">test_x</span><span class="p">,</span> <span class="n">test_y</span><span class="p">)</span>


<span class="c1"># test it out</span>
<span class="n">fit_model</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DeviceArray(3.8454313, dtype=float32)
</pre></div>
</div>
</div>
</div>
<p>ã“ã“ã§ã¯ç§ãŸã¡å°‚ç”¨ã®L1ã¨L2ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®æå¤±é–¢æ•°ã‚’ä½œã£ã¦ã„ãã¾ã™ã€‚æ­£å‰‡åŒ–ã®*å¼·åº¦(strength)*ã‚’é¸æŠã—ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚é‡ã¿ã¯1ã‚ˆã‚Šå°ã•ã„ã®ã§L2ã«å¯¾ã—ã¦ã¯ã‚ˆã‚Šã‚‚ã£ã¨å¼·ã„æ­£å‰‡åŒ–ã®å¼·åº¦ã‚’é¸æŠã™ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚ã“ã‚Œã‚‰ã¯ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã§ã™ãŒãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã‚’å‘ä¸Šã•ã›ã‚‹ãŸã‚ã«èª¿æ•´ã—ã¦ã‚‚å•é¡Œãªã„ã§ã™ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span> <span class="nf">loss_l1</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">train_x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">batch_model</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">train_x</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
        <span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
    <span class="p">)</span>


<span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span> <span class="nf">loss_l2</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">train_x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">batch_model</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">train_x</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>ãã—ã¦ã€å­¦ç¿’æ›²ç·šã«å¿…è¦ãªç‚¹ã‚’ç”Ÿæˆã—ã¾ã™ï¼</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nvalues</span> <span class="o">=</span> <span class="p">[</span><span class="mi">32</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="mi">2048</span><span class="p">,</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">5</span><span class="p">]</span>

<span class="n">nor_losses</span> <span class="o">=</span> <span class="p">[</span><span class="n">fit_model</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nvalues</span><span class="p">]</span>
<span class="n">l1_losses</span> <span class="o">=</span> <span class="p">[</span><span class="n">fit_model</span><span class="p">(</span><span class="n">loss_l1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nvalues</span><span class="p">]</span>
<span class="n">l2_losses</span> <span class="o">=</span> <span class="p">[</span><span class="n">fit_model</span><span class="p">(</span><span class="n">loss_l2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nvalues</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nvalues</span><span class="p">,</span> <span class="n">nor_losses</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;No Regularization&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nvalues</span><span class="p">,</span> <span class="n">l1_losses</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;L1 Regularization&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nvalues</span><span class="p">,</span> <span class="n">l2_losses</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;L2 Regularization&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Training Data Amount&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Test Loss&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/kernel_26_0.png" src="../_images/kernel_26_0.png" />
</div>
</div>
<p>æœ€å¾Œã«åˆ¥ã€…ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’ã¨ã£ãŸå­¦ç¿’æ›²ç·šã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚æ­£å‰‡åŒ–ã¯ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®æœ€çµ‚çš„ãªæå¤±ã«ãªã«ã‹ã—ã‚‰ã®å½±éŸ¿ã‚’åŠã¼ã—ã¦ã„ã¾ã™ã€‚L1ã¨L2æ­£å‰‡åŒ–ã¯å˜ç´”ã«æ‚ªããªã£ã¦ã„ã‚‹ã‹ã®æ˜¯éã‚„æ­£å‰‡åŒ–ã®å¼·åº¦ã‚’ã‚‚ã£ã¨èª¿æ•´ã—ãŸã»ã†ãŒè‰¯ã„ã‹ã©ã†ã‹ã«ã¤ã„ã¦è¨€åŠã™ã‚‹ã“ã¨ã¯å›°é›£ã§ã™ã€‚ã¨ã¯è¨€ãˆã€ã“ã®ãƒ—ãƒ­ãƒƒãƒˆã‚’è¦‹ã‚‹é™ã‚Šã§ã¯æˆ‘ã€…ãŒã‚«ãƒ¼ãƒãƒ«å­¦ç¿’æ³•ã‚’å…¸å‹çš„ãªæ–¹æ³•ã§è©•ä¾¡ã—ãŸã¨ã„ã†ã“ã¨ã¯ã‚ã‹ã‚Šã¾ã™ã€‚</p>
</section>
<section id="id10">
<h2><span class="section-number">5.8. </span>ç·´ç¿’å•é¡Œ<a class="headerlink" href="#id10" title="Permalink to this headline">Â¶</a></h2>
<ol class="simple">
<li><p>åŒå¯¾å½¢å¼ã®å›å¸°å¼ã‹ã‚‰å‹¾é…ã‚’è¨ˆç®—ã—ã€ãã®è¨ˆç®—çµæœã‚’ç”¨ã„ã¦ã‚«ãƒ¼ãƒãƒ«é–¢æ•°ãŒãªãœå¾®åˆ†å¯èƒ½ã§ã‚ã‚‹å¿…è¦ãŒãªã„ã®ã‹ã«ã¤ã„ã¦èª¬æ˜ã—ãªã•ã„ã€‚</p></li>
<li><p>ã‚«ãƒ¼ãƒãƒ«å­¦ç¿’ã§ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã‚’è¡Œã†ã¨é€Ÿã„ã‹é…ã„ã‹ï¼Ÿèª¬æ˜ã—ãªã•ã„ã€‚</p></li>
<li><p>ã‚«ãƒ¼ãƒãƒ«å­¦ç¿’ã§äºˆæ¸¬ã™ã‚‹ã®ã¯é€Ÿã„ã‹é…ã„ã‹ï¼Ÿèª¬æ˜ã—ãªã•ã„ã€‚</p></li>
<li><p>åˆ†é¡ã‚¿ã‚¹ã‚¯ã‚’è¡Œã†ãŸã‚ã«å¼4.2ã‚’ã©ã®ã‚ˆã†ã«ä¿®æ­£ã™ã‚Œã°ã‚ˆã„ã‹ï¼Ÿ</p></li>
<li><p>ã‚«ãƒ¼ãƒãƒ«ã®ç¨®é¡ã«é–¢ã‚ã‚‰ãšã€é‡ã¿ã®å€¤ãŒãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã®ç›¸å¯¾çš„ãªé‡è¦åº¦ã‚’ç¤ºã—ã¦ã„ã‚‹ã ã‚ã†ã‹ï¼Ÿ</p></li>
<li><p>ä¸Šè¨˜ã®ä¾‹ã‹ã‚‰L1æ­£å‰‡åŒ–ã®å¼·åº¦ãŒç•°ãªã‚‹5ã¤ã®å­¦ç¿’æ›²ç·šã‚’ä½œæˆã—ãªã•ã„ã€‚ã“ã®ä¾‹ã§æ­£å‰‡åŒ–ãŒæ„å‘³ã‚’ãªã•ãªã„ã®ãªã„ã®ã¯ãªãœã‹ï¼Ÿ</p></li>
</ol>
</section>
<section id="id11">
<h2><span class="section-number">5.9. </span>ç« ã®ã¾ã¨ã‚<a class="headerlink" href="#id11" title="Permalink to this headline">Â¶</a></h2>
<ul class="simple">
<li><p>ã“ã®ç« ã§ã¯ã‚«ãƒ¼ãƒãƒ«å­¦ç¿’ã‚’ç´¹ä»‹ã—ãŸã€‚ã‚«ãƒ¼ãƒãƒ«å­¦ç¿’ã¯ç‰¹å¾´é‡ã‚’ã‚µãƒ³ãƒ—ãƒ«é–“ã®è·é›¢ã«å¤‰æ›ã™ã‚‹æ–¹æ³•ã§ã‚ã‚‹ã€‚</p></li>
<li><p>ã‚«ãƒ¼ãƒãƒ«é–¢æ•°ã¯2ã¤ã®å¼•æ•°ã‚’å—ã‘å–ã£ã¦ã‚¹ã‚«ãƒ©ãƒ¼ã‚’å‡ºåŠ›ã™ã‚‹ã€‚ã‚«ãƒ¼ãƒãƒ«é–¢æ•°ã¯3ã¤ã®æ€§è³ªã‚’æŒãŸãªã‘ã‚Œã°ãªã‚‰ãªã„ï¼ˆæ­£å®šæ€§(positive)ãƒ»å¯¾ç§°æ€§(symmetry)ãƒ»Point-separatingï¼‰ã€‚ï¼‰</p></li>
<li><p>è·é›¢é–¢æ•°ï¼ˆå†…ç©ï¼‰ã¯ã‚«ãƒ¼ãƒãƒ«é–¢æ•°ã§ã‚ã‚‹ã€‚</p></li>
<li><p>ã‚«ãƒ¼ãƒãƒ«é–¢æ•°ã¯å¾®åˆ†å¯èƒ½ã§ã‚ã‚‹å¿…è¦ã¯ãªã„ã€‚</p></li>
<li><p>ã‚«ãƒ¼ãƒãƒ«å­¦ç¿’ã¯äºŒå¤‰æ•°ã‚«ãƒ¼ãƒãƒ«é–¢æ•°ã ã‘ã§å®šã‚ã‚‰ã‚Œã‚‹ç‰¹å¾´é‡ã‚’ä½¿ã„ãŸã„ã¨ãã«ç›¸å¿œã—ã„æ‰‹æ³•ã§ã‚ã‚‹ã€‚</p></li>
<li><p>ã‚«ãƒ¼ãƒãƒ«ãƒ¢ãƒ‡ãƒ«ã®è¨“ç·´å¯èƒ½ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®å€‹æ•°ã¯ç‰¹å¾´é‡ã®æ¬¡å…ƒæ•°ã§ã¯ãªãè¨“ç·´ãƒ‡ãƒ¼ã‚¿ç‚¹ã®å€‹æ•°ã«æ¯”ä¾‹ã™ã‚‹ã€‚</p></li>
</ul>
</section>
<section id="cited-references">
<h2><span class="section-number">5.10. </span>Cited References<a class="headerlink" href="#cited-references" title="Permalink to this headline">Â¶</a></h2>
<div class="docutils container" id="id12">
<dl class="citation">
<dt class="label" id="id28"><span class="brackets"><a class="fn-backref" href="#id4">SKE19</a></span></dt>
<dd><p>MuratÂ Cihan Sorkun, Abhishek Khetan, and SÃ¼leyman Er. AqSolDB, a curated reference set of aqueous solubility and 2D descriptors for a diverse set of compounds. <em>Sci. Data</em>, 6(1):143, 2019. <a class="reference external" href="https://doi.org/10.1038/s41597-019-0151-1">doi:10.1038/s41597-019-0151-1</a>.</p>
</dd>
<dt class="label" id="id27"><span class="brackets"><a class="fn-backref" href="#id2">SSAB20</a></span></dt>
<dd><p>Christoph Scherer, ReneÌ Scheid, Denis Andrienko, and Tristan Bereau. Kernel-based machine learning for efficient simulations of molecular liquids. <em>Journal of Chemical Theory and Computation</em>, 16(5):3194â€“3204, 2020.</p>
</dd>
<dt class="label" id="id26"><span class="brackets"><a class="fn-backref" href="#id2">RTMullerVL12</a></span></dt>
<dd><p>Matthias Rupp, Alexandre Tkatchenko, Klaus-Robert MÃ¼ller, and OÂ Anatole VonÂ Lilienfeld. Fast and accurate modeling of molecular atomization energies with machine learning. <em>Physical review letters</em>, 108(5):058301, 2012.</p>
</dd>
</dl>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./ml"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="classification.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">4. </span>Classification</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../dl/introduction.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">6. </span>ãƒ‡ã‚£ãƒ¼ãƒ—ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°ã®æ¦‚è¦</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Andrew D. White<br/>
    
        &copy; Copyright 2022.<br/>
      <div class="extra_footer">
        <a href="http://thewhitelab.org">thewhitelab.org</a> <div id="wh-modal"> <button class="wh-venti-button" aria-label="close modal" id="wh-modal-close">âœ•</button> <img id="wh-modal-img"> </div>
      </div>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>