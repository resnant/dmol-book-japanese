
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<meta content="Deep Learning for Molecules &amp; Materials Book" lang="en" name="description" xml:lang="en" />
<meta content="en_US" property="og:locale" />
<meta content="summary" name="twitter:card" />
<meta content="Deep Learning for Molecules &amp; Materials Book" name="twitter:description" />
<meta content="dmol.pub üìñ" name="twitter:title" />
<meta content="https://dmol.pub/_static/logo.png" name="twitter:image" />
<meta content="&#64;andrewwhite01" name="twitter:site" />

    <title>5. „Ç´„Éº„Éç„É´Â≠¶Áøí &#8212; deep learning for molecules &amp; materials</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/a11y.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/custom.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="canonical" href="https://resnant.github.io/dmol-book-japanese/ml/kernel.html" />
    <link rel="shortcut icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6. „Éá„Ç£„Éº„Éó„É©„Éº„Éã„É≥„Ç∞„ÅÆÊ¶ÇË¶Å" href="../dl/introduction.html" />
    <link rel="prev" title="4. Classification" href="classification.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">deep learning for molecules & materials</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   „Åì„ÅÆÊú¨„ÅÆÊ¶ÇË¶Å
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  A. Math Review
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../math/tensors-and-shapes.html">
   1. Tensors and Shapes
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  B. Machine Learning
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="introduction.html">
   2. Ê©üÊ¢∞Â≠¶ÁøíÂÖ•ÈñÄ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="regression.html">
   3. Regression &amp; Model Assessment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="classification.html">
   4. Classification
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   5. „Ç´„Éº„Éç„É´Â≠¶Áøí
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  C. Deep Learning
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../dl/introduction.html">
   6. „Éá„Ç£„Éº„Éó„É©„Éº„Éã„É≥„Ç∞„ÅÆÊ¶ÇË¶Å
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dl/layers.html">
   7. Standard Layers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dl/gnn.html">
   8. Graph Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dl/data.html">
   9. Input Data &amp; Equivariances
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dl/Equivariant.html">
   10. Equivariant Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dl/molnets.html">
   11. Modern Molecular NNs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dl/xai.html">
   12. ‰∫àÊ∏¨„ÇíË™¨Êòé„Åô„Çã
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dl/attention.html">
   13. „Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„É¨„Ç§„É§„Éº
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dl/NLP.html">
   15. Deep Learning on Sequences
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dl/VAE.html">
   16. Variational Autoencoder
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dl/flows.html">
   17. Normalizing Flows
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  D. Applications
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../applied/QM9.html">
   18. GNN„Å´„Çà„ÇãDFT„Ç®„Éç„É´„ÇÆ„Éº„ÅÆ‰∫àÊ∏¨
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../applied/MolGenerator.html">
   19. Generative RNN in Browser
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  E. Contributed Chapters
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../dl/Hyperparameter_tuning.html">
   20. Hyperparameter Tuning
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  F. Appendix
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../style.html">
   21. Style Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../changelog.html">
   22. Changelog
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  <script async defer src="https://api.dmol.pub/latest.js"></script><noscript><img src="https://api.dmol.pub/noscript.gif" alt="" referrerpolicy="no-referrer-when-downgrade" /></noscript> By <a href="https://twitter.com/andrewwhite01">Andrew White</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/ml/kernel.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/resnant/dmol-book-japanese/"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/resnant/dmol-book-japanese//issues/new?title=Issue%20on%20page%20%2Fml/kernel.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/resnant/dmol-book-japanese/blob/master/ml/kernel.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   5.1. Ê∫∂Ëß£Â∫¶„ÅÆ‰æã
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#notebook">
   5.2. Notebook„ÅÆÂÆüË°å
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id5">
   5.3. „Ç´„Éº„Éç„É´„ÅÆÂÆöÁæ©
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id6">
   5.4. „É¢„Éá„É´ÂÆöÁæ©
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id7">
   5.5. „Éà„É¨„Éº„Éã„É≥„Ç∞
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id8">
   5.6. Ê≠£ÂâáÂåñ
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id9">
   5.7. Â≠¶ÁøíÊõ≤Á∑ö
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id10">
   5.8. Á∑¥ÁøíÂïèÈ°å
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id11">
   5.9. Á´†„ÅÆ„Åæ„Å®„ÇÅ
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cited-references">
   5.10. Cited References
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>„Ç´„Éº„Éç„É´Â≠¶Áøí</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   5.1. Ê∫∂Ëß£Â∫¶„ÅÆ‰æã
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#notebook">
   5.2. Notebook„ÅÆÂÆüË°å
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id5">
   5.3. „Ç´„Éº„Éç„É´„ÅÆÂÆöÁæ©
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id6">
   5.4. „É¢„Éá„É´ÂÆöÁæ©
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id7">
   5.5. „Éà„É¨„Éº„Éã„É≥„Ç∞
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id8">
   5.6. Ê≠£ÂâáÂåñ
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id9">
   5.7. Â≠¶ÁøíÊõ≤Á∑ö
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id10">
   5.8. Á∑¥ÁøíÂïèÈ°å
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id11">
   5.9. Á´†„ÅÆ„Åæ„Å®„ÇÅ
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cited-references">
   5.10. Cited References
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1><span class="section-number">5. </span>„Ç´„Éº„Éç„É´Â≠¶Áøí<a class="headerlink" href="#id1" title="Permalink to this headline">¬∂</a></h1>
<p>„Ç´„Éº„Éç„É´Â≠¶Áøí„ÅØÂàÜÈ°û„ÄÅ„Åæ„Åü„ÅØÂõûÂ∏∞ÂïèÈ°å„ÅßÁâπÂæ¥Èáè„ÇíÂ§âÊèõ„Åô„ÇãÔºë„Å§„ÅÆÊñπÊ≥ï„Åß„Åô„ÄÇÂõûÂ∏∞ÂïèÈ°å„Åß„ÅØ„ÄÅ‰ª•‰∏ã„ÅÆ„Çà„ÅÜ„Å™ÂõûÂ∏∞Âºè„ÇíÁî®„ÅÑ„Åæ„Åô„ÄÇ</p>
<div class="amsmath math notranslate nohighlight" id="equation-d34be902-10ae-434a-a267-323e29443540">
<span class="eqno">(5.1)<a class="headerlink" href="#equation-d34be902-10ae-434a-a267-323e29443540" title="Permalink to this equation">¬∂</a></span>\[\begin{equation}
    \hat{y} = \vec{w}\vec{x} + b
\end{equation}\]</div>
<p>„Åì„Åì„Åß„ÄÅ <span class="math notranslate nohighlight">\(\vec{x}\)</span>„ÅØÊ¨°ÂÖÉ<span class="math notranslate nohighlight">\(D\)</span>„ÅÆÁâπÂæ¥„Éô„ÇØ„Éà„É´„Åß„Åô„ÄÇ„Ç´„Éº„Éç„É´Â≠¶Áøí„Åß„ÅØÊ¨°ÂÖÉ<span class="math notranslate nohighlight">\(D\)</span>„ÅÆÁâπÂæ¥„Éô„ÇØ„Éà„É´„Åã„ÇâÊ¨°ÂÖÉ<span class="math notranslate nohighlight">\(N\)</span>„ÅÆ<em>Ë®ìÁ∑¥„Éá„Éº„ÇøÁÇπ„Å∏„ÅÆË∑ùÈõ¢</em>„Å´Â§âÊèõ„Åó„Åæ„Åô„ÄÇ„Åì„ÅÆ„Å®„Åç„ÅÆ<span class="math notranslate nohighlight">\(N\)</span>„ÅØË®ìÁ∑¥„Éá„Éº„ÇøÁÇπ„ÅÆÂÄãÊï∞„Åß„Åô„ÄÇ</p>
<div class="amsmath math notranslate nohighlight" id="equation-e5d29b6e-c864-4113-a97d-54d536abc797">
<span class="eqno">(5.2)<a class="headerlink" href="#equation-e5d29b6e-c864-4113-a97d-54d536abc797" title="Permalink to this equation">¬∂</a></span>\[\begin{equation}
    \hat{y} = \sum_i^N w_i \left&lt;\vec{x}, \vec{x}_i\right&gt;+ b
\end{equation}\]</div>
<p>‰∏äÂºè„ÅÆ<span class="math notranslate nohighlight">\(\left&lt;\cdot\right&gt;\)</span>„ÅØÔºí„Å§„ÅÆÁâπÂæ¥„Éô„ÇØ„Éà„É´Èñì„ÅÆË∑ùÈõ¢„Åß„ÅÇ„Çä<span class="math notranslate nohighlight">\(\vec{x}_i\)</span>„ÅØ<span class="math notranslate nohighlight">\(i\)</span>Áï™ÁõÆ„ÅÆË®ìÁ∑¥„Éá„Éº„ÇøÁÇπ„Åß„Åô„ÄÇ<span class="math notranslate nohighlight">\(\vec{x}_i\)</span>„ÅØÊó¢Áü•„ÅÆÂÄ§„Åß„Åô„Åå„ÄÅ<span class="math notranslate nohighlight">\(\vec{x}\)</span>„ÅØÈñ¢Êï∞„ÅÆÂºïÊï∞„Åß„Åô„ÄÇ</p>
<div class="admonition- admonition">
<p class="admonition-title">„Åì„ÅÆÁ´†„ÅÆÂØæË±°Ë™≠ËÄÖ„Å®ÁõÆÁöÑ</p>
<p>„Åì„ÅÆÁ´†„ÅØ<a class="reference internal" href="regression.html"><span class="doc">Regression &amp; Model Assessment</span></a>„Å®<a class="reference internal" href="classification.html"><span class="doc">Classification</span></a>„Å´Âü∫„Å•„ÅÑ„Å¶ÈÄ≤„ÇÅ„Çâ„Çå„Åæ„Åô„ÄÇ„Åì„ÅÆÁ´†„Çí‰øÆ‰∫Ü„Åô„Çã„Å®</p>
<ul class="simple">
<li><p>‰∏ªÂΩ¢Âºè„Å®ÂèåÂØæÂΩ¢Âºè„ÅÆÈÅï„ÅÑ„ÇíË¶ãÊäú„Åë„Çâ„Çå„Åæ„Åô„ÄÇ</p></li>
<li><p>„Ç´„Éº„Éç„É´Â≠¶Áøí„Åå‰∏äÊâã„Åè„ÅÑ„Åç„Åù„ÅÜ„Å†„Å®ÊÄù„Å£„Åü„Å®„Åç„Å´„Ç´„Éº„Éç„É´Â≠¶Áøí„Çí„ÉÅ„Éß„Ç§„Çπ„Åô„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ</p></li>
<li><p>Â≠¶ÁøíÊõ≤Á∑ö„ÅÆÂéüÁêÜ„ÇÑË®ìÁ∑¥„Éá„Éº„Çø„Çµ„Ç§„Ç∫„Å®ÁâπÂæ¥Èáè„ÅÆÂÄãÊï∞„ÅÆÈñì„ÅÆÈñ¢‰øÇ„ÇíÁêÜËß£„Åô„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ</p></li>
</ul>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Ë∑ùÈõ¢„Å®„ÅÑ„ÅÜ„ÉØ„Éº„Éâ„Çí‰Ωø„Å£„Å¶„ÅÑ„Åç„Åæ„Åô„ÅåÂÆüÈöõ„Å´„ÅØ<span class="math notranslate nohighlight">\(\left&lt;\cdot\right&gt;\)</span>„ÅØÂÜÖÁ©ç„Åß„ÅÇ„Å£„Å¶Ë∑ùÈõ¢„Çà„Çä„ÇÇ„Éï„É¨„Ç≠„Ç∑„Éñ„É´„Å™„ÇÇ„ÅÆ„Å´„Å™„Çä„Åæ„Åô„ÄÇ</p>
</aside>
<p>„Åì„ÅÆÂ§âÊèõ„Å´„Çà„ÇãÂ∏∞Áµê„Å®„Åó„Å¶„ÄÅË®ìÁ∑¥„Éá„Éº„Çø„ÅÆÈáç„Åø„Éô„ÇØ„Éà„É´„ÅåÁâπÂæ¥Èáè„ÅÆÂÄãÊï∞„Å´ÂÖ®„Åè‰æùÂ≠ò„Åó„Å™„Åè„Å™„Çä„Åæ„Åô„ÄÇ**„Åù„ÅÆ‰ª£„Çè„Çä„Å´Èáç„Åø„ÅÆÂÄãÊï∞„ÅØË®ìÁ∑¥„Éá„Éº„ÇøÁÇπ„ÅÆÂÄãÊï∞„Å´‰æùÂ≠ò„Åó„Åæ„Åô„ÄÇ**„Åì„Çå„Åå„Ç´„Éº„Éç„É´Â≠¶Áøí„ÇíÁî®„ÅÑ„ÇãÁêÜÁî±„Å´„Å™„Çä„Åæ„Åô„ÄÇË®ìÁ∑¥„Éá„Éº„Çø„Åå„Åª„Çì„ÅÆÂ∞ë„Åó„Åó„Åã„Å™„ÅÑ„ÅÆ„Å´ÁâπÂæ¥Èáè„Éô„ÇØ„Éà„É´„ÅÆÊ¨°ÂÖÉ„ÅåÂ§ß„Åç„ÅÑ(<span class="math notranslate nohighlight">\(N &lt; D\)</span>)„Å®„ÅÑ„Å£„Åü„Åì„Å®„ÅØ„Çà„Åè„ÅÇ„Çã„Åã„ÇÇ„Åó„Çå„Åæ„Åõ„Çì„ÄÇ„Ç´„Éº„Éç„É´ÂÆöÂºèÂåñ„Çí‰Ωø„ÅÜ„Åì„Å®„ÅßÈáç„Åø„ÅÆÂÄãÊï∞„ÇíÊ∏õ„Çâ„Åô„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇÁâπÂæ¥Á©∫Èñì„ÅåÁ∑öÂΩ¢ÊñπÁ®ãÂºè„Åß„É¢„Éá„É™„É≥„Ç∞„Åô„Çã„Åì„Å®„ÅåÂõ∞Èõ£„Å™ÊôÇ„Åß„ÇÇ„ÄÅ„Åù„ÅÆÁâπÂæ¥Á©∫Èñì„ÇíË®ìÁ∑¥„Éá„Éº„Çø„Å®„ÅÆË∑ùÈõ¢„Å®„Åø„Å™„Åô„Åì„Å®„ÅßÁ∑öÂΩ¢„Å®„Åó„Å¶Êâ±„Åà„Åæ„Åô(Â§ö„Åè„ÅÆÂ†¥Âêà„ÄÅ<span class="math notranslate nohighlight">\(N &gt; D\)</span>)„ÄÇÊúÄÂæå„Å´„ÄÅÁâπÂæ¥„Éô„ÇØ„Éà„É´„ÅåÁÑ°ÈôêÊ¨°ÂÖÉ(i.e. „Éô„ÇØ„Éà„É´„Åß„ÅØ„Å™„ÅèÈñ¢Êï∞„ÅÆ„Å®„Åç)„Å®„Å™„Å£„Åü„Çä„ÄÅ‰Ωï„Çâ„Åã„ÅÆÁêÜÁî±„ÅßÁâπÂæ¥„Éô„ÇØ„Éà„É´„ÇíË®àÁÆó„Åß„Åç„Å™„ÅÑ„Å®„Åç„ÇÇ„ÅÇ„Å£„Åü„Çä„Åó„Åæ„Åô„ÄÇ„Ç´„Éº„Éç„É´Â≠¶Áøí„Åß„ÅØ„ÄÅ<em>„Ç´„Éº„Éç„É´Èñ¢Êï∞</em><span class="math notranslate nohighlight">\(\left&lt;\cdot\right&gt;\)</span>„ÇíÂÆöÁæ©„Åô„ÇãÂøÖË¶Å„Åå„ÅÇ„Çã„Å†„Åë„ÅßÁâπÂæ¥„Éô„ÇØ„Éà„É´„ÇíÊòéÁ§∫ÁöÑ„Å´Êâ±„ÅÜÂøÖË¶Å„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ</p>
<p>Ë∑ùÈõ¢Èñ¢Êï∞„ÅØ<em>„Ç´„Éº„Éç„É´Èñ¢Êï∞</em><span class="math notranslate nohighlight">\(\left&lt;\cdot\right&gt;\)</span>„Å®Âëº„Å∞„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ„Ç´„Éº„Éç„É´Èñ¢Êï∞„ÅØ‰∫åÂ§âÊï∞Èñ¢Êï∞ÔºàÔºí„Å§„ÅÆÂºïÊï∞„ÇíÂèó„ÅëÂèñ„ÇãÔºâ„Åß„ÅÇ„Å£„Å¶„Çπ„Ç´„É©„ÉºÂÄ§„ÇíÂá∫Âäõ„Åó„ÄÅ‰ª•‰∏ã„ÅÆ„Çà„ÅÜ„Å™ÊÄßË≥™„ÇíÊåÅ„Å°„Åæ„Åô„ÄÇ</p>
<ol class="simple">
<li><p>Ê≠£ÂÆöÊÄß(Positive): <span class="math notranslate nohighlight">\(\left&lt;x, x'\right&gt; \geq 0\)</span></p></li>
<li><p>ÂØæÁß∞ÊÄß(Symmetric): <span class="math notranslate nohighlight">\(\left&lt;x, x'\right&gt; = \left&lt;x', x \right&gt;\)</span></p></li>
<li><p>Point-seperating: <span class="math notranslate nohighlight">\(\left&lt;x, x'\right&gt; = 0\)</span> if and only if <span class="math notranslate nohighlight">\(x = x'\)</span></p></li>
</ol>
<p>Ë®≥ËÄÖÊ≥®ÔºöPoint-separating„Å´„Åµ„Åï„Çè„Åó„ÅÑË®≥Ë™û„ÅåÁÑ°„Åã„Å£„Åü„Åü„ÇÅÂéüËëó„ÅÆËã±Ë™û„ÅÆ„Åø„ÇíË®òËºâ„Åó„Åü„ÄÇ3Áï™ÁõÆ„ÅÆÊÄßË≥™„Å´È°û‰ºº„Åó„Åü„ÇÇ„ÅÆ„Å®„Åó„Å¶Ë∑ùÈõ¢Èñ¢Êï∞„ÅÆÂÆöÁæ©„ÅÆ1„Å§„ÅÆÈùûÈÄÄÂåñÊÄß„Åå„ÅÇ„Çã„ÄÇ</p>
<p>Âè§ÂÖ∏ÁöÑ„Å™„Ç´„Éº„Éç„É´Èñ¢Êï∞„ÅÆ‰æã„Å®„Åó„Å¶<span class="math notranslate nohighlight">\(l_2\)</span>„Éé„É´„É†Ôºà„É¶„Éº„ÇØ„É™„ÉÉ„ÉâË∑ùÈõ¢Ôºâ„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ<span class="math notranslate nohighlight">\(\left&lt;\vec{x}, \vec{x}'\right&gt;=\sqrt{\sum^D_i (x_i - x_i^{'})^2}\)</span>. ÊúÄ„ÇÇËààÂë≥Ê∑±„ÅÑ„Ç´„Éº„Éç„É´Â≠¶Áøí„ÅÆÂøúÁî®„ÅÆ‰∏≠„Å´„ÅØ<span class="math notranslate nohighlight">\(x\)</span>„Åå„Éô„ÇØ„Éà„É´„Åß„ÅØ„Å™„ÅèÈñ¢Êï∞„ÇÑ‰ªñ„ÅÆÊßãÈÄ†Âåñ„Åï„Çå„Åü„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„Åß„ÅÇ„Çã„Åì„Å®„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ</p>
<div class="tip admonition">
<p class="admonition-title">‰∏ªÂΩ¢Âºè„Å®ÂèåÂØæÂΩ¢Âºè</p>
<p><strong>ÂèåÂØæÂΩ¢Âºè</strong>„Å®„ÅØ„Ç´„Éº„Éç„É´„Çí‰Ωø„ÅÜ„Å®„Åç„Å´Âëº„Å∞„Çå„Çã„É¢„Éá„É´Âºè„ÅÆ„Åì„Å®„Åß„Åô„ÄÇ<span class="math notranslate nohighlight">\(\hat{y} = \sum_i^N w_i \left&lt;\vec{x}, \vec{x}_i\right&gt;+ b\)</span>. ÂèåÂØæÂΩ¢Âºè„Å®Âå∫Âà•„Åô„Çã„Åü„ÇÅ„Å´ÈÄöÂ∏∏„ÅÆ„É¢„Éá„É´Âºè„Çí<strong>‰∏ªÂΩ¢Âºè</strong>„Å®Ë®Ä„ÅÜ„Åì„Å®„ÇÇ„Åß„Åç„Åæ„Åô„ÄÇ<span class="math notranslate nohighlight">\(\hat{y} = \vec{w}\vec{x} + b\)</span>. ‰∏ªÂΩ¢Âºè„ÇÇ„ÇØ„Éº„É´„Å´ËÅû„Åì„Åà„Åæ„Åô„Å≠„ÄÇ</p>
</div>
<p>„Ç´„Éº„Éç„É´Â≠¶Áøí„ÅØÂàÜÂ≠ê„É¢„Éá„É™„É≥„Ç∞„ÅÆÈöõ„Å´„Éù„ÉÜ„É≥„Ç∑„É£„É´„Ç®„Éç„É´„ÇÆ„ÉºÈñ¢Êï∞„ÇÑÂäõÂ†¥„ÇíÂ≠¶Áøí„Åô„Çã„Åü„ÇÅ„ÅÆÊñπÊ≥ï„Å®„Åó„Å¶Â∫É„Åè‰Ωø„Çè„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ<span id="id2">[<a class="reference internal" href="#id26" title="Matthias Rupp, Alexandre Tkatchenko, Klaus-Robert M√ºller, and O Anatole Von Lilienfeld. Fast and accurate modeling of molecular atomization energies with machine learning. Physical review letters, 108(5):058301, 2012.">RTMullerVL12</a>, <a class="reference internal" href="#id27" title="Christoph Scherer, ReneÃÅ Scheid, Denis Andrienko, and Tristan Bereau. Kernel-based machine learning for efficient simulations of molecular liquids. Journal of Chemical Theory and Computation, 16(5):3194‚Äì3204, 2020.">SSAB20</a>]</span></p>
<section id="id3">
<h2><span class="section-number">5.1. </span>Ê∫∂Ëß£Â∫¶„ÅÆ‰æã<a class="headerlink" href="#id3" title="Permalink to this headline">¬∂</a></h2>
<p>„Åù„Çå„Åß„ÅØ<a class="reference internal" href="regression.html"><span class="doc">Regression &amp; Model Assessment</span></a>„ÅÆÊ∫∂Ëß£Â∫¶„Éá„Éº„Çø„Çª„ÉÉ„ÉàAqqSolDB<span id="id4">[<a class="reference internal" href="regression.html#id25" title="Murat Cihan Sorkun, Abhishek Khetan, and S√ºleyman Er. AqSolDB, a curated reference set of aqueous solubility and 2D descriptors for a diverse set of compounds. Sci. Data, 6(1):143, 2019. doi:10.1038/s41597-019-0151-1.">SKE19</a>]</span>„ÇíÂÜç„Å≥Ë¶ã„Å¶„Åø„Åæ„Åó„Çá„ÅÜ„ÄÇ„Åù„ÅÆ„Éá„Éº„Çø„Çª„ÉÉ„Éà„Å´„ÅØÊ∞¥„ÅÆÊ∫∂Ëß£Â∫¶„ÅÆÊ∏¨ÂÆöÂÄ§(„É©„Éô„É´)„Å®17ÂÄã„ÅÆÂàÜÂ≠ê„ÅÆË®òËø∞Â≠êÔºàÁâπÂæ¥ÈáèÔºâ„Çí„ÇÇ„Å£„ÅüÁ¥Ñ10,000‰ª∂„ÅÆ„É¶„Éã„Éº„ÇØ„Å™ÂåñÂêàÁâ©„Åå„ÅÇ„Çã„Å®„ÅÑ„ÅÜ„Åì„Å®„ÇíÊÄù„ÅÑÂá∫„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
</section>
<section id="notebook">
<h2><span class="section-number">5.2. </span>Notebook„ÅÆÂÆüË°å<a class="headerlink" href="#notebook" title="Permalink to this headline">¬∂</a></h2>
<p>‰∏ä„ÅÆ¬†<i aria-label="Launch interactive content" class="fas fa-rocket"></i>¬†„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶„Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„Éñ„Å™Google Colab„Åß„Åì„ÅÆ„Éö„Éº„Ç∏„ÇíÈñãÂßã„Åó„Åæ„Åó„Çá„ÅÜ„ÄÇË©≥Á¥∞„ÅØ‰∏ãË®ò„ÅÆ„Ç§„É≥„Çπ„Éà‚Äï„É™„É≥„Ç∞„Éë„ÉÉ„Ç±„Éº„Ç∏„ÇíÂèÇÁÖß„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
<div class="dropdown admonition tip">
<p class="admonition-title">Tip</p>
<p>„Éë„ÉÉ„Ç±„Éº„Ç∏„Çí„Ç§„É≥„Çπ„Éà„Éº„É´„Åô„Çã„Å´„ÅØÊñ∞„Åó„ÅÑ„Çª„É´„Åß„Åì„ÅÆ„Ç≥„Éº„Éâ„ÇíÂÆüË°å„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!pip install dmol-book
</pre></div>
</div>
<p>„ÇÇ„Åó„Ç§„É≥„Çπ„Éà„Éº„É´„ÅßÂïèÈ°å„Åå„ÅÇ„Çå„Å∞„ÄÅ<a class="reference external" href="https://github.com/whitead/dmol-book/blob/master/package/requirements.txt">„Åì„ÅÆ„Éé„Éº„Éà„Éñ„ÉÉ„ÇØ</a>„Åß‰Ωø„Çè„Çå„Å¶„ÅÑ„ÇãÊúÄÊñ∞„Éê„Éº„Ç∏„Éß„É≥„ÅÆ„Éë„ÉÉ„Ç±„Éº„Ç∏„ÇíÂèñÂæó„Åô„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ</p>
</div>
<p>„ÅÑ„Å§„ÇÇ„Å®Âêå„Åò„Çà„ÅÜ„Å´„ÄÅ‰∏ãË®ò„ÅÆ„Ç≥„Éº„Éâ„ÅØË™≠„ÅøËæº„Åø„ÇíË°å„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">jnp</span>
<span class="kn">import</span> <span class="nn">jax</span>
<span class="kn">import</span> <span class="nn">dmol</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># soldata = pd.read_csv(&#39;https://dataverse.harvard.edu/api/access/datafile/3407241?format=original&amp;gbrecs=true&#39;)</span>
<span class="n">soldata</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;https://github.com/whitead/dmol-book/raw/master/data/curated-solubility-dataset.csv&quot;</span>
<span class="p">)</span>
<span class="n">features_start_at</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">soldata</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;MolWt&quot;</span><span class="p">)</span>
<span class="n">feature_names</span> <span class="o">=</span> <span class="n">soldata</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">features_start_at</span><span class="p">:]</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># standardize the features</span>
<span class="n">soldata</span><span class="p">[</span><span class="n">feature_names</span><span class="p">]</span> <span class="o">-=</span> <span class="n">soldata</span><span class="p">[</span><span class="n">feature_names</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">soldata</span><span class="p">[</span><span class="n">feature_names</span><span class="p">]</span> <span class="o">/=</span> <span class="n">soldata</span><span class="p">[</span><span class="n">feature_names</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id5">
<h2><span class="section-number">5.3. </span>„Ç´„Éº„Éç„É´„ÅÆÂÆöÁæ©<a class="headerlink" href="#id5" title="Permalink to this headline">¬∂</a></h2>
<p>„Ç´„Éº„Éç„É´Èñ¢Êï∞„Çí‰Ωú„Çã„Å®„Åì„Çç„Åã„ÇâÂßã„ÇÅ„Åæ„Åó„Çá„ÅÜ„ÄÇ*„Ç´„Éº„Éç„É´Èñ¢Êï∞„ÅØÂæÆÂàÜÂèØËÉΩ„Åß„ÅÇ„ÇãÂøÖË¶Å„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ*Ê∑±Â±§Â≠¶Áøí„Åß„Çà„ÅèË¶ã„ÇãÈñ¢Êï∞„Å®„ÅØÂØæÁÖßÁöÑ„Å´„ÄÅ„Ç´„Éº„Éç„É´Ê≥ï„Åß„ÅØÊ¥óÁ∑¥„Åï„Çå„ÅüÂæÆÂàÜ‰∏çÂèØËÉΩ„Å™Èñ¢Êï∞„Çí‰Ωø„ÅÜ„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ‰æã„Åà„Å∞„ÄÅ2ÂàÜÂ≠êÈñì„ÅÆ„Ç´„Éº„Éç„É´„ÇíË®àÁÆó„Åô„Çã„Åü„ÇÅ„Å´ÔºíÊàêÂàÜÁ≥ª„ÅÆÂàÜÂ≠êÂãïÂäõÂ≠¶„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥„ÇíÁî®„ÅÑ„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇÂäπÁéáÊÄß„Å®„Åì„Çå„Åæ„Åß„ÅÆÂÜÖÂÆπ„Å®„ÅÆ‰∏ÄË≤´ÊÄß„ÅÆ„Åü„ÇÅ„ÄÅ„Åì„ÅÆ‰æã„Åß„ÇÇJAX„ÇíÁî®„ÅÑ„Å¶„Ç´„Éº„Éç„É´Èñ¢Êï∞„ÇíÂÆüË£Ö„Åó„Å¶„ÅÑ„Åç„Åæ„Åô„ÄÇ„Ç´„Éº„Éç„É´„ÅØÔºí„Å§„ÅÆÁâπÂæ¥„Éô„ÇØ„Éà„É´„ÇíÂèó„ÅëÂèñ„Å£„Å¶„Çπ„Ç´„É©„Éº„ÇíËøî„Åô„Å®„ÅÑ„ÅÜ„Åì„Å®„ÇíÊÄù„ÅÑÂá∫„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ„Åì„ÅÆ‰æã„Åß„ÅØ„ÄÅ„Ç∑„É≥„Éó„É´„Å´<span class="math notranslate nohighlight">\(l_2\)</span>„Éé„É´„É†„Çí‰Ωø„ÅÑ„Åæ„Åô„ÄÇ„Åü„Å†„ÄÅÊ¨°ÂÖÉÊï∞„ÅßÈô§ÁÆó„Åô„Çã„Åì„Å®„Åß„Ç´„Éº„Éç„É´„Å´Â∞ë„Åó„Å≤„Å≠„Çä„Çí‰∏é„Åà„Å¶„ÇÑ„Çä„Åæ„Åô„ÄÇ„Åì„ÅÜ„Åô„Çã„Åì„Å®„Åß„Ç´„Éº„Éç„É´Èñ¢Êï∞„ÅÆÂá∫Âäõ„ÅÆ„Çπ„Ç±„Éº„É´„ÅØ<span class="math notranslate nohighlight">\(x\)</span>„ÅÆÊ¨°ÂÖÉÊï∞„Å´‰æùÂ≠ò„Åó„Å™„Åè„Å™„Çä„Åæ„Åô„ÄÇ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">kernel</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id6">
<h2><span class="section-number">5.4. </span>„É¢„Éá„É´ÂÆöÁæ©<a class="headerlink" href="#id6" title="Permalink to this headline">¬∂</a></h2>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Á∑öÂΩ¢ÂõûÂ∏∞„ÇíË°å„Å£„Å¶„ÅÑ„Çã„ÅÆ„ÅßÁ∑öÂΩ¢‰ª£Êï∞„ÅÆÊìç‰Ωú„Çí„Åô„Çã„Å†„Åë„ÅßÂõûÂ∏∞‰øÇÊï∞„ÇíË®àÁÆó„Åô„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ‰ªñ„Å´„ÇÇ„É¢„Éá„É´ÁâπÊúâ„ÅÆÂäπÁéáÁöÑ„Å™ÊúÄÈÅ©ÂåñÊâãÊ≥ï„ÅåÂ§ö„Åè„ÅÇ„Çä„Åæ„Åô„Åå„ÄÅ„Åì„Åì„Åß„ÅØÂãæÈÖçÈôç‰∏ãÊ≥ï„ÇíÁî®„ÅÑ„Å¶„Åì„ÅÆÂïèÈ°å„Å´„Ç¢„Éó„É≠„Éº„ÉÅ„Åó„Å¶„ÅÑ„Åè„Åì„Å®„Å´„Åó„Åæ„Åô„ÄÇ</p>
</aside>
<p>„Åì„Åì„Åß„ÅØ„ÄÅÂõûÂ∏∞„É¢„Éá„É´Âºè„Çí<em>ÂèåÂØæÂΩ¢Âºè</em>„ÅßÂÆöÁæ©„Åó„Åæ„Åô„ÄÇ‰ªªÊÑè„ÅÆÁÇπ„Å®„ÅÆË∑ùÈõ¢„ÇíË®àÁÆó„Åô„Çã„Åü„ÇÅ„Å´„Ç´„Éº„Éç„É´Èñ¢Êï∞„ÅØÂ∏∏„Å´Ë®ìÁ∑¥„Éá„Éº„Çø„ÇíÂºïÊï∞„Å´ÊåÅ„Åü„Å™„Åë„Çå„Å∞„Å™„Çâ„Å™„ÅÑ„Å®„ÅÑ„ÅÜ„Åì„Å®„ÇíÊÄù„ÅÑÂá∫„Åó„Åæ„Åó„Çá„ÅÜ„ÄÇÊñ∞„Åó„ÅÑÂÖ•Âäõ„Éá„Éº„Çø„Å´ÂØæ„Åó„Å¶ÂêåÊôÇ„Å´ÂÖ®„Å¶„ÅÆ„Ç´„Éº„Éç„É´„ÇíË®àÁÆó„Åô„Çã„Åü„ÇÅ„Å´JAX„ÅÆ„Éê„ÉÉ„ÉÅÁâπÂæ¥Èáè„Çí‰Ωø„ÅÑ„Åæ„Åô„ÄÇ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">train_x</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="c1"># make vectorized version of kernel</span>
    <span class="n">vkernel</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">out_axes</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1"># compute kernel with all training data</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">vkernel</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">train_x</span><span class="p">)</span>
    <span class="c1"># dual form</span>
    <span class="n">yhat</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span>
    <span class="k">return</span> <span class="n">yhat</span>


<span class="c1"># make batched version that can handle multiple xs</span>
<span class="n">batch_model</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">out_axes</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id7">
<h2><span class="section-number">5.5. </span>„Éà„É¨„Éº„Éã„É≥„Ç∞<a class="headerlink" href="#id7" title="Permalink to this headline">¬∂</a></h2>
<p>„Åì„ÅÆÊôÇÁÇπ„ÅßË®ìÁ∑¥ÂèØËÉΩ„Å™Èáç„Åø„Å®„É¢„Éá„É´Âºè„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ„Éà„É¨„Éº„Éã„É≥„Ç∞„ÇíÂßã„ÇÅ„Çã„Åü„ÇÅ„Å´„ÄÅÊêçÂ§±Èñ¢Êï∞„Å®„Åù„ÅÆÂãæÈÖç„ÇíÂÆöÁæ©„Åô„ÇãÂøÖË¶Å„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ„Åì„Åì„Åß„ÅØ„ÅÑ„Å§„ÇÇ„Å®Âêå„Åò„Çà„ÅÜ„Å´Âπ≥Âùá‰∫å‰πóË™§Â∑Æ„ÇíÊêçÂ§±Èñ¢Êï∞„Å®„Åó„Å¶Áî®„ÅÑ„Åæ„Åô„ÄÇÂâçÂõûË¶ã„Åü„Çà„ÅÜ„Å´„ÄÅÊ≠£ÂâáÂåñ„ÇíÂà©Áî®„Åô„Çã„Åì„Å®„ÇÇ„Åß„Åç„Åæ„Åô„Åå‰ªä„ÅÆ„Å®„Åì„Çç„ÅØ„Çπ„Ç≠„ÉÉ„Éó„Åó„Å¶„Åä„Åç„Åæ„Åó„Çá„ÅÜ„ÄÇ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span> <span class="nf">loss</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">train_x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">batch_model</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">train_x</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>


<span class="n">loss_grad</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">grad</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>


<span class="c1"># Get 80/20 split</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">soldata</span><span class="p">)</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">soldata</span><span class="p">[:</span> <span class="nb">int</span><span class="p">(</span><span class="n">N</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)]</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">soldata</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">N</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span> <span class="p">:]</span>

<span class="c1"># convert from pandas dataframe to numpy arrays</span>
<span class="n">train_x</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">feature_names</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">train_y</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s2">&quot;Solubility&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">test_x</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="n">feature_names</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">test_y</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s2">&quot;Solubility&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
<p>ÊêçÂ§±Èñ¢Êï∞„ÇíÂÆöÁæ©„Åó„ÄÅ„Éá„Éº„Çø„ÇíË®ìÁ∑¥„Éá„Éº„Çø„Å®„ÉÜ„Çπ„Éà„Éá„Éº„Çø„Å´ÂàÜ„Åë„Åæ„Åó„Åü„ÄÇ„Éà„É¨„Éº„Éã„É≥„Ç∞„Éá„Éº„Çø„Çí„Éê„ÉÉ„ÉÅ„Å´ÂàÜ„Åë„Çã„Åì„Å®„ÇÇÂê´„ÇÅ„Å¶„ÄÅË®ìÁ∑¥„Éë„É©„É°„Éº„Çø„Éº„Çí„Åì„Åì„ÅßË®≠ÂÆö„Åó„Å¶„ÅÑ„Åç„Åæ„Åô„ÄÇ<strong>„Ç®„Éù„ÉÉ„ÇØ</strong>„Å®„ÅØ„Éá„Éº„Çø„Çª„ÉÉ„ÉàÂÖ®‰Ωì„ÇíÈÄö„Åó„Å¶„ÅÆ1Âõû„ÅÆ„Ç§„ÉÜ„É¨„Éº„Ç∑„Éß„É≥„Åß„Åô„ÄÇ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eta</span> <span class="o">=</span> <span class="mf">1e-5</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">epochs</span> <span class="o">=</span> <span class="mi">10</span>


<span class="c1"># reshape into batches</span>
<span class="n">batch_num</span> <span class="o">=</span> <span class="n">train_x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="n">batch_size</span>
<span class="c1"># first truncate data so it&#39;s whole nubmer of batches</span>
<span class="n">trunc</span> <span class="o">=</span> <span class="n">batch_num</span> <span class="o">*</span> <span class="n">batch_size</span>
<span class="n">train_x</span> <span class="o">=</span> <span class="n">train_x</span><span class="p">[:</span><span class="n">trunc</span><span class="p">]</span>
<span class="n">train_y</span> <span class="o">=</span> <span class="n">train_y</span><span class="p">[:</span><span class="n">trunc</span><span class="p">]</span>
<span class="c1"># split into batches</span>
<span class="n">x_batches</span> <span class="o">=</span> <span class="n">train_x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">train_x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">y_batches</span> <span class="o">=</span> <span class="n">train_y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">)</span>


<span class="c1"># make trainable parameters</span>
<span class="c1"># w = np.random.normal(scale = 1e-30, size=train_x.shape[0])</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">train_x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">train_y</span><span class="p">)</span>  <span class="c1"># just set to mean, since it&#39;s a good first guess</span>
</pre></div>
</div>
</div>
</div>
<p>Â≠¶ÁøíÁéá<span class="math notranslate nohighlight">\(\eta\)</span>„Åå<span class="math notranslate nohighlight">\(10^{-5}\)</span>„Å®ÊôÆÈÄö„Çà„ÇäÂ∞è„Åï„ÅÑ„Åì„Å®„Å´Ê∞ó„Åå‰ªò„ÅÑ„Åü‰∫∫„Åå„ÅÑ„Çã„Åã„ÇÇ„Åó„Çå„Åæ„Åõ„Çì„ÄÇ„Åì„ÅÆÁêÜÁî±„ÅØ„Å®„ÅÑ„ÅÜ„Å®„ÄÅÁ¥Ñ8,000ÂÄã„ÅÇ„Çã„Éà„É¨„Éº„Éã„É≥„Ç∞„Éá„Éº„ÇøÁÇπ„ÅÆ„Åù„Çå„Åû„Çå„ÅåÊúÄÂæå„ÅÆ<span class="math notranslate nohighlight">\(\hat{y}\)</span>„Å´ÂØÑ‰∏é„Åó„Å¶„ÅÑ„Çã„Åã„Çâ„Åß„Åô„ÄÇ„Åù„Çå„ÇÜ„Åà„ÄÅ„ÇÇ„ÅóÂ≠¶Áøí„Çπ„ÉÜ„ÉÉ„Éó„ÇíÂ§ß„Åç„Åè„Åó„Å¶„Åó„Åæ„ÅÜ„Å®<span class="math notranslate nohighlight">\(\hat{y}\)</span>„Å´Â§ß„Åç„Å™Â§âÂåñ„ÇíÂèä„Åº„Åó„Å¶„Åó„Åæ„ÅÜÂèØËÉΩÊÄß„Åå„ÅÇ„Çã„ÅÆ„Åß„Åô„ÄÇ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loss_progress</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">test_loss_progress</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
    <span class="c1"># go in random order</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">batch_num</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">batch_num</span><span class="p">):</span>
        <span class="c1"># update step</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x_batches</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">y_batches</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">loss_progress</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">train_x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
        <span class="n">test_loss_progress</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">train_x</span><span class="p">,</span> <span class="n">test_x</span><span class="p">,</span> <span class="n">test_y</span><span class="p">))</span>
        <span class="n">grad</span> <span class="o">=</span> <span class="n">loss_grad</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">train_x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">w</span> <span class="o">-=</span> <span class="n">eta</span> <span class="o">*</span> <span class="n">grad</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">b</span> <span class="o">-=</span> <span class="n">eta</span> <span class="o">*</span> <span class="n">grad</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">loss_progress</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Training Loss&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_loss_progress</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Testing Loss&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Step&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Loss&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:absl:No GPU/TPU found, falling back to CPU. (Set TF_CPP_MIN_LOG_LEVEL=0 and rerun for more info.)
</pre></div>
</div>
<img alt="../_images/kernel_15_1.png" src="../_images/kernel_15_1.png" />
</div>
</div>
<p>ÂÖà„Åª„Å©„ÅÆ„Éà„É¨„Éº„Éã„É≥„Ç∞„É´„Éº„Éó„Å®„ÅÆÈÅï„ÅÑ„ÅØ<code class="docutils literal notranslate"><span class="pre">for</span></code>„É´„Éº„Éó„Åß„Éê„ÉÉ„ÉÅ„Çí„É©„É≥„ÉÄ„É†Âåñ„Åó„Åü„Åì„Å®„Åß„Åô„ÄÇ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">yhat</span> <span class="o">=</span> <span class="n">batch_model</span><span class="p">(</span><span class="n">test_x</span><span class="p">,</span> <span class="n">train_x</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_y</span><span class="p">,</span> <span class="n">test_y</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_y</span><span class="p">,</span> <span class="n">yhat</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;correlation = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">test_y</span><span class="p">,</span> <span class="n">yhat</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;loss = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">test_y</span> <span class="o">-</span> <span class="n">yhat</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Testing Data&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/kernel_17_0.png" src="../_images/kernel_17_0.png" />
</div>
</div>
<p>„Åì„ÅÆÁµêÊûú„ÅØÈÅéÂ∞èÈÅ©Âêà„Åó„Å¶„ÅÑ„Çã„Å®Ë¶ãÂèó„Åë„Çâ„Çå„Åæ„Åô„ÄÇ„ÅÑ„Å§„ÇÇ„Å®Âêå„Åò„Çà„ÅÜ„Å´„ÄÅ„Åì„ÅÆ„Ç≥„Éº„Éâ„ÇíÈ´òÈÄü„Å´ÂÆüË°å„Åï„Åõ„Åü„ÅÑ„ÅÆ„Åß„ÄÅÂ§ß„Åç„ÅÑ„Ç®„Éù„ÉÉ„ÇØÊï∞„Åß„Ç≥„Éº„Éâ„ÇíÂÆüË°å„Åó„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ„ÄÇ„Ç®„Éù„ÉÉ„ÇØÊï∞„ÇíÂ¢ó„ÇÑ„Åó„Å¶ÊêçÂ§±„Å®Áõ∏Èñ¢„ÅåÊôÇÈñìÁµåÈÅé„Å®„Å®„ÇÇ„Å´ÊîπÂñÑ„Åï„Çå„Å¶„ÅÑ„Åè„Å®„Åì„Çç„ÇíË¶ã„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ</p>
</section>
<section id="id8">
<h2><span class="section-number">5.6. </span>Ê≠£ÂâáÂåñ<a class="headerlink" href="#id8" title="Permalink to this headline">¬∂</a></h2>
<p>Ë™≠ËÄÖ„ÅÆ‰∏≠„Å´„ÅØ„ÄÅË®ìÁ∑¥ÂèØËÉΩ„Å™„Éë„É©„É°„Éº„Çø„ÉºÊï∞„ÅåÊÑèÂõ≥ÁöÑ„Å´Ë®ìÁ∑¥„Éá„Éº„ÇøÁÇπ„ÅÆÂÄãÊï∞„Å®Á≠â„Åó„Åè„Åó„Å¶„ÅÇ„Çã„Åì„Å®„Å´Ê∞ó„Å•„ÅÑ„Åü‰∫∫„Åå„ÅÑ„Çã„Åã„ÇÇ„Åó„Çå„Åæ„Åõ„Çì„ÄÇ„ÇÇ„Åó‰ªÆ„Å´Êì¨‰ººÈÄÜË°åÂàó„ÇíÁî®„ÅÑ„Å¶ÂõûÂ∏∞‰øÇÊï∞„ÇíÁõ¥Êé•Ë®àÁÆó„Åó„ÅüÂ†¥Âêà„ÄÅ„Åì„Çå„ÅÆ„Åõ„ÅÑ„ÅßÂïèÈ°å„Å´Áõ¥Èù¢„Åô„Çã„Åì„Å®„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ„Åù„Çå„ÇÜ„Åà„ÄÅË°åÂàóË®àÁÆó„ÅÆËß£„ÅåÊï∞Â≠¶ÁöÑ„Å´Êâ±„ÅÑ„ÇÑ„Åô„Åè„Åß„Åç„Çã„Çà„ÅÜ„Å´„ÄÅ„Åù„Åó„Å¶Ë®ìÁ∑¥ÂèØËÉΩ„Éë„É©„É°„Éº„Çø„Éº„ÅåÂ§ö„ÅÑ„Åª„ÅÜ„ÅåË≥¢Êòé„Å†„Å®ÊÄù„Çè„Çå„Çã„ÅÆ„ÅßÊ≠£ÂâáÂåñÈ†Ö„ÇíËøΩÂä†„Åó„Åæ„Åô„ÄÇÁ∑öÂΩ¢ÂõûÂ∏∞„É¢„Éá„É´„ÅßË¶ã„Å¶„Åç„Åü„Çà„ÅÜ„Å´„ÄÅL1ÂõûÂ∏∞„ÅØ<strong>„É©„ÉÉ„ÇΩ„Éª„É™„ÉÉ„Ç∏ÂõûÂ∏∞</strong>„Å®„Åó„Å¶Áü•„Çâ„Çå„ÄÅL2ÂõûÂ∏∞„ÅØ<strong>„Ç´„Éº„Éç„É´„É™„ÉÉ„Ç∏ÂõûÂ∏∞</strong>„Å®„Åó„Å¶Áü•„Çâ„Çå„Åæ„Åô„ÄÇL1ÂõûÂ∏∞„ÅØÁâπÂæ¥Èáè„ÅÆÈáçË¶ÅÂ∫¶„ÇíËß£Èáà„Åô„Çã„ÅÆ„Å´‰Ωø„Åà„ÇãÁâπÂÆö„ÅÆ„Éë„É©„É°„Éº„Çø„Éº„ÇíÊ¥ó„ÅÑÂá∫„Åô„Åì„Å®„Åå„Åß„Åç„Çã„Åì„Å®„ÇíÊÄù„ÅÑÂá∫„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ„Åó„Åã„Åó„Å™„Åå„Çâ„ÄÅ„Ç´„Éº„Éç„É´Ê≥ï„Åß„ÅØÁâπÂÆö„ÅÆË®ìÁ∑¥„Éá„Éº„ÇøÁÇπ„Å®„ÅÆÈñ¢‰øÇ„ÇíÁ§∫„Åô„Å†„Åë„Åß‰Ωï„ÇÇÁèæÂÆüÁöÑ„Å™Ê¥ûÂØü„Çí‰∏é„Åà„Å¶„ÅØ„Åè„Çå„Åæ„Åõ„Çì(<a class="reference internal" href="../dl/xai.html"><span class="doc">‰∫àÊ∏¨„ÇíË™¨Êòé„Åô„Çã</span></a>)ÂèÇÁÖß)„ÄÇ„Åù„ÅÜ„ÅÑ„ÅÜ„Çè„Åë„Åß„Ç´„Éº„Éç„É´„É™„ÉÉ„Ç∏ÂõûÂ∏∞„ÅØ„Ç´„Éº„Éç„É´Ê≥ï„ÅÆÁØÑÁñá„Åß„ÅØÊúâÂêç„Åß„Åô„ÄÇ</p>
</section>
<section id="id9">
<h2><span class="section-number">5.7. </span>Â≠¶ÁøíÊõ≤Á∑ö<a class="headerlink" href="#id9" title="Permalink to this headline">¬∂</a></h2>
<p>Ôºà<a class="reference internal" href="regression.html"><span class="doc">Regression &amp; Model Assessment</span></a>„ÅÆ„Éê„Ç§„Ç¢„Çπ-„Éê„É™„Ç¢„É≥„Çπ„Éà„É¨„Éº„Éâ„Ç™„Éï„ÅØ„ÄÅ„É¢„Éá„É´„ÅÆË§áÈõë„Åï„ÇíÂ¢óÂä†„Åï„Åõ„Çã„Å®„ÄÅ„É¢„Éá„É´„ÅÆ„Éê„É™„Ç¢„É≥„ÇπÔºà„Éà„É¨„Éº„Éã„É≥„Ç∞„Éá„Éº„Çø„ÅÆÈÅ∏Êäû„ÅÆ‰ªïÊñπ„Å®Èáè„Å´„Çà„ÇäÂº∑„ÅèÂΩ±Èüø„ÇíÂèó„Åë„ÇãÔºâ„ÅÆÂ¢óÂä†„ÇíÁä†Áâ≤„Å´„Åó„Å¶„Å©„Çå„Åª„Å©„É¢„Éá„É´„ÅÆ„Éê„Ç§„Ç¢„ÇπÔºà„Çà„ÇäË°®ÁèæÂäõ„ÅåÈ´ò„Åè„ÄÅ„Çà„ÇäËâØ„Åè„Éá„Éº„Çø„Å´ÈÅ©Âêà„Åß„Åç„ÇãÔºâ„ÇíËªΩÊ∏õ„Åß„Åç„Çã„Åã„Å´„Å§„ÅÑ„Å¶Á§∫„Åó„Åæ„Åó„Åü„ÄÇ„É¢„Éá„É´„ÅÆË§áÈõë„Åï„ÅØÁâπÂæ¥Èáè„ÅÆÂÄãÊï∞„ÇíË™øÊï¥„Åô„Çã„Åì„Å®„Å´„Çà„Å£„Å¶Âà∂Âæ°„Åô„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åó„Åü„ÄÇ„Ç´„Éº„Éç„É´Ê≥ï„Åß„ÅØÁâπÂæ¥Èáè„ÅÆÂÄãÊï∞„Çí„Ç≥„É≥„Éà„É≠„Éº„É´„Åó„Åæ„Åõ„Çì„ÄÇ„Å®„ÅÑ„ÅÜ„ÅÆ„ÇÇ„Åù„Çå„ÅåË®ìÁ∑¥„Éá„Éº„ÇøÁÇπ„ÅÆÂÄãÊï∞„Å®Â∏∏„Å´‰∏ÄËá¥„Åô„Çã„Åã„Çâ„Åß„Åô„ÄÇ„Åù„Çå„ÇÜ„Åà„ÄÅ„Ç´„Éº„Éç„É´„ÅÆÈÅ∏Êäû„ÇÑÊ≠£ÂâáÂåñ„ÄÅÂ≠¶ÁøíÁéá„Å™„Å©„ÅÆ„Çà„ÅÜ„Å™„Éè„Ç§„Éë„Éº„Éë„É©„É°„Éº„Çø„Éº„Çí„Ç≥„É≥„Éà„É≠„Éº„É´„Åô„Çã„Å†„Åë„Å´„Å™„Çä„Åæ„Åô„ÄÇ„Åì„ÅÆ„Éè„Ç§„Éë„Éº„Éë„É©„É°„Éº„Çø„Éº„ÅÆÂäπÊûú„ÇíË©ï‰æ°„Åô„Çã„Åü„ÇÅ„Å´„ÉÜ„Çπ„Éà„ÅÆÊêçÂ§±„ÇíË®àÁÆó„Åô„Çã„Å†„Åë„Åß„ÅØÁµÇ„Çè„Çã„Åì„Å®„ÅØ„Åß„Åç„Åæ„Åõ„Çì„ÄÇ„Å™„Åú„Å™„Çâ„Åù„ÅÆÊêçÂ§±„Åå„Éà„É¨„Éº„Éã„É≥„Ç∞„Éá„Éº„Çø„ÅÆÈáè„Å´Âº∑„ÅèÈñ¢‰øÇ„Åó„Å¶„ÅÑ„Çã„Åã„Çâ„Åß„Åô„ÄÇÂ§ö„Åè„ÅÆË®ìÁ∑¥„Éá„Éº„Çø„Åå„ÅÇ„Çã„Å®„ÅÑ„ÅÜ„Åì„Å®„ÅØ„É¢„Éá„É´„Åå„Çà„ÇäÊ¥óÁ∑¥„Åï„Çå„Çã„Å®„ÅÑ„ÅÜ„Åì„Å®„ÇíÊÑèÂë≥„Åó„ÄÅÊêçÂ§±„ÅÆÂÄ§„ÅåÊ∏õÂ∞ë„Åó„Åæ„Åô„ÄÇ„Å™„ÅÆ„Åß„ÄÅ„Å®„Çä„Çè„Åë„Ç´„Éº„Éç„É´Â≠¶Áøí„Åß„ÅØ„Éà„É¨„Éº„Éã„É≥„Ç∞„Éá„Éº„Çø„ÅÆÈáè„Å´ÂØæ„Åó„Å¶„ÉÜ„Çπ„ÉàÊêçÂ§±„ÅÆÂÄ§„Åå„Å©„Çå„Åª„Å©Â§â„Çè„Çã„ÅÆ„Åã„ÇíÁ§∫„Åô„Å®„ÅÑ„ÅÜ„Åì„Å®„ÅØÂ∏∏Ë≠òÁöÑ„Å™„Åì„Å®„Åß„Åô„ÄÇÂÄ§„ÅåÂ§ß„Åç„Å™„Çπ„Ç±„Éº„É´„ÅßÂ§âÂåñ„Åô„Çã„ÅÆ„Åß„Åì„Çå„Çâ„ÅØÂØæÊï∞-ÂØæÊï∞„Éó„É≠„ÉÉ„Éà„ÅßÁ§∫„Åï„Çå„Åæ„Åô„ÄÇ„Åì„Çå„Çâ„ÅØ<strong>Â≠¶ÁøíÊõ≤Á∑ö</strong>(„ÇÇ„Åó„Åè„ÅØ<strong>Learning curves</strong>)„Å®Âëº„Å∞„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇÂ≠¶ÁøíÊõ≤Á∑ö„ÅØÊ©üÊ¢∞Â≠¶Áøí„ÇÑÊ∑±Â±§Â≠¶Áøí„ÅßÂ∫É„Åè‰Ωø„Çè„Çå„Å¶„ÅÑ„Åæ„Åô„Åå„ÄÅ„Ç´„Éº„Éç„É´Â≠¶Áøí„Åß„ÇÇÈ†ªÁπÅ„Å´Ë¶ã„Çã„Åì„Å®„Å´„Å™„Çä„Åæ„Åô„ÄÇ</p>
<p>Ê∫∂Ëß£Â∫¶„ÅÆ„É¢„Éá„É´„Å´ÂÜç„Å≥Êàª„Å£„Å¶Â≠¶ÁøíÊõ≤Á∑ö„ÇíÁî®„ÅÑ„Å¶L1„Å®L2„ÅÆÊ≠£ÂâáÂåñ„ÇíÊØîËºÉ„Åó„Å¶„Åø„Åæ„Åó„Çá„ÅÜ„ÄÇÊ≥®ÊÑè„Åó„Å¶„Åä„Åç„Åæ„Åô„Åå„ÄÅ<span class="math notranslate nohighlight">\(M\)</span>ÂÄã„ÅÆ„É¢„Éá„É´Ôºà<span class="math notranslate nohighlight">\(M\)</span>„ÅØÂ≠¶ÁøíÊõ≤Á∑ö„ÅßÂèñÂæó„Åó„Åü„ÅÑÁÇπ„ÅÆÂÄãÊï∞Ôºâ„ÇíË®àÁÆó„Åó„Å™„Åë„Çå„Å∞„Å™„Çâ„Å™„ÅÑ„ÅÆ„Åß„ÄÅ„Åì„ÅÆ„Ç≥„Éº„Éâ„ÅØÈùûÂ∏∏„Å´ÈÅÖ„Åè„Å™„Çä„Åæ„Åô„ÄÇ„Åì„ÅÆ„ÉÜ„Ç≠„Çπ„Éà„Åß„ÅØÂäπÁéáÊÄß„Çí‰øù„Å§„Åü„ÇÅ„Å´Â≠¶ÁøíÊõ≤Á∑ö‰∏ä„ÅÆÁÇπ„Å®„Åó„Å¶Êï∞ÂÄã„ÇíÁî®„ÅÑ„Çã„Åì„Å®„Å´„Åó„Åæ„Åô„ÄÇ</p>
<p>ÊúÄÂàù„Å´„Éà„É¨„Éº„Éã„É≥„Ç∞„ÅÆÈÅéÁ®ã„ÇíÈñ¢Êï∞„Å´„Åæ„Å®„ÇÅ„Åæ„Åô„ÄÇ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fit_model</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">25</span><span class="p">):</span>

    <span class="n">sample_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">train_x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">npoints</span>
    <span class="p">)</span>
    <span class="n">sample_x</span> <span class="o">=</span> <span class="n">train_x</span><span class="p">[</span><span class="n">sample_idx</span><span class="p">,</span> <span class="p">:]</span>
    <span class="n">sample_y</span> <span class="o">=</span> <span class="n">train_y</span><span class="p">[</span><span class="n">sample_idx</span><span class="p">]</span>

    <span class="c1"># reshape into batches</span>
    <span class="n">batch_num</span> <span class="o">=</span> <span class="n">npoints</span> <span class="o">//</span> <span class="n">batch_size</span>
    <span class="c1"># first truncate data so it&#39;s whole nubmer of batches</span>
    <span class="n">trunc</span> <span class="o">=</span> <span class="n">batch_num</span> <span class="o">*</span> <span class="n">batch_size</span>
    <span class="n">sample_x</span> <span class="o">=</span> <span class="n">sample_x</span><span class="p">[:</span><span class="n">trunc</span><span class="p">]</span>
    <span class="n">sample_y</span> <span class="o">=</span> <span class="n">sample_y</span><span class="p">[:</span><span class="n">trunc</span><span class="p">]</span>
    <span class="c1"># split into batches</span>
    <span class="n">x_batches</span> <span class="o">=</span> <span class="n">sample_x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">sample_x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">y_batches</span> <span class="o">=</span> <span class="n">sample_y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">)</span>

    <span class="c1"># get loss grad</span>
    <span class="n">loss_grad</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">grad</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="c1"># make trainable parameters</span>
    <span class="c1"># w = np.random.normal(scale = 1e-30, size=train_x.shape[0])</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">sample_x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample_y</span><span class="p">)</span>  <span class="c1"># just set to mean, since it&#39;s a good first guess</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
        <span class="c1"># go in random order</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">batch_num</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">batch_num</span><span class="p">):</span>
            <span class="c1"># update step</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">x_batches</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">y_batches</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">grad</span> <span class="o">=</span> <span class="n">loss_grad</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">sample_x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
            <span class="n">w</span> <span class="o">-=</span> <span class="n">eta</span> <span class="o">*</span> <span class="n">grad</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">b</span> <span class="o">-=</span> <span class="n">eta</span> <span class="o">*</span> <span class="n">grad</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">loss</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">sample_x</span><span class="p">,</span> <span class="n">test_x</span><span class="p">,</span> <span class="n">test_y</span><span class="p">)</span>


<span class="c1"># test it out</span>
<span class="n">fit_model</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DeviceArray(3.8454313, dtype=float32)
</pre></div>
</div>
</div>
</div>
<p>„Åì„Åì„Åß„ÅØÁßÅ„Åü„Å°Â∞ÇÁî®„ÅÆL1„Å®L2„Éê„Éº„Ç∏„Éß„É≥„ÅÆÊêçÂ§±Èñ¢Êï∞„Çí‰Ωú„Å£„Å¶„ÅÑ„Åç„Åæ„Åô„ÄÇÊ≠£ÂâáÂåñ„ÅÆ*Âº∑Â∫¶(strength)*„ÇíÈÅ∏Êäû„Åó„Å™„Åë„Çå„Å∞„Å™„Çä„Åæ„Åõ„Çì„ÄÇÈáç„Åø„ÅØ1„Çà„ÇäÂ∞è„Åï„ÅÑ„ÅÆ„ÅßL2„Å´ÂØæ„Åó„Å¶„ÅØ„Çà„Çä„ÇÇ„Å£„Å®Âº∑„ÅÑÊ≠£ÂâáÂåñ„ÅÆÂº∑Â∫¶„ÇíÈÅ∏Êäû„Åô„Çã„Åì„Å®„Å´„Åó„Åæ„Åô„ÄÇ„Åì„Çå„Çâ„ÅØ„Éè„Ç§„Éë„Éº„Éë„É©„É°„Éº„Çø„Éº„Åß„Åô„Åå„Éï„Ç£„ÉÉ„ÉÜ„Ç£„É≥„Ç∞„ÇíÂêë‰∏ä„Åï„Åõ„Çã„Åü„ÇÅ„Å´Ë™øÊï¥„Åó„Å¶„ÇÇÂïèÈ°å„Å™„ÅÑ„Åß„Åô„ÄÇ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span> <span class="nf">loss_l1</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">train_x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">batch_model</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">train_x</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
        <span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
    <span class="p">)</span>


<span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span> <span class="nf">loss_l2</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">train_x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">batch_model</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">train_x</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>„Åù„Åó„Å¶„ÄÅÂ≠¶ÁøíÊõ≤Á∑ö„Å´ÂøÖË¶Å„Å™ÁÇπ„ÇíÁîüÊàê„Åó„Åæ„ÅôÔºÅ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nvalues</span> <span class="o">=</span> <span class="p">[</span><span class="mi">32</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="mi">2048</span><span class="p">,</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">5</span><span class="p">]</span>

<span class="n">nor_losses</span> <span class="o">=</span> <span class="p">[</span><span class="n">fit_model</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nvalues</span><span class="p">]</span>
<span class="n">l1_losses</span> <span class="o">=</span> <span class="p">[</span><span class="n">fit_model</span><span class="p">(</span><span class="n">loss_l1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nvalues</span><span class="p">]</span>
<span class="n">l2_losses</span> <span class="o">=</span> <span class="p">[</span><span class="n">fit_model</span><span class="p">(</span><span class="n">loss_l2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nvalues</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nvalues</span><span class="p">,</span> <span class="n">nor_losses</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;No Regularization&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nvalues</span><span class="p">,</span> <span class="n">l1_losses</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;L1 Regularization&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nvalues</span><span class="p">,</span> <span class="n">l2_losses</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;L2 Regularization&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Training Data Amount&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Test Loss&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/kernel_26_0.png" src="../_images/kernel_26_0.png" />
</div>
</div>
<p>ÊúÄÂæå„Å´Âà•„ÄÖ„ÅÆ„Ç¢„Éó„É≠„Éº„ÉÅ„Çí„Å®„Å£„ÅüÂ≠¶ÁøíÊõ≤Á∑ö„ÇíË¶ã„Å¶„Åø„Åæ„Åó„Çá„ÅÜ„ÄÇÊ≠£ÂâáÂåñ„ÅØ„ÉÜ„Çπ„Éà„Éá„Éº„Çø„ÅÆÊúÄÁµÇÁöÑ„Å™ÊêçÂ§±„Å´„Å™„Å´„Åã„Åó„Çâ„ÅÆÂΩ±Èüø„ÇíÂèä„Åº„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇL1„Å®L2Ê≠£ÂâáÂåñ„ÅØÂçòÁ¥î„Å´ÊÇ™„Åè„Å™„Å£„Å¶„ÅÑ„Çã„Åã„ÅÆÊòØÈùû„ÇÑÊ≠£ÂâáÂåñ„ÅÆÂº∑Â∫¶„Çí„ÇÇ„Å£„Å®Ë™øÊï¥„Åó„Åü„Åª„ÅÜ„ÅåËâØ„ÅÑ„Åã„Å©„ÅÜ„Åã„Å´„Å§„ÅÑ„Å¶Ë®ÄÂèä„Åô„Çã„Åì„Å®„ÅØÂõ∞Èõ£„Åß„Åô„ÄÇ„Å®„ÅØË®Ä„Åà„ÄÅ„Åì„ÅÆ„Éó„É≠„ÉÉ„Éà„ÇíË¶ã„ÇãÈôê„Çä„Åß„ÅØÊàë„ÄÖ„Åå„Ç´„Éº„Éç„É´Â≠¶ÁøíÊ≥ï„ÇíÂÖ∏ÂûãÁöÑ„Å™ÊñπÊ≥ï„ÅßË©ï‰æ°„Åó„Åü„Å®„ÅÑ„ÅÜ„Åì„Å®„ÅØ„Çè„Åã„Çä„Åæ„Åô„ÄÇ</p>
</section>
<section id="id10">
<h2><span class="section-number">5.8. </span>Á∑¥ÁøíÂïèÈ°å<a class="headerlink" href="#id10" title="Permalink to this headline">¬∂</a></h2>
<ol class="simple">
<li><p>ÂèåÂØæÂΩ¢Âºè„ÅÆÂõûÂ∏∞Âºè„Åã„ÇâÂãæÈÖç„ÇíË®àÁÆó„Åó„ÄÅ„Åù„ÅÆË®àÁÆóÁµêÊûú„ÇíÁî®„ÅÑ„Å¶„Ç´„Éº„Éç„É´Èñ¢Êï∞„Åå„Å™„ÅúÂæÆÂàÜÂèØËÉΩ„Åß„ÅÇ„ÇãÂøÖË¶Å„Åå„Å™„ÅÑ„ÅÆ„Åã„Å´„Å§„ÅÑ„Å¶Ë™¨Êòé„Åó„Å™„Åï„ÅÑ„ÄÇ</p></li>
<li><p>„Ç´„Éº„Éç„É´Â≠¶Áøí„Åß„Éà„É¨„Éº„Éã„É≥„Ç∞„ÇíË°å„ÅÜ„Å®ÈÄü„ÅÑ„ÅãÈÅÖ„ÅÑ„ÅãÔºüË™¨Êòé„Åó„Å™„Åï„ÅÑ„ÄÇ</p></li>
<li><p>„Ç´„Éº„Éç„É´Â≠¶Áøí„Åß‰∫àÊ∏¨„Åô„Çã„ÅÆ„ÅØÈÄü„ÅÑ„ÅãÈÅÖ„ÅÑ„ÅãÔºüË™¨Êòé„Åó„Å™„Åï„ÅÑ„ÄÇ</p></li>
<li><p>ÂàÜÈ°û„Çø„Çπ„ÇØ„ÇíË°å„ÅÜ„Åü„ÇÅ„Å´Âºè4.2„Çí„Å©„ÅÆ„Çà„ÅÜ„Å´‰øÆÊ≠£„Åô„Çå„Å∞„Çà„ÅÑ„ÅãÔºü</p></li>
<li><p>„Ç´„Éº„Éç„É´„ÅÆÁ®ÆÈ°û„Å´Èñ¢„Çè„Çâ„Åö„ÄÅÈáç„Åø„ÅÆÂÄ§„Åå„Éà„É¨„Éº„Éã„É≥„Ç∞„Éá„Éº„Çø„ÅÆÁõ∏ÂØæÁöÑ„Å™ÈáçË¶ÅÂ∫¶„ÇíÁ§∫„Åó„Å¶„ÅÑ„Çã„Å†„Çç„ÅÜ„ÅãÔºü</p></li>
<li><p>‰∏äË®ò„ÅÆ‰æã„Åã„ÇâL1Ê≠£ÂâáÂåñ„ÅÆÂº∑Â∫¶„ÅåÁï∞„Å™„Çã5„Å§„ÅÆÂ≠¶ÁøíÊõ≤Á∑ö„Çí‰ΩúÊàê„Åó„Å™„Åï„ÅÑ„ÄÇ„Åì„ÅÆ‰æã„ÅßÊ≠£ÂâáÂåñ„ÅåÊÑèÂë≥„Çí„Å™„Åï„Å™„ÅÑ„ÅÆ„Å™„ÅÑ„ÅÆ„ÅØ„Å™„Åú„ÅãÔºü</p></li>
</ol>
</section>
<section id="id11">
<h2><span class="section-number">5.9. </span>Á´†„ÅÆ„Åæ„Å®„ÇÅ<a class="headerlink" href="#id11" title="Permalink to this headline">¬∂</a></h2>
<ul class="simple">
<li><p>„Åì„ÅÆÁ´†„Åß„ÅØ„Ç´„Éº„Éç„É´Â≠¶Áøí„ÇíÁ¥π‰ªã„Åó„Åü„ÄÇ„Ç´„Éº„Éç„É´Â≠¶Áøí„ÅØÁâπÂæ¥Èáè„Çí„Çµ„É≥„Éó„É´Èñì„ÅÆË∑ùÈõ¢„Å´Â§âÊèõ„Åô„ÇãÊñπÊ≥ï„Åß„ÅÇ„Çã„ÄÇ</p></li>
<li><p>„Ç´„Éº„Éç„É´Èñ¢Êï∞„ÅØ2„Å§„ÅÆÂºïÊï∞„ÇíÂèó„ÅëÂèñ„Å£„Å¶„Çπ„Ç´„É©„Éº„ÇíÂá∫Âäõ„Åô„Çã„ÄÇ„Ç´„Éº„Éç„É´Èñ¢Êï∞„ÅØ3„Å§„ÅÆÊÄßË≥™„ÇíÊåÅ„Åü„Å™„Åë„Çå„Å∞„Å™„Çâ„Å™„ÅÑÔºàÊ≠£ÂÆöÊÄß(positive)„ÉªÂØæÁß∞ÊÄß(symmetry)„ÉªPoint-separatingÔºâ„ÄÇÔºâ</p></li>
<li><p>Ë∑ùÈõ¢Èñ¢Êï∞ÔºàÂÜÖÁ©çÔºâ„ÅØ„Ç´„Éº„Éç„É´Èñ¢Êï∞„Åß„ÅÇ„Çã„ÄÇ</p></li>
<li><p>„Ç´„Éº„Éç„É´Èñ¢Êï∞„ÅØÂæÆÂàÜÂèØËÉΩ„Åß„ÅÇ„ÇãÂøÖË¶Å„ÅØ„Å™„ÅÑ„ÄÇ</p></li>
<li><p>„Ç´„Éº„Éç„É´Â≠¶Áøí„ÅØ‰∫åÂ§âÊï∞„Ç´„Éº„Éç„É´Èñ¢Êï∞„Å†„Åë„ÅßÂÆö„ÇÅ„Çâ„Çå„ÇãÁâπÂæ¥Èáè„Çí‰Ωø„ÅÑ„Åü„ÅÑ„Å®„Åç„Å´Áõ∏Âøú„Åó„ÅÑÊâãÊ≥ï„Åß„ÅÇ„Çã„ÄÇ</p></li>
<li><p>„Ç´„Éº„Éç„É´„É¢„Éá„É´„ÅÆË®ìÁ∑¥ÂèØËÉΩ„Éë„É©„É°„Éº„Çø„Éº„ÅÆÂÄãÊï∞„ÅØÁâπÂæ¥Èáè„ÅÆÊ¨°ÂÖÉÊï∞„Åß„ÅØ„Å™„ÅèË®ìÁ∑¥„Éá„Éº„ÇøÁÇπ„ÅÆÂÄãÊï∞„Å´ÊØî‰æã„Åô„Çã„ÄÇ</p></li>
</ul>
</section>
<section id="cited-references">
<h2><span class="section-number">5.10. </span>Cited References<a class="headerlink" href="#cited-references" title="Permalink to this headline">¬∂</a></h2>
<div class="docutils container" id="id12">
<dl class="citation">
<dt class="label" id="id28"><span class="brackets"><a class="fn-backref" href="#id4">SKE19</a></span></dt>
<dd><p>Murat¬†Cihan Sorkun, Abhishek Khetan, and S√ºleyman Er. AqSolDB, a curated reference set of aqueous solubility and 2D descriptors for a diverse set of compounds. <em>Sci. Data</em>, 6(1):143, 2019. <a class="reference external" href="https://doi.org/10.1038/s41597-019-0151-1">doi:10.1038/s41597-019-0151-1</a>.</p>
</dd>
<dt class="label" id="id27"><span class="brackets"><a class="fn-backref" href="#id2">SSAB20</a></span></dt>
<dd><p>Christoph Scherer, ReneÃÅ Scheid, Denis Andrienko, and Tristan Bereau. Kernel-based machine learning for efficient simulations of molecular liquids. <em>Journal of Chemical Theory and Computation</em>, 16(5):3194‚Äì3204, 2020.</p>
</dd>
<dt class="label" id="id26"><span class="brackets"><a class="fn-backref" href="#id2">RTMullerVL12</a></span></dt>
<dd><p>Matthias Rupp, Alexandre Tkatchenko, Klaus-Robert M√ºller, and O¬†Anatole Von¬†Lilienfeld. Fast and accurate modeling of molecular atomization energies with machine learning. <em>Physical review letters</em>, 108(5):058301, 2012.</p>
</dd>
</dl>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./ml"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="classification.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">4. </span>Classification</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../dl/introduction.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">6. </span>„Éá„Ç£„Éº„Éó„É©„Éº„Éã„É≥„Ç∞„ÅÆÊ¶ÇË¶Å</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Andrew D. White<br/>
    
        &copy; Copyright 2022.<br/>
      <div class="extra_footer">
        <a href="http://thewhitelab.org">thewhitelab.org</a> <div id="wh-modal"> <button class="wh-venti-button" aria-label="close modal" id="wh-modal-close">‚úï</button> <img id="wh-modal-img"> </div>
      </div>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>