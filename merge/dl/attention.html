
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<meta content="Deep Learning for Molecules &amp; Materials Book" lang="en" name="description" xml:lang="en" />
<meta content="en_US" property="og:locale" />
<meta content="summary" name="twitter:card" />
<meta content="Deep Learning for Molecules &amp; Materials Book" name="twitter:description" />
<meta content="dmol.pub üìñ" name="twitter:title" />
<meta content="https://dmol.pub/_static/logo.png" name="twitter:image" />
<meta content="&#64;andrewwhite01" name="twitter:site" />

    <title>13. „Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„É¨„Ç§„É§„Éº &#8212; deep learning for molecules &amp; materials</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/a11y.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/custom.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="canonical" href="https://resnant.github.io/dmol-book-japanese/dl/attention.html" />
    <link rel="shortcut icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="15. Deep Learning on Sequences" href="NLP.html" />
    <link rel="prev" title="12. ‰∫àÊ∏¨„ÇíË™¨Êòé„Åô„Çã" href="xai.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">deep learning for molecules & materials</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   „Åì„ÅÆÊú¨„ÅÆÊ¶ÇË¶Å
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  A. Math Review
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../math/tensors-and-shapes.html">
   1. Tensors and Shapes
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  B. Machine Learning
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../ml/introduction.html">
   2. Ê©üÊ¢∞Â≠¶ÁøíÂÖ•ÈñÄ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ml/regression.html">
   3. Regression &amp; Model Assessment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ml/classification.html">
   4. Classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ml/kernel.html">
   5. „Ç´„Éº„Éç„É´Â≠¶Áøí
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  C. Deep Learning
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="introduction.html">
   6. „Éá„Ç£„Éº„Éó„É©„Éº„Éã„É≥„Ç∞„ÅÆÊ¶ÇË¶Å
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="layers.html">
   7. Standard Layers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="gnn.html">
   8. Graph Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data.html">
   9. Input Data &amp; Equivariances
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Equivariant.html">
   10. Equivariant Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="molnets.html">
   11. Modern Molecular NNs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="xai.html">
   12. ‰∫àÊ∏¨„ÇíË™¨Êòé„Åô„Çã
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   13. „Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„É¨„Ç§„É§„Éº
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="NLP.html">
   15. Deep Learning on Sequences
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="VAE.html">
   16. Variational Autoencoder
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="flows.html">
   17. Normalizing Flows
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  D. Applications
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../applied/QM9.html">
   18. GNN„Å´„Çà„ÇãDFT„Ç®„Éç„É´„ÇÆ„Éº„ÅÆ‰∫àÊ∏¨
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../applied/MolGenerator.html">
   19. Generative RNN in Browser
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  E. Contributed Chapters
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Hyperparameter_tuning.html">
   20. Hyperparameter Tuning
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  F. Appendix
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../style.html">
   21. Style Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../changelog.html">
   22. Changelog
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  <script async defer src="https://api.dmol.pub/latest.js"></script><noscript><img src="https://api.dmol.pub/noscript.gif" alt="" referrerpolicy="no-referrer-when-downgrade" /></noscript> By <a href="https://twitter.com/andrewwhite01">Andrew White</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/dl/attention.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/resnant/dmol-book-japanese/"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/resnant/dmol-book-japanese//issues/new?title=Issue%20on%20page%20%2Fdl/attention.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/resnant/dmol-book-japanese/blob/master/dl/attention.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   13. „Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„É¨„Ç§„É§„Éº
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     13.1. ‰æã
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     13.2. „Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥Ê©üÊßãÊñπÁ®ãÂºè
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id8">
     13.3. „Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥ÈõÜÁ¥Ñ
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id9">
     13.4. „ÉÜ„É≥„ÇΩ„É´„Éâ„ÉÉ„Éà
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id11">
     13.5. „ÇΩ„Éï„Éà„ÄÅ„Éè„Éº„Éâ„ÄÅÊ∏©Â∫¶„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id12">
     13.6. „Çª„É´„Éï„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id13">
     13.7. Â≠¶ÁøíÂèØËÉΩ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id14">
     13.8. „Éû„É´„ÉÅ„Éò„ÉÉ„Éâ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„Éñ„É≠„ÉÉ„ÇØ
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id16">
     13.9. „Éé„Éº„Éà„Éñ„ÉÉ„ÇØ„ÇíÂÆüË°å„Åô„Çã
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id17">
     13.10. „Ç≥„Éº„Éâ„ÅÆ‰æã
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id18">
       13.10.1. „ÉÜ„É≥„ÇΩ„É´„Éâ„ÉÉ„ÉàÊ©üÊßã
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#attention">
       13.10.2. ‰∏ÄËà¨ÁöÑ„Å™Attention
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id19">
       13.10.3. „Çª„É´„Éï„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id20">
       13.10.4. Â≠¶ÁøíÂèØËÉΩ„Éë„É©„É°„Éº„Çø„ÇíËøΩÂä†„Åô„Çã
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id21">
       13.10.5. „Éû„É´„ÉÅ„Éò„ÉÉ„Éâ
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id22">
   14. „Ç∞„É©„Éï„Éã„É•„Éº„É©„É´„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„Å´„Åä„Åë„Çã„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id27">
     14.1. Á´†„ÅÆ„Åæ„Å®„ÇÅ
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id28">
     14.2. ÂºïÁî®ÊñáÁåÆ
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„É¨„Ç§„É§„Éº</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   13. „Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„É¨„Ç§„É§„Éº
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     13.1. ‰æã
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     13.2. „Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥Ê©üÊßãÊñπÁ®ãÂºè
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id8">
     13.3. „Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥ÈõÜÁ¥Ñ
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id9">
     13.4. „ÉÜ„É≥„ÇΩ„É´„Éâ„ÉÉ„Éà
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id11">
     13.5. „ÇΩ„Éï„Éà„ÄÅ„Éè„Éº„Éâ„ÄÅÊ∏©Â∫¶„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id12">
     13.6. „Çª„É´„Éï„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id13">
     13.7. Â≠¶ÁøíÂèØËÉΩ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id14">
     13.8. „Éû„É´„ÉÅ„Éò„ÉÉ„Éâ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„Éñ„É≠„ÉÉ„ÇØ
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id16">
     13.9. „Éé„Éº„Éà„Éñ„ÉÉ„ÇØ„ÇíÂÆüË°å„Åô„Çã
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id17">
     13.10. „Ç≥„Éº„Éâ„ÅÆ‰æã
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id18">
       13.10.1. „ÉÜ„É≥„ÇΩ„É´„Éâ„ÉÉ„ÉàÊ©üÊßã
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#attention">
       13.10.2. ‰∏ÄËà¨ÁöÑ„Å™Attention
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id19">
       13.10.3. „Çª„É´„Éï„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id20">
       13.10.4. Â≠¶ÁøíÂèØËÉΩ„Éë„É©„É°„Éº„Çø„ÇíËøΩÂä†„Åô„Çã
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id21">
       13.10.5. „Éû„É´„ÉÅ„Éò„ÉÉ„Éâ
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id22">
   14. „Ç∞„É©„Éï„Éã„É•„Éº„É©„É´„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„Å´„Åä„Åë„Çã„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id27">
     14.1. Á´†„ÅÆ„Åæ„Å®„ÇÅ
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id28">
     14.2. ÂºïÁî®ÊñáÁåÆ
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1><span class="section-number">13. </span>„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„É¨„Ç§„É§„Éº<a class="headerlink" href="#id1" title="Permalink to this headline">¬∂</a></h1>
<p>„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„ÅØÊ©üÊ¢∞Â≠¶Áøí„ÇÑAI„Å´„Åä„ÅÑ„Å¶„ÄÅÁâπ„Å´„Ç≥„É≥„Éî„É•„Éº„Çø„Éì„Ç∏„Éß„É≥„Åß‰ΩïÂπ¥„ÇÇÂâç„Åã„ÇâÂ≠òÂú®„Åô„ÇãÊ¶ÇÂøµ„Åß„Åô<span id="id2">[<a class="reference internal" href="#id76" title="Shumeet Baluja and Dean A. Pomerleau. Expectation-based selective attention for visual monitoring and control of a robot vehicle. Robotics and Autonomous Systems, 22(3):329‚Äì344, 1997. Robot Learning: The New Wave. URL: http://www.sciencedirect.com/science/article/pii/S0921889097000468, doi:https://doi.org/10.1016/S0921-8890(97)00046-8.">BP97</a>]</span>„ÄÇ„Äå„Éã„É•„Éº„É©„É´„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„Äç„Å®„ÅÑ„ÅÜË®ÄËëâ„Å®ÂêåÊßò„Å´„ÄÅ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„ÅØ‰∫∫Èñì„ÅÆËÑ≥„ÅåÂ§ßÈáè„ÅÆË¶ñË¶ö„ÉªËÅ¥Ë¶öÂÖ•Âäõ„ÇíÂá¶ÁêÜ„Åô„ÇãÈöõ„ÅÆÊ≥®ÊÑèÊ©üÊßã„Å´ÁùÄÊÉ≥„ÇíÂæó„Å¶„ÅÑ„Åæ„Åô<span id="id3">[<a class="reference internal" href="#id76" title="Shumeet Baluja and Dean A. Pomerleau. Expectation-based selective attention for visual monitoring and control of a robot vehicle. Robotics and Autonomous Systems, 22(3):329‚Äì344, 1997. Robot Learning: The New Wave. URL: http://www.sciencedirect.com/science/article/pii/S0921889097000468, doi:https://doi.org/10.1016/S0921-8890(97)00046-8.">BP97</a>]</span>„ÄÇ<strong>„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„É¨„Ç§„É§„Éº</strong>„ÅØ„ÄÅ„Åù„ÅÆÊ≥®ÊÑèÊ©üÊßã„ÇíÂÜçÁèæ„Åô„ÇãÊ∑±Â±§Â≠¶Áøí„É¨„Ç§„É§„Éº„Åß„Åô„ÄÇÊ∑±Â±§Â≠¶Áøí„Å´„Åä„Åë„Çã„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„Å´„Å§„ÅÑ„Å¶„ÅØLuong„Çâ<span id="id4">[<a class="reference internal" href="#id73" title="Minh-Thang Luong, Hieu Pham, and Christopher D Manning. Effective approaches to attention-based neural machine translation. arXiv preprint arXiv:1508.04025, 2015.">LPM15</a>]</span>„ÅåË©≥Á¥∞„ÇíËß£Ë™¨„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ„Åæ„Åü„ÄÅ<a class="reference external" href="http://d2l.ai/chapter_attention-mechanisms/index.html">„Åì„Å°„Çâ</a>„ÅßÂÆüË∑µÁöÑ„Å™Ê¶ÇË¶Å„ÅåÁ¥π‰ªã„Åï„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„É¨„Ç§„É§„Éº„ÅØË®ÄË™û„ÅÆ„Çà„ÅÜ„Å™Á≥ªÂàó„ÅÆ„É¢„Éá„É™„É≥„Ç∞„Å´ÈùûÂ∏∏„Å´ÊúâÁî®„Åß„ÅÇ„Çã„Åì„Å®„ÅåÁµåÈ®ìÁöÑ„Å´Á§∫„Åï„Çå„Å¶„Åä„Çä„ÄÅÁèæÂú®„Åß„ÅØÂøÖË¶Å‰∏çÂèØÊ¨†„Å™Â≠òÂú®„Å®„Å™„Å£„Å¶„ÅÑ„Åæ„Åô<span id="id5">[<a class="reference internal" href="#id72" title="Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, ≈Åukasz Kaiser, and Illia Polosukhin. Attention is all you need. In Advances in neural information processing systems, 5998‚Äì6008. 2017.">VSP+17</a>]</span>„ÄÇ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„É¨„Ç§„É§„Éº„ÅåÊúÄ„ÇÇËâØ„Åè‰Ωø„Çè„Å¶„ÅÑ„Çã„ÅÆ„ÅØÁ≥ªÂàó„É¢„Éá„É™„É≥„Ç∞„Å´Áî®„ÅÑ„Çã<a class="reference external" href="http://d2l.ai/chapter_attention-mechanisms/transformer.html"><strong>„Éà„É©„É≥„Çπ„Éï„Ç©„Éº„Éû„Éº</strong></a>„Éã„É•„Éº„É©„É´„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„Åß„Åô„ÄÇ„Åæ„Åü„ÄÇ„Ç∞„É©„Éï„Éã„É•„Éº„É©„É´„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„Åß„ÇÇ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„Åå‰Ωø„Çè„Çå„Çã„Åì„Å®„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„Å´„ÅØÔºì„Å§„ÅÆÂÖ•Âäõ„Åå„ÅÇ„Çã„Åü„ÇÅÊ∑∑‰π±„Åó„Åå„Å°„Åß„Åô„Åå„ÄÅ„Åì„Çå„Çâ„ÅÆÂÖ•Âäõ„ÅØÂÆüÈöõ„ÅØÂêå‰∏Ä„Åß„ÅÇ„Çã„Åì„Å®„ÅåÂ§ö„ÅÑ„Åì„Å®„ÇíÂæå„ÅßË™¨Êòé„Åó„Åæ„Åô„ÄÇ
„ÇØ„Ç®„É™„Éº„ÅØ„Ç≠„Éº„ÅÆ„Å≤„Å®„Å§„Åß„ÅÇ„Çä„ÄÅ„Ç≠„Éº„Å®„Éê„É™„É•„Éº„ÅØÂêå‰∏Ä„Åß„Åô„ÄÇ„Åù„Åó„Å¶„ÄÅ„ÇØ„Ç®„É™„Çí„Åæ„Å®„ÇÅ„Å¶ÂÖ•Âäõ„Åô„Çã„Å®„ÄÅ„ÇØ„Ç®„É™„Éº„ÄÅ„Ç≠„Éº„ÄÅ„Éê„É™„É•„Éº„ÅåÂêå‰∏Ä„Åß„ÅÇ„Çã„Åì„Å®„Å´Ê∞ó„Åå‰ªò„Åè„Åß„Åó„Çá„ÅÜ„ÄÇ„Åì„Çå„ÅåSelf-Attention„Åß„Åô„ÄÇ</p>
</aside>
<div class="admonition-audience-objectives admonition">
<p class="admonition-title">Audience &amp; Objectives</p>
<p>„Åì„ÅÆÁ´†„ÅØ„ÄÅ<a class="reference internal" href="layers.html"><span class="doc">Standard Layers</span></a> „Å® <a class="reference internal" href="../math/tensors-and-shapes.html"><span class="doc">Tensors and Shapes</span></a>„ÇíÁêÜËß£„Åó„Å¶„ÅÑ„Çã„Åì„Å®„ÇíÂâçÊèê„Å´Êõ∏„Åã„Çå„Å¶„ÅÑ„Çã„ÅÆ„Åß„ÄÅ„Éñ„É≠„Éº„Éâ„Ç≠„É£„Çπ„Éà„ÄÅË°åÂàó„ÇÑ„ÉÜ„É≥„ÇΩ„É´„ÅÆÂΩ¢Áä∂„Å´„ÅØÊÖ£„Çå„Å¶„ÅÑ„ÅüÊñπ„ÅåËâØ„ÅÑ„Åß„Åó„Çá„ÅÜ„ÄÇ„Åì„ÅÆÁ´†„ÇíÁµÇ„Åà„Çã„Åì„Çç„Å´„ÅØ„ÄÅ‰ª•‰∏ã„ÅÆ‰∫ã„Åå„Åß„Åç„Çã„Çà„ÅÜ„Å´„Å™„Å£„Å¶„ÅÑ„Çã„ÅØ„Åö„Åß„Åô„ÄÇ</p>
<ul class="simple">
<li><p>„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„É¨„Ç§„É§„Éº„ÅÆÂΩ¢Áä∂„ÇÑÂÖ•Âá∫Âäõ„ÅÆÊ≠£„Åó„ÅÑÊåáÂÆö</p></li>
<li><p>„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„É¨„Ç§„É§„Éº„ÅÆÂÆüË£Ö</p></li>
<li><p>‰ªñ„ÅÆ„É¨„Ç§„É§„Éº„Å´„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„ÇíÈÅ©Áî®„Åô„ÇãÊñπÊ≥ï</p></li>
</ul>
</div>
<p>„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„É¨„Ç§„É§„Éº„ÅØ„ÄÅÂü∫Êú¨ÁöÑ„Å´„ÅØÂä†ÈáçÂπ≥Âùá„Å´„Çà„ÇãÈõÜÁ¥Ñ„Åß„Åô„ÄÇ„Åì„Çå„ÅØÂçò„Å´ÂêÑË¶ÅÁ¥†„Å´‰Ωï„Çâ„Åã„ÅÆÊñπÊ≥ï„ÅßÈáç„Åø‰ªò„Åë„Çí„Åó„ÄÅ„Åù„ÅÆÂπ≥Âùá„ÇíË®àÁÆó„Åó„Å¶„ÅÑ„Çã„Å†„Åë„Åß„Åô„ÄÇ„Åì„Çå„Å´„Çà„Çä„ÄÅ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„ÅØÂÖ•Âäõ„ÉÜ„É≥„ÇΩ„É´„ÅÆ„É©„É≥„ÇØ„ÇíÂ∞è„Åï„Åè„Åó„Åæ„Åô„ÄÇ„Åª„Å®„Çì„Å©„ÅÆ„É¨„Ç§„É§„Éº„Åå1„Å§„ÇÇ„Åó„Åè„ÅØ2„Å§„ÅÆÂÖ•Âäõ„ÇíÂèñ„Çã„ÅÆ„Å´ÂØæ„Åó„ÄÅ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„ÅØ3„Å§„ÅÆÂÖ•Âäõ„ÇíÂèñ„Çã„Å®„ÅÑ„ÅÜÁÇπ„ÅßÁèç„Åó„ÅÑ„É¨„Ç§„É§„Éº„Åß„Åô„ÄÇ„Åì„Çå„Çâ3„Å§„ÅÆÂÖ•Âäõ„ÅØ„Åù„Çå„Åû„Çå„ÄÅ<strong>„ÇØ„Ç®„É™„Éº</strong>„ÄÅ<strong>„Éê„É™„É•„Éº</strong>„ÄÅ<strong>„Ç≠„Éº</strong>„Å®Âëº„Å∞„Çå„Åæ„Åô„ÄÇÈõÜÁ¥Ñ„ÅØ„Éê„É™„É•„Éº„Å´ÂØæ„Åó„Å¶Ë°å„Çè„Çå„ÄÅ„Éê„É™„É•„Éº„ÅÆ„É©„É≥„ÇØ„Åå3„Åß„ÅÇ„Çå„Å∞Âá∫Âäõ„ÅÆ„É©„É≥„ÇØ„ÅØ2„Å´„Å™„Çä„Åæ„Åô„ÄÇ„ÇØ„Ç®„É™„Éº„ÅØ„Ç≠„Éº„Çà„Çä1Â∞è„Åï„ÅÑ„É©„É≥„ÇØ„ÄÅ„Ç≠„Éº„Å®„Éê„É™„É•„Éº„ÅØÂêå„Åò„É©„É≥„ÇØ„Åß„Åô„ÄÇ„Ç≠„Éº„Å®„ÇØ„Ç®„É™„Éº„ÅØ<strong>„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥Ê©üÊßã</strong> ‚ÄìÊñπÁ®ãÂºè„ÇíÊÑèÂë≥„Åô„Çã‚Äì„Å´Âæì„Å£„Å¶„Éê„É™„É•„Éº„ÅÆÈáç„Åø„ÇíÊ±∫ÂÆö„Åó„Åæ„Åô„ÄÇ</p>
<p>‰∏ã„ÅÆË°®„ÅØ„Åì„Çå„Çâ3„Å§„ÅÆÂÖ•Âäõ„Çí„Åæ„Å®„ÇÅ„Åü„ÇÇ„ÅÆ„Åß„Åô„ÄÇÂ§ö„Åè„ÅÆÂ†¥Âêà„ÄÅ„ÇØ„Ç®„É™„Éº„ÅØ„Éê„ÉÉ„ÉÅÂá¶ÁêÜ„Åï„Çå„Çã„Åü„ÇÅ„ÄÅ„É©„É≥„ÇØ„Åå2„Å´„Å™„Çã„Åì„Å®„Å´Ê≥®ÊÑè„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇÂÖ•Âäõ„ÇØ„Ç®„É™„Åå„Éê„ÉÉ„ÉÅÂá¶ÁêÜ„Åï„Çå„Å¶„ÅÑ„ÇãÂ†¥Âêà„ÄÅÂá∫Âäõ„É©„É≥„ÇØ„ÇÇ1„Åß„ÅØ„Å™„ÅèÂêåÊßò„Å´2„Å´„Å™„Çä„Åæ„Åô„ÄÇ</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p></p></th>
<th class="head"><p>„É©„É≥„ÇØ</p></th>
<th class="head"><p>ÂΩ¢Áä∂</p></th>
<th class="head"><p>ÁõÆÁöÑ</p></th>
<th class="text-align:right head"><p>‰æã</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p>„ÇØ„Ç®„É™„Éº</p></td>
<td><p>1</p></td>
<td><p>(„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥ÁâπÂæ¥Èáè„ÅÆÊï∞)</p></td>
<td><p>„Ç≠„Éº„Å´ÂØæ„Åó„Å¶„ÉÅ„Çß„ÉÉ„ÇØ„ÇíË°å„ÅÜÂÖ•Âäõ</p></td>
<td class="text-align:right"><p>ÁâπÂæ¥Èáè„Éô„ÇØ„Éà„É´„Å®„Åó„Å¶Ë°®Áèæ„Åï„Çå„Åü1ÂçòË™û</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>„Ç≠„Éº</p></td>
<td><p>2</p></td>
<td><p>(Á≥ªÂàó„ÅÆÈï∑„Åï, „Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥ÁâπÂæ¥Èáè„ÅÆÊï∞)</p></td>
<td><p>„ÇØ„Ç®„É™„Éº„Å´ÂØæ„Åó„Å¶„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„ÇíË®àÁÆó„Åô„Çã„Åü„ÇÅ„Å´‰ΩøÁî®„Åô„Çã</p></td>
<td class="text-align:right"><p>ÁâπÂæ¥Èáè„Éô„ÇØ„Éà„É´„Å®„Åó„Å¶Ë°®Áèæ„Åï„Çå„ÅüÊñá‰∏≠„ÅÆÂÖ®ÂçòË™û</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>„Éê„É™„É•„Éº</p></td>
<td><p>2</p></td>
<td><p>(Á≥ªÂàó„ÅÆÈï∑„Åï, „Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥ÁâπÂæ¥Èáè„ÅÆÊï∞)</p></td>
<td><p>Âá∫ÂäõÂÄ§„ÇíË®àÁÆó„Åô„Çã„Åü„ÇÅ„Å´‰ΩøÁî®„Åï„Çå„Çã</p></td>
<td class="text-align:right"><p>Êñá‰∏≠„ÅÆÂêÑÂçòË™û„Å´ÂØæÂøú„Åô„ÇãÊï∞ÂÄ§„Éô„ÇØ„Éà„É´</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Âá∫Âäõ</p></td>
<td><p>1</p></td>
<td><p>(„Éê„É™„É•„ÉºÁâπÂæ¥Èáè„ÅÆÊï∞)</p></td>
<td><p>„Éê„É™„É•„Éº„ÅÆ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„Ç¶„Çß„Ç§„Éà„Å´„Çà„ÇãÂä†ÈáçÂπ≥Âùá</p></td>
<td class="text-align:right"><p>Ôºë„Å§„ÅÆ„Éô„ÇØ„Éà„É´</p></td>
</tr>
</tbody>
</table>
<section id="id6">
<h2><span class="section-number">13.1. </span>‰æã<a class="headerlink" href="#id6" title="Permalink to this headline">¬∂</a></h2>
<p>„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„ÅØÁ≥ªÂàó„Éá„Éº„Çø„ÅßËÄÉ„Åà„Çã„Å®ÂàÜ„Åã„Çä„ÇÑ„Åô„ÅÑÊ¶ÇÂøµ„Åß„Åô„ÄÇ„ÄåThe sleepy child reads a book„Äç„Å®„ÅÑ„ÅÜÊñáÁ´†„ÅßËÄÉ„Åà„Å¶„Åø„Åæ„Åó„Çá„ÅÜ„ÄÇÊñá‰∏≠„ÅÆÂêÑÂçòË™û„ÅØ„Ç≠„Éº„Å´Áõ∏ÂΩì„Åó„ÄÅÂçòË™û„ÇíÂüã„ÇÅËæº„Åø„ÅßË°®Áèæ„Åô„Çã„Å®„Ç≠„Éº„ÅØ„É©„É≥„ÇØ2„Å®„Å™„Çä„Åæ„Åô„ÄÇ‰æã„Åà„Å∞„ÄÅ„Äåsleepy„Äç„Å®„ÅÑ„ÅÜÂçòË™û„ÅØ„ÄÅÈï∑„Åï3„ÅÆÂüã„ÇÅËæº„Åø„Éô„ÇØ„Éà„É´Ôºö <span class="math notranslate nohighlight">\([2, 0, 1]\)</span> „ÅßË°®Áèæ„Åï„Çå„Çã„Åã„ÇÇ„Åó„Çå„Åæ„Åõ„Çì„ÄÇ„Åì„Çå„Çâ„ÅÆÂüã„ÇÅËæº„Åø„ÅØÊ®ôÊ∫ñÁöÑ„Å™Ë®ÄË™û„ÅÆÂüã„ÇÅËæº„Åø„Åã„ÇâÂ≠¶Áøí„Åæ„Åü„ÅØÂèñÂæó„Åï„Çå„Åü„ÇÇ„ÅÆ„Åß„Åô„ÄÇÊÖ£ÁøíÁöÑ„Å´„ÄÅ„Ç≠„Éº„ÅÆËª∏0„ÅØÁ≥ªÂàó„Å´„Åä„Åë„Çã‰ΩçÁΩÆ„ÇíË°®„Åó„ÄÅËª∏1„Åå„Éô„ÇØ„Éà„É´„ÇíË°®„Åó„Åæ„Åô„ÄÇ„ÇØ„Ç®„É™„Éº„ÅØÂ§ö„Åè„ÅÆÂ†¥Âêà„ÄÅ„Äåbook„Äç„Å®„ÅÑ„ÅÜÂçòË™û„ÅÆ„Çà„ÅÜ„Å´„Ç≠„Éº„Å´Âê´„Åæ„Çå„Å¶„ÅÑ„Çã‰∏ÄË¶ÅÁ¥†„Å´„Å™„Çä„Åæ„Åô„ÄÇ„ÇØ„Ç®„É™„Éº„ÅåÊñá‰∏≠„ÅÆ„Å©„ÅÆÈÉ®ÂàÜ„Åã„ÇâÂΩ±Èüø„ÇíÂèó„Åë„Å¶„ÅÑ„Çã„Åã„ÇíË¶ã„Å¶„ÅÑ„Çã„ÅÆ„Åå„ÄÅ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„ÅÆÈáçË¶Å„Å™„Éù„Ç§„É≥„Éà„Åß„Åô„ÄÇ„ÄåBook„Äç„ÅØ„Äåchild„Äç„Å®„Äåreads„Äç„Å´Âº∑„ÅÑ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„ÇíÊåÅ„Å§„ÅØ„Åö„Åß„Åô„Åå„ÄÅ„Äåsleepy„Äç„Åß„ÅØ„Åù„ÅÜ„ÅØ„Å™„Çâ„Å™„ÅÑ„ÅØ„Åö„Åß„Åô„ÄÇ„Åì„Çå„ÇíÂÆüÈöõ„Å´„Éô„ÇØ„Éà„É´„Å®„Åó„Å¶Ë®àÁÆó„Åó„Åü„ÇÇ„ÅÆ„Çí„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„Éô„ÇØ„Éà„É´ <span class="math notranslate nohighlight">\(\vec{b}\)</span> „Å®Âëº„Å∂„Åì„Å®„ÅØ„Åô„Åê„Å´„Çè„Åã„Çã„Åß„Åó„Çá„ÅÜ„ÄÇ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„É¨„Ç§„É§„Éº„ÅÆÂá∫Âäõ„ÅØ„ÄÅ„ÇØ„Ç®„É™„Éº„Å®„Ç≠„Éº„ÅÆ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„Åã„ÇâÁÆóÂá∫„Åï„Çå„ÇãÈáç„Åø„Åß„Éê„É™„É•„Éº„ÇíÈõÜÁ¥Ñ„Åó„Åü„ÇÇ„ÅÆ„Åß„Åô„ÄÇ„Åó„Åü„Åå„Å£„Å¶„ÄÅÊñá‰∏≠„ÅÆÂêÑË¶ÅÁ¥†„Å´ÂØæ„Åó„Å¶„Å≤„Å®„Å§„ÅÆ„Ç≠„Éº„ÄÅ„Éê„É™„É•„Éº„ÅåÂØæÂøú„Åó„Å¶„ÅÑ„Çã„ÅØ„Åö„Åß„Åô„ÄÇ‰∏ÄËà¨ÁöÑ„Å´„ÄÅ„Éê„É™„É•„Éº„ÅØ„Ç≠„Éº„Å®Âêå‰∏Ä„Å´„Å™„Çã„Åì„Å®„ÇÇ„ÅÇ„Çä„Åæ„Åô„ÄÇ</p>
<p>Êï∞Â≠¶ÁöÑ„Å´„Å©„ÅÜ„ÅÑ„ÅÜ„Åì„Å®„ÅãË¶ã„Å¶„Åø„Åæ„Åó„Çá„ÅÜ„ÄÇ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„É¨„Ç§„É§„Éº„ÅØÔºàÔºëÔºâ<strong>„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥Ê©üÊßã</strong>„Å´„Çà„Çã„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„Éô„ÇØ„Éà„É´ <span class="math notranslate nohighlight">\(\vec{b}\)</span> „ÅÆË®àÁÆó„Å®„ÄÅÔºàÔºíÔºâ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„Éô„ÇØ„Éà„É´ <span class="math notranslate nohighlight">\(\vec{b}\)</span> „ÇíÁî®„ÅÑ„Åü„Éê„É™„É•„Éº„ÅÆÈõÜÁ¥Ñ„ÅÆ2„Å§„ÅÆ„Çπ„ÉÜ„ÉÉ„Éó„Åã„Çâ„Å™„Çä„Åæ„Åô„ÄÇ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥Ê©üÊßã„ÅØ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥ÊñπÁ®ãÂºè„ÅÆÂà•Âêç„Åß„Åô„ÄÇ‰∏ä„ÅÆ‰æã„Å´„Å§„ÅÑ„Å¶ËÄÉ„Åà„Å¶„Åø„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ„Åì„Åì„Åß„ÅØ3Ê¨°ÂÖÉ„ÅÆÂüã„ÇÅËæº„Åø„Çí‰Ωø„Å£„Å¶ÂçòË™û„ÇíË°®Áèæ„Åó„Å¶„Åø„Åæ„Åô„ÄÇ</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>„Ç≠„Éº„Å®„ÇØ„Ç®„É™„Éº„Ååone-hot„Ç®„É≥„Ç≥„Éº„Éá„Ç£„É≥„Ç∞„Åß‰∏é„Åà„Çâ„Çå„Çã„Å®„ÄÅ„Ç≠„Éº„Å®„ÇØ„Ç®„É™„Éº„Åå‰∏ÄËá¥„Åó„Å¶„ÅÑ„Å™„ÅÑÈôê„ÇäÂÜÖÁ©ç„Åå„Çº„É≠„Å´„Å™„Çã„ÅÆ„Åß„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„É¨„Ç§„É§„Éº„ÅÆÂÖ•Âäõ„Å®„Åó„Å¶„ÅØÊ©üËÉΩ„Åó„Å™„ÅÑ„ÄÇ</p>
</aside>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>„Ç§„É≥„Éá„ÉÉ„ÇØ„Çπ</p></th>
<th class="text-align:center head"><p>Âüã„ÇÅËæº„Åø</p></th>
<th class="text-align:right head"><p>ÂçòË™û</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p>0</p></td>
<td class="text-align:center"><p>0,0,0</p></td>
<td class="text-align:right"><p>The</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>1</p></td>
<td class="text-align:center"><p>2,0,1</p></td>
<td class="text-align:right"><p>Sleepy</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>2</p></td>
<td class="text-align:center"><p>1,-1,-2</p></td>
<td class="text-align:right"><p>Child</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>3</p></td>
<td class="text-align:center"><p>2,3,1</p></td>
<td class="text-align:right"><p>Reads</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>4</p></td>
<td class="text-align:center"><p>-2,0,0</p></td>
<td class="text-align:right"><p>A</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>5</p></td>
<td class="text-align:center"><p>0,2,1</p></td>
<td class="text-align:right"><p>Book</p></td>
</tr>
</tbody>
</table>
<p>„Ç≠„Éº„ÅØ„Åì„Çå„ÇâÂÖ®„Å¶„Çí„Åæ„Å®„ÇÅ„Åü„É©„É≥„ÇØ2„ÅÆ„ÉÜ„É≥„ÇΩ„É´ÔºàË°åÂàóÔºâ„Å´„Å™„Çä„Åæ„Åô„ÄÇ„Åì„Åì„Åß„ÅØ„ÄÅÂàÜ„Åã„Çä„ÇÑ„Åô„Åï„ÅÆ„Åü„ÇÅ„Å´Êï¥Êï∞„ÅÆ„Åø„ÅßË™¨Êòé„Åó„Å¶„ÅÑ„Çã„Åì„Å®„Å´Ê≥®ÊÑè„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇÈÄöÂ∏∏„ÅØÂçòË™û„ÅÆÂüã„ÇÅËæº„ÅøË°®Áèæ„Å´„ÅØÊµÆÂãïÂ∞èÊï∞ÁÇπ„ÅåÁî®„ÅÑ„Çâ„Çå„Åæ„Åô„ÄÇ</p>
<div class="amsmath math notranslate nohighlight" id="equation-49e33d62-346d-46ce-8a06-a2fb01640486">
<span class="eqno">(13.1)<a class="headerlink" href="#equation-49e33d62-346d-46ce-8a06-a2fb01640486" title="Permalink to this equation">¬∂</a></span>\[\begin{equation}
\mathbf{K} = \left[
\begin{array}{lccccr}
0 &amp; 2 &amp; 1 &amp; 2 &amp; -2 &amp; 0\\
0 &amp; 0 &amp; -1 &amp; 3 &amp; 0 &amp; 2\\
0 &amp; 1 &amp; -2 &amp; 1 &amp; 0 &amp; 1\\
\end{array}\right]
\end{equation}\]</div>
<p>„Åì„ÅÆÊñá„Å´„ÅØ6„Å§„ÅÆÂçòË™û„Åå„ÅÇ„Çä„ÄÅ„Åù„Çå„Åû„Çå3Ê¨°ÂÖÉ„Éô„ÇØ„Éà„É´„ÅßË°®Áèæ„Åï„Çå„Çã„ÅÆ„Åß„ÄÅ„Ç≠„Éº„ÅØ <span class="math notranslate nohighlight">\((6, 3)\)</span> „ÅÆÂΩ¢Áä∂„Çí„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ„Éê„É™„É•„Éº„ÅØÂçòÁ¥î„Å´„ÄÅÂêÑÂçòË™û„Å´1„Å§„ÅÆÂÄ§„ÇíÊåÅ„Å§„Å®„Åó„Åô„ÄÇ„Åì„Çå„Çâ„ÅÆ„Éê„É™„É•„Éº„Å´„Çà„Å£„Å¶Âá∫Âäõ„ÇíÊ±∫ÂÆö„Åó„Åæ„Åô„ÄÇ„ÇÇ„Åó„Åã„Åó„Åü„Çâ„ÄÅÂçòË™û„ÅÆÊÑüÊÉÖ„ÇíË°®Áèæ„Åó„Å¶„ÅÑ„Çã„Åã„ÇÇ„Åó„Çå„Åæ„Åõ„ÇìÔºö„Äåhappy„Äç„ÅÆ„Çà„ÅÜ„Å™„Éù„Ç∏„ÉÜ„Ç£„Éñ„Å™ÂçòË™û„Å™„ÅÆ„Åã„ÄÅ„Äåangry„Äç„ÅÆ„Çà„ÅÜ„Å™„Éç„Ç¨„ÉÜ„Ç£„Éñ„Å™ÂçòË™û„Å™„ÅÆ„Åã„Å™„Å©„ÄÇ</p>
<div class="amsmath math notranslate nohighlight" id="equation-c7877f2c-3958-4fff-9868-ed8bc0375cf5">
<span class="eqno">(13.2)<a class="headerlink" href="#equation-c7877f2c-3958-4fff-9868-ed8bc0375cf5" title="Permalink to this equation">¬∂</a></span>\[\begin{equation}
\mathbf{V} = \left[ 0, -0.2, 0.3, 0.4, 0, 0.1\right]
\end{equation}\]</div>
<p>„Éê„É™„É•„Éº <span class="math notranslate nohighlight">\(\mathbf{V}\)</span> „ÅØ„Ç≠„Éº„Å®Âêå„Åò„É©„É≥„ÇØ„Åß„ÅÇ„Çã„Åπ„Åç„Åß„ÄÅ„Åù„ÅÆÂΩ¢Áä∂„ÅØ <span class="math notranslate nohighlight">\((6, 1)\)</span>„Å´„Å™„Çä„Åæ„Åô„ÄÇ„Åæ„Åü„ÄÅ„ÇØ„Ç®„É™„Éº„ÅØ„Ç≠„Éº„Çà„Çä„É©„É≥„ÇØ„Åå1Â∞è„Åï„Åè„Å™„Çä„Åæ„Åô„ÄÇ„Åì„ÅÆ‰æã„Åß„ÅÆ„ÇØ„Ç®„É™„Éº„ÅØ„Äåbook„Äç„Å®„ÅÑ„ÅÜÂçòË™û„Åß„Åô„ÄÇ</p>
<div class="amsmath math notranslate nohighlight" id="equation-6c1228c7-29f8-4b93-8076-fc3f81b9f999">
<span class="eqno">(13.3)<a class="headerlink" href="#equation-6c1228c7-29f8-4b93-8076-fc3f81b9f999" title="Permalink to this equation">¬∂</a></span>\[\begin{equation}
\vec{q} = \left[0, 2, 1\right]
\end{equation}\]</div>
</section>
<section id="id7">
<h2><span class="section-number">13.2. </span>„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥Ê©üÊßãÊñπÁ®ãÂºè<a class="headerlink" href="#id7" title="Permalink to this headline">¬∂</a></h2>
<p>„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥Ê©üÊßãÊñπÁ®ãÂºè„ÅØ„ÇØ„Ç®„É™„Éº„Å®„Ç≠„Éº„ÅÆÂºïÊï∞„ÅÆ„Åø„Çí‰ΩøÁî®„Åó„Åæ„Åô„ÄÇ
„Åì„ÅÆÂºè„ÅØ„Ç≠„Éº„Çà„Çä1„É©„É≥„ÇØ‰Ωé„ÅÑ„ÉÜ„É≥„ÇΩ„É´„ÇíÂá∫Âäõ„Åó„ÄÅÂêÑ„Ç≠„Éº„Å´Â§ß„Åó„Å¶„ÇØ„Ç®„É™„Éº„ÅåÊåÅ„Å§„Åπ„Åç„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„Å´ÂØæÂøú„Åô„Çã„Çπ„Ç´„É©„Éº„Çí‰∏é„Åà„Åæ„Åô„ÄÇ
„Åì„ÅÆ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„Éô„ÇØ„Éà„É´„ÅØÊ≠£Ë¶èÂåñ„Åï„Çå„Å¶„ÅÑ„ÇãÂøÖË¶Å„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇÊúÄ„ÇÇ‰∏ÄËà¨ÁöÑ„Å™„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥Ê©üÊßã„ÅØÂÜÖÁ©ç„Å®„ÇΩ„Éï„Éà„Éû„ÉÉ„ÇØ„Çπ„Åß„Åô„ÄÇ</p>
<div class="amsmath math notranslate nohighlight" id="equation-f693b2ac-098c-4b14-a4c8-915cee574f35">
<span class="eqno">(13.4)<a class="headerlink" href="#equation-f693b2ac-098c-4b14-a4c8-915cee574f35" title="Permalink to this equation">¬∂</a></span>\[\begin{equation}
\vec{b} = \mathrm{softmax}\left(\vec{q}\cdot \mathbf{K}\right) = \mathrm{softmax}\left(\sum_j q_j k_{ij}\right)
\end{equation}\]</div>
<p>„Åì„Åì„Åß„ÄÅ„Ç§„É≥„Éá„ÉÉ„ÇØ„Çπ <span class="math notranslate nohighlight">\(i\)</span> „ÅØÁ≥ªÂàó„Å´„Åä„Åë„Çã‰ΩçÁΩÆ„ÄÅ<span class="math notranslate nohighlight">\(j\)</span> „ÅØÁâπÂæ¥Èáè„ÅÆ„Ç§„É≥„Éá„ÉÉ„ÇØ„Çπ„Åß„Åô„ÄÇ„ÇΩ„Éï„Éà„Éû„ÉÉ„ÇØ„Çπ„ÅØ‰ª•‰∏ã„ÅßÂÆöÁæ©„Åï„Çå„ÄÅ</p>
<div class="math notranslate nohighlight" id="equation-softmax">
<span class="eqno">(13.5)<a class="headerlink" href="#equation-softmax" title="Permalink to this equation">¬∂</a></span>\[\mathrm{softmax}\left(\vec{x}\right) = \frac{e^\vec{x}}{\sum_i e^ x_i}\]</div>
<p><span class="math notranslate nohighlight">\(\vec{b}\)</span> „ÅåÊ≠£Ë¶èÂåñ„Åï„Çå„Çã„Åì„Å®„Çí‰øùË®º„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ‰∏ä„ÅÆ‰æã„Åã„ÇâÂæó„ÅüÂÄ§„Çí‰ª£ÂÖ•„Åô„Çã„Å®„ÄÅÊ¨°„ÅÆ„Çà„ÅÜ„Å´„Å™„Çä„Åæ„Åô„ÄÇ</p>
<div class="amsmath math notranslate nohighlight" id="equation-8d5ef854-59be-44fc-bf19-27c5dd3c86ec">
<span class="eqno">(13.6)<a class="headerlink" href="#equation-8d5ef854-59be-44fc-bf19-27c5dd3c86ec" title="Permalink to this equation">¬∂</a></span>\[\begin{equation}
\vec{b} = \mathrm{softmax}\left(\left[0, 2, 1\right] \times
\left[
\begin{array}{lccccr}
0 &amp; 2 &amp; 1 &amp; 2 &amp; -2 &amp; 0\\
0 &amp; 0 &amp; -1 &amp; 3 &amp; 0 &amp; 2\\
0 &amp; 1 &amp; -2 &amp; 1 &amp; 0 &amp; 1\\
\end{array}\right]\right) = \mathrm{softmax}\left( \left[0, 1, -4, 7, 0, 5\right]\right)
\end{equation}\]</div>
<div class="amsmath math notranslate nohighlight" id="equation-2a6be45a-99a7-4649-9299-1d93cf7642eb">
<span class="eqno">(13.7)<a class="headerlink" href="#equation-2a6be45a-99a7-4649-9299-1d93cf7642eb" title="Permalink to this equation">¬∂</a></span>\[\begin{equation}
\vec{b}  = \left[0, 0, 0, 0.88, 0, 0.12\right]
\end{equation}\]</div>
<p>„Åì„Åì„Åß„ÅØÊï∞Â≠ó„Çí‰∏∏„ÇÅ„Åæ„Åó„Åü„Åå„ÄÅ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„Éô„ÇØ„Éà„É´„ÅØÂçòË™ûËá™Ë∫´ÔºàbookÔºâ„Å®ÂãïË©ûÔºàreadÔºâ„Å´„ÅÆ„ÅøÈáç„Åø„ÇíÊåÅ„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇ„Åì„Çå„ÅØÁßÅ„Åå‰Ωú„Å£„Åü‰æã„Åß„Åô„Åå„ÄÅ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„ÅåÂçòË™ûÂêåÂ£´„Çí„Å©„ÅÆ„Çà„ÅÜ„Å´Èñ¢ÈÄ£‰ªò„Åë„Çã„ÅãÁ§∫ÂîÜ„Çí‰∏é„Åà„Å¶„Åè„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ„Ç∞„É©„Éï„Éã„É•„Éº„É©„É´„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„Å´„Åä„Åë„ÇãËøëÂÇç„ÅÆÊ¶ÇÂøµ„ÇíÊÄù„ÅÑËµ∑„Åì„Åô„Åã„ÇÇ„Åó„Çå„Åæ„Åõ„Çì„ÄÇ</p>
</section>
<section id="id8">
<h2><span class="section-number">13.3. </span>„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥ÈõÜÁ¥Ñ<a class="headerlink" href="#id8" title="Permalink to this headline">¬∂</a></h2>
<p>„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„Éô„ÇØ„Éà„É´ <span class="math notranslate nohighlight">\(\vec{b}\)</span> „ÅØ„ÄÅ„Éê„É™„É•„Éº„ÅÆÂä†ÈáçÂπ≥Âùá„ÅÆË®àÁÆó„Å´‰ΩøÁî®„Åï„Çå„Åæ„Åô„ÄÇ</p>
<div class="amsmath math notranslate nohighlight" id="equation-72cd37cd-b972-49ec-b096-cb774a5547a3">
<span class="eqno">(13.8)<a class="headerlink" href="#equation-72cd37cd-b972-49ec-b096-cb774a5547a3" title="Permalink to this equation">¬∂</a></span>\[\begin{equation}
 \mathbf{V}\vec{b} = \left[0, 0, 0, 0.88, 0, 0.12\right]^ T \left[ 0, -0.2, 0.3, 0.4, 0, 0.1\right] = 0.36
\end{equation}\]</div>
<p>Ê¶ÇÂøµÁöÑ„Å´„ÅØ„ÄÅ‰ªäÂõû„ÅÆ‰æã„Åß„ÅØÊñá‰∏≠„ÇØ„Ç®„É™„Éº„Äåbook„Äç„ÅÆ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„ÅßÈáç„Åø„Å•„Åë„Åï„Çå„ÅüÊÑüÊÉÖ„ÇíË®àÁÆó„Åó„Åü„Åì„Å®„Å´„Å™„Çä„Åæ„Åô„ÄÇ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„É¨„Ç§„É§„Éº„ÅØ2„Å§„ÅÆ„Åì„Å®„ÇíË°å„Å£„Å¶„ÅÑ„Çã„Åì„Å®„ÅåÂàÜ„Åã„Çä„Åæ„ÅôÔºö„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥Ê©üÊßã„Åß„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„Éô„ÇØ„Éà„É´„ÇíË®àÁÆó„Åó„ÄÅ„Åù„Çå„Çí‰Ωø„Å£„Å¶„Éê„É™„É•„Éº„ÅÆÂä†ÈáçÂπ≥Âùá„ÇíÊ±Ç„ÇÅ„Å¶„ÅÑ„Åæ„Åô„ÄÇ</p>
</section>
<section id="id9">
<h2><span class="section-number">13.4. </span>„ÉÜ„É≥„ÇΩ„É´„Éâ„ÉÉ„Éà<a class="headerlink" href="#id9" title="Permalink to this headline">¬∂</a></h2>
<p>„Åì„ÅÆÂÜÖÁ©ç„ÄÅ„ÇΩ„Éï„Éà„Éû„ÉÉ„ÇØ„Çπ„ÄÅÈõÜÁ¥Ñ„ÅØ„ÉÜ„É≥„ÇΩ„É´„Éâ„ÉÉ„Éà„Å®Âëº„Å∞„Çå„ÄÅÊúÄ„ÇÇ‰∏ÄËà¨ÁöÑ„Å™„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„É¨„Ç§„É§„Éº„Åß„Åô<span id="id10">[<a class="reference internal" href="#id73" title="Minh-Thang Luong, Hieu Pham, and Christopher D Manning. Effective approaches to attention-based neural machine translation. arXiv preprint arXiv:1508.04025, 2015.">LPM15</a>]</span>„ÄÇ‰∏ÄËà¨ÁöÑ„Å™Ê¥æÁîü„Å®„Åó„Å¶„ÅØ„ÄÅ„Ç≠„Éº„ÅÆÊ¨°ÂÖÉÔºàÊúÄÂæå„ÅÆËª∏„ÅÆÊ¨°ÂÖÉÔºâ„ÅßÂâ≤„Å£„Åü„ÇÇ„ÅÆ„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ„Åì„Åì„Åß„ÄÅ„Ç≠„Éº„ÅåÊ≠£Ë¶èÂåñ„Åï„Çå„Å¶„ÅÑ„Å™„ÅÑ„Åì„Å®„ÇíÊÄù„ÅÑÂá∫„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ‰π±Êï∞„Åß„ÅÇ„Çå„Å∞„ÄÅ‰∏≠ÂøÉÊ•µÈôêÂÆöÁêÜ„Çà„ÇäÂÜÖÁ©ç„Åã„Çâ„ÅÆÂá∫Âäõ„ÅÆÂ§ß„Åç„Åï„ÅØ„ÅØ„Ç≠„Éº„ÅÆÊ¨°ÂÖÉ„ÅÆÂπ≥ÊñπÊ†π„Åß„Çπ„Ç±„Éº„É´„Åó„Åæ„Åô„ÄÇ„Å§„Åæ„Çä„ÄÅ<span class="math notranslate nohighlight">\(e^{\vec{q} \cdot \mathbf{K}}\)</span> „ÇíÂèñ„Çã„Åì„Å®„Åß„ÄÅ„ÇΩ„Éï„Éà„Éû„ÉÉ„ÇØ„ÇπÂÄ§„Å´ÊÇ™ÂΩ±Èüø„Çí‰∏é„Åà„ÇãÂèØËÉΩÊÄß„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ‰ª•‰∏ä„Çí„Åæ„Å®„ÇÅ„Çã„Å®„ÄÅ‰ª•‰∏ã„ÅÆÂºè„ÅÆ„Çà„ÅÜ„Å´„Å™„Çä„Åæ„Åô„ÄÇ</p>
<div class="amsmath math notranslate nohighlight" id="equation-7e6c5157-5ef0-4688-a93d-8a691b882c96">
<span class="eqno">(13.9)<a class="headerlink" href="#equation-7e6c5157-5ef0-4688-a93d-8a691b882c96" title="Permalink to this equation">¬∂</a></span>\[\begin{equation}
    \vec{b} = \mathrm{softmax}\left(\frac{1}{\sqrt{d}}\vec{q}\cdot \mathbf{K}\right)
\end{equation}\]</div>
<p>„Åì„Åì„Åß„ÄÅ<span class="math notranslate nohighlight">\(d\)</span> „ÅØ„ÇØ„Ç®„É™„Éº„Éô„ÇØ„Éà„É´„ÅÆÊ¨°ÂÖÉ„Åß„Åô„ÄÇ</p>
</section>
<section id="id11">
<h2><span class="section-number">13.5. </span>„ÇΩ„Éï„Éà„ÄÅ„Éè„Éº„Éâ„ÄÅÊ∏©Â∫¶„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥<a class="headerlink" href="#id11" title="Permalink to this headline">¬∂</a></h2>
<p>„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„ÅÆÊ¥æÁîüÂΩ¢„Å®„Åó„Å¶ËÄÉ„Åà„Çâ„Çå„Çã„ÅÆ„ÅØ„ÄÅ<span class="math notranslate nohighlight">\(\mathrm{softmax}\)</span> „ÅÆÂá∫Âäõ„Å´„Åä„ÅÑ„Å¶ÊúÄ„ÇÇ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„ÅÆÈ´ò„ÅÑ„ÇÇ„ÅÆ„Çí1„Å´„ÄÅ„Åù„Çå‰ª•Â§ñ„Çí0„Å´ÁΩÆ„ÅçÊèõ„Åà„Çã„Åì„Å®„Åß„Åô„ÄÇ„Åì„Çå„Çí<strong>„Éè„Éº„Éâ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥</strong>„Å®Âëº„Å≥„Åæ„Åô„ÄÇ„Éè„Éº„Éâ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„ÅÆÂºè„ÅØ„ÄÅ‰ª•‰∏ã„ÅÆ„Çà„ÅÜ„Å´„ÇΩ„Éï„Éà„Éû„ÉÉ„ÇØ„Çπ„Çí„Éè„Éº„Éâ„Éû„ÉÉ„ÇØ„Çπ„ÅßÁΩÆ„ÅçÊèõ„Åà„Çã„Åì„Å®„ÅßÂÆöÁæ©„Åï„Çå„Åæ„Åô„ÄÇ</p>
<div class="amsmath math notranslate nohighlight" id="equation-0f8bf81e-161a-41c9-9bd9-91318a8d11aa">
<span class="eqno">(13.10)<a class="headerlink" href="#equation-0f8bf81e-161a-41c9-9bd9-91318a8d11aa" title="Permalink to this equation">¬∂</a></span>\[\begin{equation}
\mathrm{hardmax}\left(\vec{x}\right) = \lim_{T\rightarrow0}\frac{e^\vec{x} / T}{\sum_i e^ {x_i / T}}
\end{equation}\]</div>
<p>„Åì„Çå„ÅØ„ÄÅ <span class="math notranslate nohighlight">\(\vec{x}\)</span> „ÅÆÊúÄÂ§ßË¶ÅÁ¥†„ÅÆ‰ΩçÁΩÆ„Çí1„Å®„Åó„ÄÅ„Åù„Çå‰ª•Â§ñ„ÅÆ‰ΩçÁΩÆ„Å´0„ÇíÁΩÆ„Åè„Åì„Å®„ÇíÊï∞Â≠¶ÁöÑ„Å´ÂÆöÂºèÂåñ„Åó„Åü„ÇÇ„ÅÆ„Åß„Åô„ÄÇ„Åì„ÅÆÂºè„ÅåÁµ±Ë®àÂäõÂ≠¶„ÅÆ„Éú„É´„ÉÑ„Éû„É≥ÂàÜÂ∏É„Å´‰ºº„Å¶„ÅÑ„Çã„Åì„Å®„Åã„Çâ„ÄÅÊ∏©Â∫¶ <span class="math notranslate nohighlight">\(T\)</span>„Å®„ÅÑ„ÅÜÁî®Ë™û„ÇíÁî®„ÅÑ„Å¶„ÅÑ„Åæ„Åô„ÄÇ<span class="math notranslate nohighlight">\(T = 0\)</span> „ÅÆ„Å®„Åç„ÅØ„Éè„Éº„Éâ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„ÄÅ<span class="math notranslate nohighlight">\(T = 1\)</span> „ÅÆ„Å®„Åç„ÅØ„ÇΩ„Éï„Éà„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„ÄÅ<span class="math notranslate nohighlight">\(T = \infty\)</span> „ÅÆ„Å®„Åç„ÅØÂùá‰∏Ä„Å™„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„ÇíÊÑèÂë≥„Åô„Çã„Åì„Å®„Åå„Çè„Åã„Çã„Å®ÊÄù„ÅÑ„Åæ„Åô„ÄÇ<span class="math notranslate nohighlight">\(T\)</span> „Çí‰∏≠ÈñìÁöÑ„Å™ÂÄ§„Å´„Åô„Çã„Åì„Å®„ÇÇÂèØËÉΩ„Åß„Åô„ÄÇ</p>
</section>
<section id="id12">
<h2><span class="section-number">13.6. </span>„Çª„É´„Éï„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥<a class="headerlink" href="#id12" title="Permalink to this headline">¬∂</a></h2>
<p>„Éá„Ç£„Éº„Éó„É©„Éº„Éã„É≥„Ç∞„Åß„ÅØ„ÄÅ„Åô„Åπ„Å¶„Åå„Éê„ÉÉ„ÉÅÂá¶ÁêÜ„Åï„Çå„Çã„Åì„Å®„ÇíË¶ö„Åà„Å¶„ÅÑ„Åæ„Åô„ÅãÔºüÈÄöÂ∏∏„ÄÅ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„É¨„Ç§„É§„Éº„Å∏„ÅÆ„Éê„ÉÉ„ÉÅÂÖ•Âäõ„ÅØ„ÇØ„Ç®„É™„Éº„Åß„Åô„ÄÇ„Åì„Çå„Åæ„Åß„ÅÆË≠∞Ë´ñ„Åß„ÅØ„ÄÅ„ÇØ„Ç®„É™„Éº„ÅØ„Ç≠„Éº„Çà„Çä„ÇÇ1„É©„É≥„ÇØ‰Ωé„ÅÑ„ÉÜ„É≥„ÇΩ„É´Ôºà„ÇØ„Ç®„É™„Éº<strong>„Éô„ÇØ„Éà„É´</strong>Ôºâ„Åß„Åó„Åü„Åå„ÄÅ„Éê„ÉÉ„ÉÅÂåñ„Åï„Çå„Çã„Å®„Ç≠„Éº„Å®Âêå„Åò„É©„É≥„ÇØ„Å´„Å™„Çä„Åæ„Åô„ÄÇ„Åª„Å®„Çì„Å©„ÅÆÂ†¥Âêà„ÄÅ„ÇØ„Ç®„É™„Éº„Å®„Ç≠„Éº„ÅØÂêå‰∏Ä„Åß„Åô„ÄÇÊàë„ÄÖ„ÅÆ‰æã„Åß„ÅØ„ÄÅ„ÇØ„Ç®„É™„Éº„ÅØ„Äåbook„Äç„ÅÆÂüã„ÇÅËæº„Åø„Éô„ÇØ„Éà„É´„Åß„ÄÅ„Åì„Çå„ÅØ„Ç≠„Éº„ÅÆ„Å≤„Å®„Å§„Åß„Åó„Åü„ÄÇ„ÇÇ„ÅóÂÖ®„Å¶„ÅÆÂçòË™û„ÇíËÄÉÊÖÆ„Åô„Çã„Çà„ÅÜ„Å´„ÇØ„Ç®„É™„Éº„Çí„Éê„ÉÉ„ÉÅÂá¶ÁêÜ„Åô„Çã„Å®„ÄÅ„ÇØ„Ç®„É™„Éº„ÅØ„Ç≠„Éº„Å®Âêå„Åò„ÇÇ„ÅÆ„Å´„Å™„Çä„Åæ„Åô„ÄÇ„Åï„Çâ„Å´ÁâπÊÆä„Å™„Ç±„Éº„Çπ„Å®„Åó„Å¶„ÄÅ„ÇØ„Ç®„É™„Éº„ÄÅ„Éê„É™„É•„Éº„ÄÅ„Ç≠„ÉºÂÖ®„Å¶„ÅåÂêå„ÅòÂ†¥Âêà„Åå„ÅÇ„Çä„ÄÅ„Åì„Çå„Çí<strong>„Çª„É´„Éï„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥</strong>„Å®Âëº„Å≥„Åæ„Åô„ÄÇ„Åì„Çå„ÅØ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„É°„Ç´„Éã„Ç∫„É†„Åå„Éê„É™„É•„Éº„ÇíÁõ¥Êé•‰ΩøÁî®„Åô„Çã„Åì„Å®„ÇíÊÑèÂë≥„Åó„Å¶„Åä„Çä„ÄÅ„É¨„Ç§„É§„Éº„Å´ÂÖ•Âäõ„Åï„Çå„ÇãÂà•„ÅÆ„Äå„Ç≠„Éº„Äç„ÅØÂ≠òÂú®„Åó„Åæ„Åõ„Çì„ÄÇ</p>
</section>
<section id="id13">
<h2><span class="section-number">13.7. </span>Â≠¶ÁøíÂèØËÉΩ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥<a class="headerlink" href="#id13" title="Permalink to this headline">¬∂</a></h2>
<p>„Åì„Åì„Åæ„ÅßË™¨Êòé„Åó„Å¶„Åç„Åü„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„Å´„ÅØ„ÄÅÂ≠¶ÁøíÂèØËÉΩ„Å™„Éë„É©„É°„Éº„Çø„ÅØÂú®„Çä„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„Å´„Çà„ÇãÂ≠¶Áøí„ÅØ„Å©„ÅÆ„Çà„ÅÜ„Å´„Åó„Å¶Ë°å„ÅÜ„ÅÆ„Åß„Åó„Çá„ÅÜ„ÅãÔºü‰∏ÄËà¨ÁöÑ„Å´„ÄÅÂ≠¶ÁøíÂèØËÉΩ„Å™„Éë„É©„É°„Éº„Çø„ÇíÁõ¥Êé•Âºè„Å´ÊåÅ„Åü„Åõ„Çã„Åì„Å®„ÅØ„Åó„Åæ„Åõ„Çì„ÄÇ‰ª£„Çè„Çä„Å´„ÄÅÂÖ®ÁµêÂêàÂ±§„ÇíÈÄö„Åó„Å¶„Ç≠„Éº„ÄÅ„Éê„É™„É•„Éº„ÄÅ„ÇØ„Ç®„É™„ÉºÔºà<a class="reference internal" href="layers.html"><span class="doc">Standard Layers</span></a>„ÇíÂèÇÁÖßÔºâ„Çí„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„Å∏ÂÖ•Âäõ„Åó„Åæ„Åô„ÄÇ„Åù„ÅÆÁÇ∫„ÄÅ„Å≤„Å®„Å§„ÅÆ„É¨„Ç§„É§„Éº„Å®„Åó„Å¶„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„ÇíË¶ã„Çã„Å®Â≠¶ÁøíÂèØËÉΩ„Å™„Éë„É©„É°„Éº„Çø„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇÂÖ®ÁµêÂêàÂ±§„Å®„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„É¨„Ç§„É§„Éº„ÅÆ„Éñ„É≠„ÉÉ„ÇØ„Å®„Åó„Å¶Ë¶ã„Çå„Å∞Â≠¶ÁøíÂèØËÉΩ„Åß„Åô„ÄÇ‰ª•‰∏ã„ÅßÊòéÁ§∫ÁöÑ„Å´Á¢∫Ë™ç„Åó„Åæ„Åó„Çá„ÅÜ„ÄÇ</p>
</section>
<section id="id14">
<h2><span class="section-number">13.8. </span>„Éû„É´„ÉÅ„Éò„ÉÉ„Éâ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„Éñ„É≠„ÉÉ„ÇØ<a class="headerlink" href="#id14" title="Permalink to this headline">¬∂</a></h2>
<p>Ë§áÊï∞„ÅÆ„Éï„Ç£„É´„Çø„Éº„Å´„Çà„ÇãÁï≥„ÅøËæº„Åø„Å´ÁùÄÊÉ≥„ÇíÂæó„Åü„ÄÅË§áÊï∞„ÅÆ‰∏¶Âàó„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„Åã„Çâ„Å™„Çã„Éñ„É≠„ÉÉ„ÇØÔºà„É¨„Ç§„É§„Éº„ÅÆ„Ç∞„É´„Éº„ÉóÔºâ„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ„Åì„Çå„Çâ„ÅØ„Äå„Éû„É´„ÉÅ„Éò„ÉÉ„Éâ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„Äç„Å®Âëº„Å∞„Çå„Åæ„Åô„ÄÇ„ÇÇ„Åó„Éê„É™„É•„Éº„ÅÆÂΩ¢Áä∂„Åå <span class="math notranslate nohighlight">\((L, V)\)</span> „Åß„ÅÇ„Çå„Å∞„ÄÅ<span class="math notranslate nohighlight">\((H, V)\)</span> „ÅÆÂΩ¢Áä∂„ÅÆ„ÉÜ„É≥„ÇΩ„É´„ÅåËøî„Å£„Å¶„Åç„Åæ„Åô„ÄÇ„Åì„Åì„Åß„ÄÅ<span class="math notranslate nohighlight">\(H\)</span> „ÅØ‰∏¶Âàó„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„É¨„Ç§„É§„ÉºÔºà„Éò„ÉÉ„ÉâÔºâ„ÅÆÊï∞„Åß„Åô„ÄÇ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„É¨„Ç§„É§„Éº„Å´Â≠¶ÁøíÂèØËÉΩ„Éë„É©„É°„Éº„Çø„Åå„Å™„ÅÑ„ÅÆ„Å™„Çâ„ÄÅ„Å©„Çì„Å™ÊÑèÂë≥„Åå„ÅÇ„Çã„ÅÆ„Åß„Åó„Çá„ÅÜ„Åã„ÄÇ„Åì„Åì„Åß„ÄÅÈáç„Åø„ÇíÂ∞éÂÖ•„Åó„Åæ„Åó„Çá„ÅÜ„ÄÇÂÖ®„Å¶„ÅÆ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„Éò„ÉÉ„Éâ„ÅÆÂΩ¢Áä∂„Åå‰∏ÄÂÆö„Åß„ÅÇ„ÇãÂøÖË¶Å„Åå„ÅÇ„Çã„ÅÆ„Åß„ÄÅÈáç„Åø„ÅØ<strong>Ê≠£Êñπ</strong>Ë°åÂàó„Å´„Å™„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇ</p>
<p>„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„É¨„Ç§„É§„Éº„Åå <span class="math notranslate nohighlight">\(A(\vec{q}, \mathbf{K}, \mathbf{V})\)</span> „ÅßÂÆöÁæ©„Åï„Çå„Å¶„ÅÑ„Çã„Å®„Åó„Åæ„Åô„ÄÇ„Åì„ÅÆÊôÇ„Éû„É´„ÉÅ„Éò„ÉÉ„Éâ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„ÅØ‰ª•‰∏ã„ÅÆ„Çà„ÅÜ„Å´Êõ∏„Åë„Åæ„Åô„ÄÇ</p>
<div class="amsmath math notranslate nohighlight" id="equation-c4fa2e59-0447-443a-8d77-0afe9b486924">
<span class="eqno">(13.11)<a class="headerlink" href="#equation-c4fa2e59-0447-443a-8d77-0afe9b486924" title="Permalink to this equation">¬∂</a></span>\[\begin{equation}
\left[A(\mathbf{W}_q^0\vec{q}, \mathbf{W}_k^0\mathbf{K}, \mathbf{W}_v^0\mathbf{V}), A(\mathbf{W}_q^1\vec{q}, \mathbf{W}_k^1\mathbf{K}, \mathbf{W}_v^1\mathbf{V}), \ldots, A(\mathbf{W}_q^H\vec{q}, \mathbf{W}_k^H\mathbf{K}, \mathbf{W}_v^H\mathbf{V})\right]
\end{equation}\]</div>
<p>„Åì„Åì„Åß„ÄÅÂá∫Âäõ„Éô„ÇØ„Éà„É´ <span class="math notranslate nohighlight">\(\ldots\)</span> „ÅÆÂêÑË¶ÅÁ¥†„ÅØ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„É¨„Ç§„É§„Éº„Åã„Çâ„ÅÆÂá∫Âäõ„Åß„ÄÅ <span class="math notranslate nohighlight">\(H\)</span> ÂÄã„ÅÆ <span class="math notranslate nohighlight">\((L, V)\)</span> „ÅÆÂΩ¢Áä∂„Çí„Åó„Åü„ÉÜ„É≥„ÇΩ„É´„Åß„Åô„ÄÇ„Å§„Åæ„Çä„ÄÅÂÖ®‰Ωì„ÅÆÂá∫Âäõ„Å®„Åó„Å¶„ÅØ <span class="math notranslate nohighlight">\((H, L, V)\)</span> „ÅÆÂΩ¢Áä∂„Çí„Åó„Åü„ÉÜ„É≥„ÇΩ„É´„Å´„Å™„Çä„Åæ„Åô„ÄÇ„Éû„É´„ÉÅ„Éò„ÉÉ„Éâ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„Éñ„É≠„ÉÉ„ÇØ„ÅÆÊúÄ„ÇÇÊúâÂêç„Å™‰æã„ÅØ„ÄÅ„Éà„É©„É≥„Çπ„Éï„Ç©„Éº„Éû„Éº<span id="id15">[]</span>„Åß‰ΩøÁî®„Åï„Çå„Å¶„ÅÑ„Çã„Çª„É´„Éï„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„Éû„É´„ÉÅ„Éò„ÉÉ„Éâ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„Éñ„É≠„ÉÉ„ÇØ„Åß„Åô„ÄÇÈÄöÂ∏∏„ÄÅË§áÊï∞„ÅÆÈÄ£Á∂ö„Åó„Åü„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„Éñ„É≠„ÉÉ„ÇØ„ÇíÈÅ©Áî®„Åô„Çã„ÅÆ„Åß„ÄÅÊ¨°„ÅÆ„Éñ„É≠„ÉÉ„ÇØ„Å∏ÂÖ•Âäõ„Åï„Çå„Çã„Éê„É™„É•„Éº„ÅØ„ÄÅ„É©„É≥„ÇØ3 <span class="math notranslate nohighlight">\((H, L, V)\)</span> „Åß„ÅØ„Å™„Åè„É©„É≥„ÇØ2„ÅÆ„ÉÜ„É≥„ÇΩ„É´„Åß„ÅÇ„ÇãÂøÖË¶Å„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ„Åó„Åü„Åå„Å£„Å¶„ÄÅ„Éû„É´„ÉÅ„Éò„ÉÉ„Éâ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„ÅÆÂá∫Âäõ„ÅØ„Åó„Å∞„Åó„Å∞ <span class="math notranslate nohighlight">\((H, V, V)\)</span> „Åæ„Åü„ÅØ <span class="math notranslate nohighlight">\((H)\)</span> „ÅÆÈáç„Åø„ÉÜ„É≥„ÇΩ„É´„Å®„ÅÆË°åÂàóÁ©ç„Å´„Çà„Å£„Å¶„É©„É≥„ÇØ2„Å´„Å™„Çä„Åæ„Åô„ÄÇ„Åì„Çå„ÅåÂàÜ„Åã„Çä„Å´„Åè„ÅÑ„Çà„ÅÜ„Åß„ÅÇ„Çå„Å∞„ÄÅ‰ª•‰∏ã„ÅÆ‰æã„ÇíÂèÇÁÖß„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
</section>
<section id="id16">
<h2><span class="section-number">13.9. </span>„Éé„Éº„Éà„Éñ„ÉÉ„ÇØ„ÇíÂÆüË°å„Åô„Çã<a class="headerlink" href="#id16" title="Permalink to this headline">¬∂</a></h2>
<p>‰∏ä„ÅÆ ¬†<i aria-label="Launch interactive content" class="fas fa-rocket"></i>¬† „Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶„ÄÅGoogle Colab „ÇíÁ´ã„Å°‰∏ä„Åí„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
</section>
<section id="id17">
<h2><span class="section-number">13.10. </span>„Ç≥„Éº„Éâ„ÅÆ‰æã<a class="headerlink" href="#id17" title="Permalink to this headline">¬∂</a></h2>
<p>„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„Åå„Å©„ÅÆ„Çà„ÅÜ„Å´ÂÆüË£Ö„Åï„Çå„Å¶„ÅÑ„Çã„ÅãË¶ã„Å¶„Åø„Åæ„Åó„Çá„ÅÜ„ÄÇ„Åì„Åì„Åß„ÅØÊßò„ÄÖ„Å™Èáè„Å´„É©„É≥„ÉÄ„É†„Å™Â§âÊï∞„Çí‰ΩøÁî®„Åô„Çã„ÅÆ„Åß„ÄÅÂ≠¶Áøí„Åï„Çå„ÇãÂ§âÊï∞„Çí <code class="docutils literal notranslate"><span class="pre">w_</span></code> „Åß„ÄÅÂÖ•ÂäõÂ§âÊï∞„Çí <code class="docutils literal notranslate"><span class="pre">i_</span></code> „ÅßË°®„Åô„Åì„Å®„Å´„Åó„Åæ„Åô„ÄÇ</p>
<section id="id18">
<h3><span class="section-number">13.10.1. </span>„ÉÜ„É≥„ÇΩ„É´„Éâ„ÉÉ„ÉàÊ©üÊßã<a class="headerlink" href="#id18" title="Permalink to this headline">¬∂</a></h3>
<p>„Åæ„Åö„ÄÅ„ÉÜ„É≥„ÇΩ„É´„Éâ„ÉÉ„ÉàÊ©üÊßã„ÅÆÂÆüË£Ö„Åã„ÇâÂßã„ÇÅ„Åæ„Åô„ÄÇ‰æã„Å®„Åó„Å¶„ÄÅÁ≥ªÂàó„ÅÆÈï∑„Åï„Çí11„ÄÅ„Ç≠„ÉºÁâπÂæ¥Èáè„ÅÆÈï∑„Åï„Çí4„ÄÅ„Éê„É™„É•„ÉºÁâπÂæ¥Èáè„ÅÆÊ¨°ÂÖÉ„Çí2„Å®„Åó„Åæ„Åô„ÄÇ„Ç≠„Éº„Å®„ÇØ„Ç®„É™„Éº„ÅØ„ÄÅÁâπÂæ¥Èáè„ÅÆÊ¨°ÂÖÉ„ÅåÂêå„Åò„Åß„ÅÇ„Çã„Åì„Å®„Å´Ê≥®ÊÑè„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="k">def</span> <span class="nf">softmax</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">tensor_dot</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">softmax</span><span class="p">((</span><span class="n">k</span> <span class="o">@</span> <span class="n">q</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">b</span>


<span class="n">i_query</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,))</span>
<span class="n">i_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">b</span> <span class="o">=</span> <span class="n">tensor_dot</span><span class="p">(</span><span class="n">i_query</span><span class="p">,</span> <span class="n">i_keys</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;b = &quot;</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>b =  [0.09174118 0.05650509 0.00936613 0.04066519 0.01278675 0.28406205
 0.02327961 0.04073839 0.06552707 0.0058136  0.36951494]
</pre></div>
</div>
</div>
</div>
<p>ÊúüÂæÖÈÄö„Çä„ÄÅÂêàË®à„Åå1„ÅÆ„Éô„ÇØ„Éà„É´ <span class="math notranslate nohighlight">\(\vec{b}\)</span> „ÅåÂæó„Çâ„Çå„Åæ„Åó„Åü„ÄÇ</p>
</section>
<section id="attention">
<h3><span class="section-number">13.10.2. </span>‰∏ÄËà¨ÁöÑ„Å™Attention<a class="headerlink" href="#attention" title="Permalink to this headline">¬∂</a></h3>
<p>„Åß„ÅØ„ÄÅ„Åì„ÅÆ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥Ê©üÊßã„Çí„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„É¨„Ç§„É§„Éº„Å´ÁµÑ„ÅøËæº„Åø„Åæ„Åó„Çá„ÅÜ„ÄÇ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">attention_layer</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">tensor_dot</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">b</span> <span class="o">@</span> <span class="n">v</span>


<span class="n">i_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">attention_layer</span><span class="p">(</span><span class="n">i_query</span><span class="p">,</span> <span class="n">i_keys</span><span class="p">,</span> <span class="n">i_values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-0.92364379,  0.03003698])
</pre></div>
</div>
</div>
</div>
<p>ÂêÑÁâπÂæ¥Ê¨°ÂÖÉ„Å´1„Å§„Åö„Å§„ÄÅ2„Å§„ÅÆÂÄ§„ÅåÂæó„Çâ„Çå„Åæ„Åô„ÄÇ</p>
</section>
<section id="id19">
<h3><span class="section-number">13.10.3. </span>„Çª„É´„Éï„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥<a class="headerlink" href="#id19" title="Permalink to this headline">¬∂</a></h3>
<p>„Çª„É´„Éï„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„ÅÆÂ§âÊõ¥ÁÇπ„ÅØ„ÄÅ„ÇØ„Ç®„É™„Éº„ÄÅ„Ç≠„Éº„ÄÅ„Éê„É™„É•„Éº„ÇíÁ≠â„Åó„Åè„Åô„Çã„Åì„Å®„Åß„Åô„ÄÇ„Åì„ÅÆË®≠ÂÆö„Åß„ÅØ„ÇØ„Ç®„É™„Éº„ÅÆ„Éê„ÉÉ„ÉÅÂá¶ÁêÜ„ÅåÂøÖË¶Å„Å´„Å™„Çä„ÄÅ„É©„É≥„ÇØ2„ÅÆÂá∫Âäõ„ÇíÂæó„Åæ„Åô„ÄÇ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">batched_tensor_dot</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="c1"># a „ÅØ batch x seq x feature Ê¨°ÂÖÉÔºà„Åì„Åì„Åß„ÅØ N x N x 4Ôºâ„Å´„Å™„Çã</span>
    <span class="c1"># „Ç¢„Ç§„É≥„Ç∑„É•„Çø„Ç§„É≥Ë®òÊ≥ï„Å´„Çà„Çã„Éê„ÉÉ„ÉÅÂåñ„Åï„Çå„Åü„Éâ„ÉÉ„ÉàÁ©ç</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ij,kj-&gt;ik&quot;</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="c1"># Á≥ªÂàó„Å´ÂØæ„Åó„Å¶„ÇΩ„Éï„Éà„Éû„ÉÉ„ÇØ„Çπ„ÇíÈÅ©Áî®</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">softmax</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">b</span>


<span class="k">def</span> <span class="nf">self_attention</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">batched_tensor_dot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">b</span> <span class="o">@</span> <span class="n">x</span>


<span class="n">i_batched_query</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">self_attention</span><span class="p">(</span><span class="n">i_batched_query</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-0.00996345, -0.38813056, -0.30894345,  0.18664637],
       [-0.45765476,  0.92184258, -0.72787612, -0.49905407],
       [ 0.35567921, -0.73674509, -0.00220817, -0.30268984],
       [ 0.02934809, -0.30256288, -0.32320726,  0.06699482],
       [-0.74606661,  1.36075423, -1.18720815, -0.37666908],
       [ 0.52297125, -1.02231599, -0.17517125, -0.12727736],
       [ 0.01553327, -0.26733581, -0.01861591, -0.10031097],
       [ 0.23416074, -0.59084501, -0.16873929, -0.0030916 ],
       [ 0.18957948, -0.42318877,  0.11512943, -0.40975851],
       [ 0.58935955, -1.12568388, -0.20328515, -0.04780711],
       [-0.25871887, -0.20722361,  0.03452749,  0.39054537]])
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(11\times4\)</span> „ÅÆË°åÂàó„ÅåÂæó„Çâ„Çå„Çå„Å∞‰∏äÊâã„ÅèË®àÁÆó„Åå„Åß„Åç„Å¶„ÅÑ„Åæ„Åô„ÄÇ</p>
</section>
<section id="id20">
<h3><span class="section-number">13.10.4. </span>Â≠¶ÁøíÂèØËÉΩ„Éë„É©„É°„Éº„Çø„ÇíËøΩÂä†„Åô„Çã<a class="headerlink" href="#id20" title="Permalink to this headline">¬∂</a></h3>
<p>„Åì„Çå„Çâ„ÅÆ„Çπ„ÉÜ„ÉÉ„Éó„Å´Èáç„ÅøË°åÂàó„ÇíËøΩÂä†„Åô„Çã„Åì„Å®„Åß„ÄÅÂ≠¶ÁøíÂèØËÉΩ„Éë„É©„É°„Éº„Çø„ÇíËøΩÂä†„Åô„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ„Çª„É´„Éï„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„ÅßÂÆüË∑µ„Åó„Å¶„Åø„Åæ„Åó„Çá„ÅÜ„ÄÇ„Çª„É´„Éï„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„Åß„ÅØ„Ç≠„Éº„ÄÅ„Éê„É™„É•„Éº„ÄÅ„ÇØ„Ç®„É™„Éº„ÅØÂêå„Åò„ÇÇ„ÅÆ„Åß„Åó„Åü„Åå„ÄÅ„Åù„Çå„Åû„Çå„Å´Áï∞„Å™„ÇãÈáç„Åø„ÇíÊéõ„Åë„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ„Éá„É¢„Å®„Åó„Å¶„ÄÅ„Éê„É™„É•„Éº„ÅÆÁâπÂæ¥ÈáèÊ¨°ÂÖÉ„Çí2„Å´Â§âÊõ¥„Åó„Å¶„Åø„Åæ„Åô„ÄÇ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Èáç„Åø„ÇíÂÖ•ÂäõÊ¨°ÂÖÉ -&gt; ÊâÄÊúõ„ÅÆÁâπÂæ¥ÈáèÊ¨°ÂÖÉ„Å´Â§âÊõ¥„Åô„Çã„ÄÇ</span>
<span class="n">w_q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">w_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">w_v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">trainable_self_attention</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">w_q</span><span class="p">,</span> <span class="n">w_k</span><span class="p">,</span> <span class="n">w_v</span><span class="p">):</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">x</span> <span class="o">@</span> <span class="n">w_q</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">x</span> <span class="o">@</span> <span class="n">w_k</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">x</span> <span class="o">@</span> <span class="n">w_v</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">batched_tensor_dot</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">b</span> <span class="o">@</span> <span class="n">v</span>


<span class="n">trainable_self_attention</span><span class="p">(</span><span class="n">i_batched_query</span><span class="p">,</span> <span class="n">w_q</span><span class="p">,</span> <span class="n">w_k</span><span class="p">,</span> <span class="n">w_v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0.02804042,  0.03676662],
       [-0.20488129,  1.61415362],
       [ 0.29115593, -0.17071063],
       [-0.00959071,  0.10859463],
       [-0.63803073,  3.70610671],
       [-0.32742712, -0.49009977],
       [ 0.26574454, -0.04692339],
       [ 0.01151851,  0.0384615 ],
       [ 0.39671425, -0.09665473],
       [-0.6680624 , -0.74800718],
       [ 0.10521715,  0.00847117]])
</pre></div>
</div>
</div>
</div>
<p>Èáç„Åø„Åß„Éê„É™„É•„Éº„ÅÆÁâπÂæ¥ÈáèÊ¨°ÂÖÉ„Çí2„Å´„Åó„Åü„ÅÆ„Åß„ÄÅ <span class="math notranslate nohighlight">\(11\times 2\)</span>„ÅÆÂá∫Âäõ„ÅåÂæó„Çâ„Çå„Åæ„Åô„ÄÇ</p>
</section>
<section id="id21">
<h3><span class="section-number">13.10.5. </span>„Éû„É´„ÉÅ„Éò„ÉÉ„Éâ<a class="headerlink" href="#id21" title="Permalink to this headline">¬∂</a></h3>
<p>„Éû„É´„ÉÅ„Éò„ÉÉ„Éâ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„ÅÆÂîØ‰∏Ä„ÅÆÂ§âÊõ¥ÁÇπ„ÅØÂêÑ„Éò„ÉÉ„Éâ„Å´ÂØæ„Åó„Å¶1„Å§„ÅÆÈáç„Åø„ÇíÊåÅ„Å°„ÄÅ„Éò„ÉÉ„ÉâÈÅ©Áî®Âæå„ÅÆÂá∫Âäõ„ÇíÁµêÂêà„Åô„Çã„Åì„Å®„Åß„Åô„ÄÇÂ≠¶ÁøíÂèØËÉΩ„Å™Èï∑„Åï <span class="math notranslate nohighlight">\(H\)</span> „ÅÆÈáç„Åø„Éô„ÇØ„Éà„É´„Çí‰Ωø„Å£„Å¶Âá∫Âäõ„ÇíÈÄ£Áµê„Åó„Åü„Çä„ÄÅÂπ≥Âùá„ÇÑÊúÄÂ§ßÂÄ§„Å™„Å©„ÅÆÈõÜÁ¥Ñ„ÇíË°å„ÅÑ„Åæ„Åô„ÄÇ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">w_q_h1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">w_k_h1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">w_v_h1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">w_q_h2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">w_k_h2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">w_v_h2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">w_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">multihead_attention</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">w_q_h1</span><span class="p">,</span> <span class="n">w_k_h1</span><span class="p">,</span> <span class="n">w_v_h1</span><span class="p">,</span> <span class="n">w_q_h2</span><span class="p">,</span> <span class="n">w_k_h2</span><span class="p">,</span> <span class="n">w_v_h2</span><span class="p">):</span>
    <span class="n">h1_out</span> <span class="o">=</span> <span class="n">trainable_self_attention</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">w_q_h1</span><span class="p">,</span> <span class="n">w_k_h1</span><span class="p">,</span> <span class="n">w_v_h1</span><span class="p">)</span>
    <span class="n">h2_out</span> <span class="o">=</span> <span class="n">trainable_self_attention</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">w_q_h2</span><span class="p">,</span> <span class="n">w_k_h2</span><span class="p">,</span> <span class="n">w_v_h2</span><span class="p">)</span>
    <span class="c1"># join along last axis so we can use dot.</span>
    <span class="n">all_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">h1_out</span><span class="p">,</span> <span class="n">h2_out</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">all_h</span> <span class="o">@</span> <span class="n">w_h</span>


<span class="n">multihead_attention</span><span class="p">(</span><span class="n">i_batched_query</span><span class="p">,</span> <span class="n">w_q_h1</span><span class="p">,</span> <span class="n">w_k_h1</span><span class="p">,</span> <span class="n">w_v_h1</span><span class="p">,</span> <span class="n">w_q_h2</span><span class="p">,</span> <span class="n">w_k_h2</span><span class="p">,</span> <span class="n">w_v_h2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 9.81528617, -5.98624485],
       [ 0.40243997, -0.16363673],
       [-2.62430805, -2.03426088],
       [ 6.1758559 , -3.08479641],
       [ 4.19679804,  3.10560578],
       [-0.44782809, -4.13747693],
       [-0.82280743, -0.2573575 ],
       [ 2.33998496, -1.39506047],
       [-1.30871377, -0.88976096],
       [ 7.28064   , -7.52450603],
       [-0.75220812, -0.11820786]])
</pre></div>
</div>
</div>
</div>
<p>ÊúüÂæÖÈÄö„Çä„ÄÅ„É©„É≥„ÇØ2„Åß„ÅÇ„Çã <span class="math notranslate nohighlight">\(11\times 2\)</span> „ÅÆÂá∫Âäõ„ÅåÂæó„Çâ„Çå„Åæ„Åó„Åü„ÄÇ</p>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id22">
<h1><span class="section-number">14. </span>„Ç∞„É©„Éï„Éã„É•„Éº„É©„É´„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„Å´„Åä„Åë„Çã„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥<a class="headerlink" href="#id22" title="Permalink to this headline">¬∂</a></h1>
<p>„Ç∞„É©„Éï„Éã„É•„Éº„É©„É´„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„ÅÆÈáçË¶Å„Å™ÊÄßË≥™„Å´ permutation equivariant „Åå„ÅÇ„Çã„Åì„Å®„ÇíÊÄù„ÅÑÂá∫„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
Êàë„ÄÖ„ÅØ„Ç∞„É©„Éï„Éã„É•„Éº„É©„É´„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„Çí permutation equivariant „Å´„Åô„Çã„Åü„ÇÅ„Å´„ÄÅÂêàË®à„ÇÑÂπ≥Âùá„Å™„Å©„ÅÆÈõÜÁ¥Ñ„Çí‰ΩøÁî®„Åó„Å¶„Åç„Åæ„Åó„Åü„ÄÇ</p>
<p>„Åæ„Åü„ÄÅ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„É¨„Ç§„É§„Éº„ÅØ permutation invariantÔºà„Éê„ÉÉ„ÉÅÂåñ„Åó„Å™„ÅÑÊôÇÔºâ„ÇÇ„Åó„Åè„ÅØ permutation equivariantÔºà„Éê„ÉÉ„ÉÅÂåñ„Åô„ÇãÊôÇÔºâ„Åß„Åô„ÄÇ„Åì„ÅÆ„Åü„ÇÅ„ÄÅ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„ÅØËøëÂÇçÊÉÖÂ†±„ÇíÈõÜÁ¥Ñ„Åô„ÇãÊñπÊ≥ï„Å®„Åó„Å¶„Çà„ÅèÂà©Áî®„Åï„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„É¨„Ç§„É§„Éº„ÅØÈáçË¶Å„Å™ËøëÂÇç„ÇíË¶ã„Å§„Åë„Çã„ÅÆ„ÅåÂæóÊÑè„Å™„ÅÆ„Åß„ÄÅÈ´òÊ¨°ÂÖÉ„Ç∞„É©„ÉïÔºàÂ§ßÈáè„Å™ËøëÂÇç„ÇíÊåÅ„Å§Ôºâ„Å´„Åä„ÅÑ„Å¶ÈáçË¶Å„Åß„Åô„ÄÇ„Åì„Çå„ÅØÂàÜÂ≠ê„Åß„ÅØÁ®Ä„Å™„Åì„Å®„Åß„Åô„Åå„ÄÅÂÖ®„Å¶„ÅÆÂéüÂ≠ê„ÇíÁµêÂêà„Åó„Å¶„Åù„ÅÆË∑ùÈõ¢„Çí„Ç®„ÉÉ„Ç∏„Å®„Åó„Å¶ÁΩÆ„Åè„Å†„Åë„ÅßËâØ„ÅÑ„Å®„ÅÑ„ÅÜ„Åì„Å®„Åß„Åô„ÄÇ„Ç∞„É©„ÉïÁï≥„ÅøËæº„Åø„É¨„Ç§„É§„ÉºÔºàGCN„É¨„Ç§„É§„ÉºÔºâ„ÇÑ„Åª„Å®„Çì„Å©„ÅÆGNN„É¨„Ç§„É§„Éº„Åå„ÄÅ„É¨„Ç§„É§„Éº„Åî„Å®„Å´„Å≤„Å®„Å§„ÅÆÁµêÂêà„Åó„ÅãÊÉÖÂ†±„Çí‰ºùÊí≠„Åï„Åõ„Çã„Åì„Å®„Åå„Åß„Åç„Å™„ÅÑ„Åì„Å®„ÇíÊÄù„ÅÑÂá∫„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ„Åó„Åü„Åå„Å£„Å¶„ÄÅÂÖ®„Å¶„ÅÆÂéüÂ≠ê„ÇíÁµêÂêà„Åó„Å¶„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„ÇíÈÅ©Áî®„Åô„Çã„Åì„Å®„ÅØ„ÄÅÂ§öÊï∞„ÅÆ„É¨„Ç§„É§„Éº„ÇíÁµåÁî±„Åó„Å™„Åè„Å¶„ÇÇÈï∑Ë∑ùÈõ¢„ÅÆÊÉÖÂ†±‰ºùÈÅî„ÅåÂèØËÉΩ„Å´„Å™„Çä„Åæ„Åô„ÄÇ„Åü„Å†„Åó„ÄÅ„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„ÅåÊ≠£„Åó„ÅÑÁµêÂêà/ÂéüÂ≠ê„Å´Ê≥®ÊÑè„ÇíÂêë„Åë„Å¶„ÅÑ„Çã„ÅãÊ∞ó„Çí‰ªò„Åë„ÇãÂøÖË¶Å„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ</p>
<p>„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„Åå Battaglia equations<span id="id23">[<a class="reference internal" href="gnn.html#id78" title="Peter W Battaglia, Jessica B Hamrick, Victor Bapst, Alvaro Sanchez-Gonzalez, Vinicius Zambaldi, Mateusz Malinowski, Andrea Tacchetti, David Raposo, Adam Santoro, Ryan Faulkner, and others. Relational inductive biases, deep learning, and graph networks. arXiv preprint arXiv:1806.01261, 2018.">BHB+18</a>]</span> „Å´„Å©„ÅÜÂΩì„Å¶„ÅØ„Åæ„Çã„ÅãË¶ã„Å¶„Åø„Åæ„Åó„Çá„ÅÜ„ÄÇBattaglia ÊñπÁ®ãÂºè„ÅØGNN„ÇíÂÆöÁæ©„Åô„Çã„Åü„ÇÅ„ÅÆ‰∏ÄËà¨ÁöÑ„Å™Ê®ôÊ∫ñÊñπÁ®ãÂºè„Åß„ÅÇ„Çã„Åì„Å®„ÇíÊÄù„ÅÑÂá∫„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„ÅØË§áÊï∞„ÅÆÂ†¥ÊâÄ„Å´Áèæ„Çå„Çã„Åì„Å®„Åå„ÅÇ„Çä„Åæ„Åô„Åå„ÄÅÂÖàËø∞„Åó„ÅüÈÄö„ÇäËøëÂÇç„ÇíËÄÉÊÖÆ„Åô„ÇãÊôÇ„Å´Áèæ„Çå„Åæ„Åô„ÄÇÂÖ∑‰ΩìÁöÑ„Å´„ÅØ„ÄÅ„ÇØ„Ç®„É™„Éº„ÅØ <span class="math notranslate nohighlight">\(i\)</span> Áï™ÁõÆ„ÅÆ„Éé„Éº„Éâ„Å®„Å™„Çä„ÄÅ„Ç≠„ÉºÔºè„Éê„É™„É•„Éº„ÅØËøëÂÇç„Éé„Éº„Éâ„Å®„Ç®„ÉÉ„Ç∏„ÅÆÁâπÂæ¥„ÅÆÁµÑ„ÅøÂêà„Çè„Åõ„Å´„Å™„Çä„Åæ„Åô„ÄÇBattaglia ÊñπÁ®ãÂºè„Åå„Åç„Çå„ÅÑ„Å´ÂΩì„Å¶„ÅØ„Åæ„Çã„Çπ„ÉÜ„ÉÉ„Éó„ÅØ„Å™„ÅÑ„Åå„ÄÅ‰ª•‰∏ã„ÅÆ„Çà„ÅÜ„Å´„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„É¨„Ç§„É§„Éº„ÇíÂàÜÂâ≤„Åô„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„É¨„Ç§„É§„Éº„ÅÆÂ§ßÈÉ®ÂàÜ„ÅØ„Ç®„ÉÉ„Ç∏Êõ¥Êñ∞Âºè„Å´ÂΩì„Å¶„ÅØ„Åæ„Çã„Åß„Åó„Çá„ÅÜ„ÄÇ</p>
<div class="amsmath math notranslate nohighlight" id="equation-028bceb5-9d1d-4c70-b81e-c2f554189bcd">
<span class="eqno">(14.1)<a class="headerlink" href="#equation-028bceb5-9d1d-4c70-b81e-c2f554189bcd" title="Permalink to this equation">¬∂</a></span>\[\begin{equation}
\vec{e}^{'}_k = \phi^e\left( \vec{e}_k, \vec{v}_{rk}, \vec{v}_{sk}, \vec{u}\right)
\end{equation}\]</div>
<p>„Åì„Çå„ÅØ‰∏ÄËà¨Âåñ„Åï„Çå„ÅüÂºè„Åß„ÅÇ„Çä„ÄÅ <span class="math notranslate nohighlight">\(\phi^e()\)</span> „ÅÆÈÅ∏Êäû„ÅåGNN„ÇíÂÆöÁæ©„Åó„Å¶„ÅÑ„Çã„Åì„Å®„ÇíÊÄù„ÅÑÂá∫„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ<span class="math notranslate nohighlight">\(\vec{e}_k\)</span> „ÅØ„Ç®„ÉÉ„Ç∏ <span class="math notranslate nohighlight">\(k\)</span> „ÅÆÁâπÂæ¥Èáè„Éô„ÇØ„Éà„É´„ÄÅ<span class="math notranslate nohighlight">\(\vec{v}_{rk}\)</span> „ÅØ„Ç®„ÉÉ„Ç∏ <span class="math notranslate nohighlight">\(k\)</span> „ÅÆÂèó‰ø°„Éé„Éº„ÉâÁâπÂæ¥Èáè„Éô„ÇØ„Éà„É´„ÄÅ<span class="math notranslate nohighlight">\(\vec{v}_{sk}\)</span> „ÅØ„Ç®„ÉÉ„Ç∏ <span class="math notranslate nohighlight">\(k\)</span> „ÅÆÈÄÅ‰ø°„Éé„Éº„ÉâÁâπÂæ¥Èáè„Éô„ÇØ„Éà„É´„ÄÅ<span class="math notranslate nohighlight">\(\vec{u}\)</span> „ÅØÂÖ®‰Ωì„Ç∞„É©„ÉïÁâπÂæ¥Èáè„Åß„Åô„ÄÇ„Åì„ÅÆ„Çπ„ÉÜ„ÉÉ„Éó„Çí„ÄÅ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥Ê©üÊßã„Å´Âà©Áî®„Åó„Åæ„Åô„ÄÇ„Åì„Åì„Åß„ÄÅ„ÇØ„Ç®„É™„ÅØ„ÉºÂèó‰ø°„Éé„Éº„Éâ <span class="math notranslate nohighlight">\(\vec{c}_{rk}\)</span> „Åß„ÄÅ„Ç≠„ÉºÔºè„Éê„É™„É•„Éº„ÅØÈÄÅ‰ø°„Å®„Ç®„ÉÉ„Ç∏„Éô„ÇØ„Éà„É´„Åß„Åô„ÄÇÂÖ∑‰ΩìÁöÑ„Å´„ÅØ„ÄÅZhang„Çâ„ÅÆ„Ç¢„Éó„É≠„Éº„ÉÅÔºà<span id="id24">[<a class="reference internal" href="gnn.html#id84" title="Jiani Zhang, Xingjian Shi, Junyuan Xie, Hao Ma, Irwin King, and Dit-Yan Yeung. Gaan: gated attention networks for learning on large and spatiotemporal graphs. arXiv preprint arXiv:1803.07294, 2018.">ZSX+18</a>]</span>Ôºâ„Çí„ÉÜ„É≥„ÇΩ„É´„Éâ„ÉÉ„ÉàÊ©üÊßã„ÅßÂà©Áî®„Åó„Åæ„Åô„ÄÇÂΩº„Çâ„ÅØ„Éé„Éº„ÉâÁâπÂæ¥Èáè„ÅÆ„Åø„ÇíËÄÉÊÖÆ„Åó„ÄÅ„Ç≠„Éº„Å®„Éê„É™„É•„Éº„ÅØ„Éé„Éº„ÉâÁâπÂæ¥Èáè„Å®Âêå‰∏Ä„Å´Ë®≠ÂÆö„Åó„Åæ„Åó„Åü„ÄÇ‰∏ÄÊñπ„Åß„ÄÅÂΩº„Çâ„ÅØ„Éé„Éº„ÉâÁâπÂæ¥Èáè„Çí„Ç≠„ÉºÔºè„ÇØ„Ç®„É™„Éº„Å´Â§âÊèõ„Åô„ÇãÂ≠¶ÁøíÂèØËÉΩ„Å™„Éë„É©„É°„Éº„Çø„Çí‰ΩøÁî®„Åó„Åæ„Åó„Åü„ÄÇ</p>
<div class="amsmath math notranslate nohighlight" id="equation-a8c14880-7d15-4f5e-b6a4-21e13ae1fa6d">
<span class="eqno">(14.2)<a class="headerlink" href="#equation-a8c14880-7d15-4f5e-b6a4-21e13ae1fa6d" title="Permalink to this equation">¬∂</a></span>\[\begin{equation}
\vec{q} = \mathbf{W}_q\vec{v}_{rk}
\end{equation}\]</div>
<div class="amsmath math notranslate nohighlight" id="equation-1572deb9-3233-46cb-b155-073e8617d233">
<span class="eqno">(14.3)<a class="headerlink" href="#equation-1572deb9-3233-46cb-b155-073e8617d233" title="Permalink to this equation">¬∂</a></span>\[\begin{equation}
\mathbf{K} = \mathbf{W}_k\vec{v}_{sk}
\end{equation}\]</div>
<div class="amsmath math notranslate nohighlight" id="equation-abf2bd6a-8b43-4855-b14b-5e5ce7354400">
<span class="eqno">(14.4)<a class="headerlink" href="#equation-abf2bd6a-8b43-4855-b14b-5e5ce7354400" title="Permalink to this equation">¬∂</a></span>\[\begin{equation}
\mathbf{V} = \mathbf{W}_v\vec{v}_{sk}
\end{equation}\]</div>
<div class="amsmath math notranslate nohighlight" id="equation-736d0b64-79b8-48f2-9ea0-4616e304ae6d">
<span class="eqno">(14.5)<a class="headerlink" href="#equation-736d0b64-79b8-48f2-9ea0-4616e304ae6d" title="Permalink to this equation">¬∂</a></span>\[\begin{equation}
    \vec{b}_k = \mathrm{softmax}\left(\frac{1}{\sqrt{d}} \vec{q}\cdot \mathbf{K}\right)
\end{equation}\]</div>
<div class="amsmath math notranslate nohighlight" id="equation-68574084-5cb7-4cf8-acb2-de05c40c65f9">
<span class="eqno">(14.6)<a class="headerlink" href="#equation-68574084-5cb7-4cf8-acb2-de05c40c65f9" title="Permalink to this equation">¬∂</a></span>\[\begin{equation}
\vec{e}^{'}_k = \vec{b} V
\end{equation}\]</div>
<p>„Å≤„Å®„Å§„ÅÆÂºè„Å´„Åæ„Å®„ÇÅ„Çã„Å®Ôºö</p>
<div class="amsmath math notranslate nohighlight" id="equation-ed295f5c-e7cc-47bc-85e6-351078ca3b18">
<span class="eqno">(14.7)<a class="headerlink" href="#equation-ed295f5c-e7cc-47bc-85e6-351078ca3b18" title="Permalink to this equation">¬∂</a></span>\[\begin{equation}
\vec{e}^{'}_k = \mathrm{softmax}\left(\frac{1}{\sqrt{d}} \mathbf{W}_q\vec{v}_{rk}\cdot \mathbf{W}_k\vec{v}_{sk}\right)\mathbf{W}_v\vec{v}_{sk}
\end{equation}\]</div>
<p>„Åì„Çå„Åß„ÄÅ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„Åã„ÇâÈáç„Åø„Å•„Åë„Åï„Çå„Åü„Ç®„ÉÉ„Ç∏ÁâπÂæ¥Èáè„Éô„ÇØ„Éà„É´„ÇíÂæó„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ
ÊúÄÂæå„Å´„ÄÅ„Ç®„ÉÉ„Ç∏ÈõÜÁ¥Ñ„Çπ„ÉÜ„ÉÉ„Éó„Åß„Åì„Çå„Çâ„ÅÆ„Ç®„ÉÉ„Ç∏ÁâπÂæ¥Èáè„ÇíÂêàË®à„Åó„Åæ„Åô„ÄÇ</p>
<div class="amsmath math notranslate nohighlight" id="equation-f268bbd4-f74a-4593-a22d-f03675524f4b">
<span class="eqno">(14.8)<a class="headerlink" href="#equation-f268bbd4-f74a-4593-a22d-f03675524f4b" title="Permalink to this equation">¬∂</a></span>\[\begin{equation}
\bar{e}^{'}_i = \rho^{e\rightarrow v}\left( E_i^{'}\right) = \sum E_i^{'}
\end{equation}\]</div>
<p>Zhang„Çâ<span id="id25">[<a class="reference internal" href="gnn.html#id84" title="Jiani Zhang, Xingjian Shi, Junyuan Xie, Hao Ma, Irwin King, and Dit-Yan Yeung. Gaan: gated attention networks for learning on large and spatiotemporal graphs. arXiv preprint arXiv:1803.07294, 2018.">ZSX+18</a>]</span>„Åß„ÅØ„ÄÅ„Éû„É´„ÉÅ„Éò„ÉÉ„Éâ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„ÇÇ‰ΩøÁî®„Åó„Å¶„ÅÑ„Åæ„Åó„Åü„ÄÇ
„Éû„É´„ÉÅ„Éò„ÉÉ„Éâ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„ÅØ„Å©„ÅÆ„Çà„ÅÜ„Å´Ê©üËÉΩ„Åô„Çã„ÅÆ„Åß„Åó„Çá„ÅÜ„ÅãÔºü</p>
<p>„Ç®„ÉÉ„Ç∏ÁâπÂæ¥ÈáèË°åÂàó <span class="math notranslate nohighlight">\(E_i^{'}\)</span> „ÅØËª∏0„Åå„Ç®„ÉÉ„Ç∏Ôºà<span class="math notranslate nohighlight">\(k\)</span>Ôºâ„ÄÅËª∏1„ÅåÁâπÂæ¥Èáè„ÄÅËª∏2„Åå„Éò„ÉÉ„Éâ„ÅÆ„Ç®„ÉÉ„Ç∏ÁâπÂæ¥Èáè„ÉÜ„É≥„ÇΩ„É´„Å´„Å™„Çä„Åæ„Åô„ÄÇ„Äå„Éò„ÉÉ„Éâ„Äç„ÅØÂçò„Å´ <span class="math notranslate nohighlight">\(\mathbf{W}^h_q, \mathbf{W}^h_k, \mathbf{W}^h_v\)</span> „ÅÆ„Å©„ÅÆÈõÜÂêà„Çí‰Ωø„Å£„Åü„Åã„ÇíÊÑèÂë≥„Åó„Å¶„ÅÑ„Çã„Åì„Å®„ÇíÊÄù„ÅÑÂá∫„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
„ÉÜ„É≥„ÇΩ„É´„ÇíÊúüÂæÖ„Åï„Çå„ÇãË°åÂàó„Å´Êàª„Åô„Åü„ÇÅ„Å´„ÅØ„ÄÅÂçòÁ¥î„Å´ÊúÄÂæå„ÅÆ2Ëª∏ÔºàÁâπÂæ¥Èáè„ÄÅ„Éò„ÉÉ„ÉâÔºâ„ÇíÁâπÂæ¥Èáè„Å´„Éû„ÉÉ„Éó„Åô„ÇãÈáç„ÅøË°åÂàó„ÇíÁî®„ÅÑ„Çå„Å∞ËâØ„ÅÑ„Åß„Åô„ÄÇ</p>
<p>„Çè„Åã„Çä„ÇÑ„Åô„Åï„ÅÆ„Åü„ÇÅ„ÄÅ„Ç§„É≥„Éá„ÉÉ„ÇØ„Çπ„ÇíÊòéÁ§∫ÁöÑ„Å´Êõ∏„ÅçÂá∫„Åó„Åæ„Åó„Çá„ÅÜÔºö</p>
<div class="amsmath math notranslate nohighlight" id="equation-21b15298-7b6e-4a28-8059-17c57a043dee">
<span class="eqno">(14.9)<a class="headerlink" href="#equation-21b15298-7b6e-4a28-8059-17c57a043dee" title="Permalink to this equation">¬∂</a></span>\[\begin{equation}
\bar{e}^{'}_{il} = \rho^{e\rightarrow v}\left( E_i^{'}\right) = \sum_k e_{ikjh}^{'}w_{jhl}
\end{equation}\]</div>
<p>„Åì„Åì„Åß„ÄÅ <span class="math notranslate nohighlight">\(j\)</span> „ÅØ„Ç®„ÉÉ„Ç∏ÁâπÂæ¥Èáè„ÅÆÂÖ•Âäõ„Ç§„É≥„Éá„ÉÉ„ÇØ„Çπ„ÄÅ<span class="math notranslate nohighlight">\(l\)</span> „ÅØÂá∫Âäõ„Ç®„ÉÉ„Ç∏ÁâπÂæ¥ÈáèË°åÂàó„Åß„ÄÅ<span class="math notranslate nohighlight">\(k,h,i\)</span> „ÅØ‰ª•Ââç„Å®ÂêåÊßò„ÅÆÂÆöÁæ©„Å®„Åó„Åæ„Åô„ÄÇ<strong>„Éà„É©„É≥„Çπ„Éï„Ç©„Éº„Éû„Éº</strong>„ÅØ„Éû„É´„ÉÅ„Éò„ÉÉ„Éâ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„ÅßÊßãÁØâ„Åï„Çå„Åü„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„ÅÆÂà•Âêç„Å™„ÅÆ„Åß„ÄÅ„Éà„É©„É≥„Çπ„Éï„Ç©„Éº„Éû„Éº„Ç∞„É©„Éï„Éã„É•„Éº„É©„É´„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„ÇÇË¶ã„Åã„Åë„Çã„Åì„Å®„Åå„ÅÇ„Çã„Åß„Åó„Çá„ÅÜÔºà<span id="id26">[<a class="reference internal" href="#id104" title="≈Åukasz Maziarka, Tomasz Danel, S≈Çawomir Mucha, Krzysztof Rataj, Jacek Tabor, and Stanis≈Çaw Jastrzƒôbski. Molecule attention transformer. arXiv preprint arXiv:2002.08264, 2020.">MDM+20</a>]</span>Ôºâ„ÄÇ</p>
<section id="id27">
<h2><span class="section-number">14.1. </span>Á´†„ÅÆ„Åæ„Å®„ÇÅ<a class="headerlink" href="#id27" title="Permalink to this headline">¬∂</a></h2>
<ul class="simple">
<li><p>„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„É¨„Ç§„É§„Éº„ÅØ‰∫∫Èñì„ÅÆÊ≥®ÊÑèÊ©üÊßã„Å´„Éí„É≥„Éà„ÇíÂæó„Å¶„ÅÑ„Çã„Åå„ÄÅÂü∫Êú¨ÁöÑ„Å´„ÅØÂä†ÈáçÂπ≥Âùá„Å´„Çà„ÇãÈõÜÁ¥Ñ„Åß„ÅÇ„Çã„ÄÇ</p></li>
<li><p>„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„É¨„Ç§„É§„Éº„ÅØ„ÇØ„Ç®„É™„Éº„ÄÅ„Éê„É™„É•„Éº„ÄÅ„Ç≠„Éº„ÅÆ3„Å§„ÅÆÂÖ•Âäõ„Çí„Å®„Çã„ÄÇ„Åì„Çå„Çâ„ÅÆÂÖ•Âäõ„ÅØ„Åó„Å∞„Åó„Å∞Âêå‰∏Ä„Åß„ÄÅ„ÇØ„Ç®„É™„ÅØ„Ç≠„Éº„ÅÆÔºë„Å§„Åß„ÅÇ„Çä„ÄÅ„Ç≠„Éº„Å®„Éê„É™„É•„Éº„ÅØÁ≠â„Åó„ÅÑ„ÄÇ</p></li>
<li><p>Ë®ÄË™û„ÅÆ„Çà„ÅÜ„Å™Á≥ªÂàó„É¢„Éá„É™„É≥„Ç∞„Å´Âêë„ÅÑ„Å¶„ÅÑ„Çã„ÄÇ</p></li>
<li><p>„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„Éô„ÇØ„Éà„É´„ÅØÊ≠£Ë¶èÂåñ„Åï„Çå„Å¶„ÅÑ„ÇãÂøÖË¶Å„Åå„ÅÇ„Çã„ÄÇ„ÇΩ„Éï„Éà„Éû„ÉÉ„ÇØ„ÇπÈñ¢Êï∞„ÅßÊ≠£Ë¶èÂåñ„ÇíÂÆüÁèæ„Åß„Åç„Çã„Åå„ÄÅ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥Ê©üÊßãÂºè„ÅØ„Éè„Ç§„Éë„Éº„Éë„É©„É°„Éº„Çø„Åß„ÅÇ„Çã„ÄÇ</p></li>
<li><p>„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„É¨„Ç§„É§„Éº„ÅØ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥Ê©üÊßã„Åß„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„Éô„ÇØ„Éà„É´„ÇíË®àÁÆó„Åô„Çã„ÄÅ„Åù„Åó„Å¶„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥Âä†ÈáçÂπ≥Âùá„ÇíË®àÁÆó„Åô„Çã„Åì„Å®„Åß„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„Éô„ÇØ„Éà„É´„ÅÆÈõÜÁ¥Ñ„ÇíË°å„ÅÜ„ÄÇ</p></li>
<li><p>„Éè„Éº„Éâ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥Ôºà„Éè„Éº„Éâ„Éû„ÉÉ„ÇØ„ÇπÈñ¢Êï∞Ôºâ„ÇíÁî®„ÅÑ„Çã„Å®„ÄÅ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥Ê©üÊßã„ÅÆÊúÄÂ§ßÂá∫Âäõ„ÇíËøî„Åô„ÄÇ</p></li>
<li><p>„ÇΩ„Éï„Éà„Éû„ÉÉ„ÇØ„ÇπÂæå„ÅÆ„ÉÜ„É≥„ÇΩ„É´„Éâ„ÉÉ„Éà„ÅØ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥Ê©üÊßã„Åß„ÇÇ„Å£„Å®„ÇÇ‰∏ÄËà¨ÁöÑ„Åß„ÅÇ„Çã„ÄÇ</p></li>
<li><p>„Çª„É´„Éï„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„ÅØ„ÇØ„Ç®„É™„Éº„ÄÅ„Éê„É™„É•„Éº„ÄÅ„Ç≠„Éº„ÅåÂÖ®„Å¶Á≠â„Åó„ÅÑ„Å®„Åç„Å´ÈÅîÊàê„Åï„Çå„Çã„ÄÇ</p></li>
<li><p>„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„É¨„Ç§„É§„Éº„Åù„ÅÆ„ÇÇ„ÅÆ„ÅØÂ≠¶Áøí„Åß„Åç„Å™„ÅÑ„ÄÇ</p></li>
<li><p>„Éû„É´„ÉÅ„Éò„ÉÉ„Éâ„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„Éñ„É≠„ÉÉ„ÇØ„ÅØË§áÊï∞‰∏¶Âàó„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„Å´ÂàÜÂâ≤ÂèØËÉΩ„Å™„É¨„Ç§„É§„Éº„ÅÆ„Ç∞„É´„Éº„Éó„Åß„ÅÇ„Çã„ÄÇ</p></li>
</ul>
</section>
<section id="id28">
<h2><span class="section-number">14.2. </span>ÂºïÁî®ÊñáÁåÆ<a class="headerlink" href="#id28" title="Permalink to this headline">¬∂</a></h2>
<div class="docutils container" id="id29">
<dl class="citation">
<dt class="label" id="id68"><span class="brackets"><a class="fn-backref" href="#id23">BHB+18</a></span></dt>
<dd><p>Peter¬†W Battaglia, Jessica¬†B Hamrick, Victor Bapst, Alvaro Sanchez-Gonzalez, Vinicius Zambaldi, Mateusz Malinowski, Andrea Tacchetti, David Raposo, Adam Santoro, Ryan Faulkner, and others. Relational inductive biases, deep learning, and graph networks. <em>arXiv preprint arXiv:1806.01261</em>, 2018.</p>
</dd>
<dt class="label" id="id74"><span class="brackets">ZSX+18</span><span class="fn-backref">(<a href="#id24">1</a>,<a href="#id25">2</a>)</span></dt>
<dd><p>Jiani Zhang, Xingjian Shi, Junyuan Xie, Hao Ma, Irwin King, and Dit-Yan Yeung. Gaan: gated attention networks for learning on large and spatiotemporal graphs. <em>arXiv preprint arXiv:1803.07294</em>, 2018.</p>
</dd>
<dt class="label" id="id76"><span class="brackets">BP97</span><span class="fn-backref">(<a href="#id2">1</a>,<a href="#id3">2</a>)</span></dt>
<dd><p>Shumeet Baluja and Dean¬†A. Pomerleau. Expectation-based selective attention for visual monitoring and control of a robot vehicle. <em>Robotics and Autonomous Systems</em>, 22(3):329‚Äì344, 1997. Robot Learning: The New Wave. URL: <a class="reference external" href="http://www.sciencedirect.com/science/article/pii/S0921889097000468">http://www.sciencedirect.com/science/article/pii/S0921889097000468</a>, <a class="reference external" href="https://doi.org/https://doi.org/10.1016/S0921-8890(97)00046-8">doi:https://doi.org/10.1016/S0921-8890(97)00046-8</a>.</p>
</dd>
<dt class="label" id="id73"><span class="brackets">LPM15</span><span class="fn-backref">(<a href="#id4">1</a>,<a href="#id10">2</a>)</span></dt>
<dd><p>Minh-Thang Luong, Hieu Pham, and Christopher¬†D Manning. Effective approaches to attention-based neural machine translation. <em>arXiv preprint arXiv:1508.04025</em>, 2015.</p>
</dd>
<dt class="label" id="id72"><span class="brackets"><a class="fn-backref" href="#id5">VSP+17</a></span></dt>
<dd><p>Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan¬†N Gomez, ≈Åukasz Kaiser, and Illia Polosukhin. Attention is all you need. In <em>Advances in neural information processing systems</em>, 5998‚Äì6008. 2017.</p>
</dd>
<dt class="label" id="id104"><span class="brackets"><a class="fn-backref" href="#id26">MDM+20</a></span></dt>
<dd><p>≈Åukasz Maziarka, Tomasz Danel, S≈Çawomir Mucha, Krzysztof Rataj, Jacek Tabor, and Stanis≈Çaw Jastrzƒôbski. Molecule attention transformer. <em>arXiv preprint arXiv:2002.08264</em>, 2020.</p>
</dd>
</dl>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./dl"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="xai.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">12. </span>‰∫àÊ∏¨„ÇíË™¨Êòé„Åô„Çã</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="NLP.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">15. </span>Deep Learning on Sequences</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Andrew D. White<br/>
    
        &copy; Copyright 2022.<br/>
      <div class="extra_footer">
        <a href="http://thewhitelab.org">thewhitelab.org</a> <div id="wh-modal"> <button class="wh-venti-button" aria-label="close modal" id="wh-modal-close">‚úï</button> <img id="wh-modal-img"> </div>
      </div>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>