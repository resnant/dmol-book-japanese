
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<meta content="Deep Learning for Molecules &amp; Materials Book" lang="en" name="description" xml:lang="en" />
<meta content="en_US" property="og:locale" />
<meta content="summary" name="twitter:card" />
<meta content="Deep Learning for Molecules &amp; Materials Book" name="twitter:description" />
<meta content="dmol.pub üìñ" name="twitter:title" />
<meta content="https://dmol.pub/_static/logo.png" name="twitter:image" />
<meta content="&#64;andrewwhite01" name="twitter:site" />

    <title>12. ‰∫àÊ∏¨„ÇíË™¨Êòé„Åô„Çã &#8212; deep learning for molecules &amp; materials</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/a11y.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/custom.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="canonical" href="https://resnant.github.io/dmol-book-japanese/dl/xai.html" />
    <link rel="shortcut icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="13. „Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„É¨„Ç§„É§„Éº" href="attention.html" />
    <link rel="prev" title="11. Modern Molecular NNs" href="molnets.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">deep learning for molecules & materials</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   „Åì„ÅÆÊú¨„ÅÆÊ¶ÇË¶Å
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  A. Math Review
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../math/tensors-and-shapes.html">
   1. Tensors and Shapes
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  B. Machine Learning
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../ml/introduction.html">
   2. Ê©üÊ¢∞Â≠¶ÁøíÂÖ•ÈñÄ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ml/regression.html">
   3. Regression &amp; Model Assessment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ml/classification.html">
   4. Classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ml/kernel.html">
   5. „Ç´„Éº„Éç„É´Â≠¶Áøí
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  C. Deep Learning
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="introduction.html">
   6. „Éá„Ç£„Éº„Éó„É©„Éº„Éã„É≥„Ç∞„ÅÆÊ¶ÇË¶Å
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="layers.html">
   7. Standard Layers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="gnn.html">
   8. Graph Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data.html">
   9. Input Data &amp; Equivariances
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Equivariant.html">
   10. Equivariant Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="molnets.html">
   11. Modern Molecular NNs
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   12. ‰∫àÊ∏¨„ÇíË™¨Êòé„Åô„Çã
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="attention.html">
   13. „Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„É¨„Ç§„É§„Éº
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="NLP.html">
   15. Deep Learning on Sequences
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="VAE.html">
   16. Variational Autoencoder
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="flows.html">
   17. Normalizing Flows
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  D. Applications
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../applied/QM9.html">
   18. GNN„Å´„Çà„ÇãDFT„Ç®„Éç„É´„ÇÆ„Éº„ÅÆ‰∫àÊ∏¨
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../applied/MolGenerator.html">
   19. Generative RNN in Browser
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  E. Contributed Chapters
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Hyperparameter_tuning.html">
   20. Hyperparameter Tuning
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  F. Appendix
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../style.html">
   21. Style Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../changelog.html">
   22. Changelog
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  <script async defer src="https://api.dmol.pub/latest.js"></script><noscript><img src="https://api.dmol.pub/noscript.gif" alt="" referrerpolicy="no-referrer-when-downgrade" /></noscript> By <a href="https://twitter.com/andrewwhite01">Andrew White</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/dl/xai.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/resnant/dmol-book-japanese/"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/resnant/dmol-book-japanese//issues/new?title=Issue%20on%20page%20%2Fdl/xai.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/resnant/dmol-book-japanese/blob/master/dl/xai.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id7">
   12.1. Ë™¨Êòé„Å®„ÅØ‰Ωï„Åã
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id19">
   12.2. ÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id20">
     12.2.1. „Éã„É•„Éº„É©„É´„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„ÅÆÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id27">
     12.2.2. „Ç∑„É£„Éº„Éó„É¨„Ç§ÂÄ§
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#notebook">
   12.3. Notebook„ÅÆÂÆüË°å
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id31">
   12.4. ÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶„ÅÆ‰æã
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id33">
     12.4.1. ÂãæÈÖç
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#integrated-gradients">
     12.4.2. Integrated Gradients
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#smoothgrad">
     12.4.3. SmoothGrad
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id35">
     12.4.4. „Ç∑„É£„Éº„Éó„É¨„Ç§ÂÄ§
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id37">
   12.5. ÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶„ÅØ‰Ωï„ÅÆ„Åü„ÇÅ„Å´„ÅÇ„Çã„ÅÆ„ÅãÔºü
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id41">
   12.6. Â≠¶Áøí„Éá„Éº„Çø„ÅÆÈáçË¶ÅÂ∫¶
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id43">
   12.7. „Çµ„É≠„Ç≤„Éº„Éà„É¢„Éá„É´
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id46">
   12.8. ÂèçÂÆü‰ªÆÊÉ≥
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id51">
     12.8.1. ‰æã
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id52">
   12.9. ÁâπÂÆö„ÅÆ„Ç¢„Éº„Ç≠„ÉÜ„ÇØ„ÉÅ„É£„ÅÆË™¨Êòé
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id56">
   12.10. „É¢„Éá„É´Èùû‰æùÂ≠òÁöÑ„Å™ÂàÜÂ≠ê„ÅÆÂèçÂÆü‰ªÆÊÉ≥„ÅÆË™¨Êòé
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id59">
   12.11. Notebook„ÅÆÂÆüË°å
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id61">
   12.12. „Åæ„Å®„ÇÅ
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cited-references">
   12.13. Cited References
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>‰∫àÊ∏¨„ÇíË™¨Êòé„Åô„Çã</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id7">
   12.1. Ë™¨Êòé„Å®„ÅØ‰Ωï„Åã
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id19">
   12.2. ÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id20">
     12.2.1. „Éã„É•„Éº„É©„É´„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„ÅÆÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id27">
     12.2.2. „Ç∑„É£„Éº„Éó„É¨„Ç§ÂÄ§
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#notebook">
   12.3. Notebook„ÅÆÂÆüË°å
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id31">
   12.4. ÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶„ÅÆ‰æã
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id33">
     12.4.1. ÂãæÈÖç
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#integrated-gradients">
     12.4.2. Integrated Gradients
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#smoothgrad">
     12.4.3. SmoothGrad
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id35">
     12.4.4. „Ç∑„É£„Éº„Éó„É¨„Ç§ÂÄ§
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id37">
   12.5. ÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶„ÅØ‰Ωï„ÅÆ„Åü„ÇÅ„Å´„ÅÇ„Çã„ÅÆ„ÅãÔºü
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id41">
   12.6. Â≠¶Áøí„Éá„Éº„Çø„ÅÆÈáçË¶ÅÂ∫¶
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id43">
   12.7. „Çµ„É≠„Ç≤„Éº„Éà„É¢„Éá„É´
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id46">
   12.8. ÂèçÂÆü‰ªÆÊÉ≥
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id51">
     12.8.1. ‰æã
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id52">
   12.9. ÁâπÂÆö„ÅÆ„Ç¢„Éº„Ç≠„ÉÜ„ÇØ„ÉÅ„É£„ÅÆË™¨Êòé
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id56">
   12.10. „É¢„Éá„É´Èùû‰æùÂ≠òÁöÑ„Å™ÂàÜÂ≠ê„ÅÆÂèçÂÆü‰ªÆÊÉ≥„ÅÆË™¨Êòé
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id59">
   12.11. Notebook„ÅÆÂÆüË°å
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id61">
   12.12. „Åæ„Å®„ÇÅ
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cited-references">
   12.13. Cited References
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1><span class="section-number">12. </span>‰∫àÊ∏¨„ÇíË™¨Êòé„Åô„Çã<a class="headerlink" href="#id1" title="Permalink to this headline">¬∂</a></h1>
<p>„Éã„É•„Éº„É©„É´„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„ÅÆ‰∫àÊ∏¨„ÅØ‰∏ÄËà¨„Å´Ëß£ÈáàÂèØËÉΩ„Åß„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ„Åì„ÅÆÁ´†„Åß„ÅØ„Åù„ÅÆ‰∫àÊ∏¨„ÇíË™¨Êòé„Åô„ÇãÊñπÊ≥ï„ÇíÊé¢„Çä„Åæ„Åô„ÄÇ„Åì„Çå„ÅØË™¨ÊòéÂèØËÉΩ„Å™AIÔºàXAIÔºâ„Å®„ÅÑ„ÅÜÂ∫ÉÁØÑ„Å™„Éà„Éî„ÉÉ„ÇØ„ÅÆ‰∏ÄÈÉ®„Åß„ÅÇ„Çä„ÄÅ„Å™„ÅúÁâπÂÆö„ÅÆ‰∫àÊ∏¨„Åå„Å™„Åï„Çå„Çã„ÅÆ„Åã„ÇíÁêÜËß£„Åô„Çã„Å´„ÅÆÂΩπÁ´ã„Å§„ÅØ„Åö„Åß„Åô„ÄÇ„É¢„Éá„É´„ÅÆ‰∫àÊ∏¨„ÇíÁêÜËß£„Åß„Åç„Çã„Çà„ÅÜ„Å´„Å™„Çå„Å∞„ÄÅÂÆüÁî®ÁöÑ„ÄÅÁêÜË´ñÁöÑ„ÄÅ„Åã„Å§Ë¶èÂà∂„ÅÆË¶≥ÁÇπ„ÅßÊ≠£ÂΩìÂåñ„Åô„Çã„Åì„Å®„Å´„Å§„Å™„Åå„Çä„Åæ„Åô„ÄÇ„Åù„ÅÆ„Åü„ÇÅÈáçË¶Å„Å™„Éà„Éî„ÉÉ„ÇØ„Å®„Å™„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇ„Åæ„Åü„Åù„ÅÆÊ†πÊã†„ÇíÁêÜËß£„Åß„Åç„Çå„Å∞„ÄÅ„É¢„Éá„É´„ÅÆ‰∫àÊ∏¨„ÇíÂà©Áî®„Åô„ÇãÂèØËÉΩÊÄß„ÅåÈ´ò„Åè„Å™„Çã„Åì„Å®„ÅåÁ§∫„Åï„Çå„Å¶„Åä„Çä<span id="id2">[<a class="reference internal" href="#id190" title="John D Lee and Katrina A See. Trust in automation: designing for appropriate reliance. Human factors, 46(1):50‚Äì80, 2004.">LS04</a>]</span>„ÄÅÁ¢∫„Åã„Å´ÂÆüÁî®ÁöÑ„Åß„Åô„ÄÇ„ÇÇ„ÅÜ‰∏Ä„Å§„ÅÆÂÆüÁî®ÁöÑ„Å™Èñ¢ÂøÉ‰∫ã„ÅØ„ÄÅ„É¢„Éá„É´„Åå„Å©„ÅÆ„Çà„ÅÜ„Å´„Åù„ÅÆ‰∫àÊ∏¨„Å´Ëá≥„Å£„Åü„ÅÆ„Åã„ÇíÁêÜËß£„Åß„Åç„Çå„Å∞„ÄÅÊñπÊ≥ï„ÇíÊ≠£Á¢∫„Å´ÂÆüË£Ö„Åô„Çã„Åì„Å®„Åå„ÅØ„Çã„Åã„Å´ÂÆπÊòì„Å´„Å™„Çã„Å®„ÅÑ„ÅÜ„Åì„Å®„Åß„Åô„ÄÇÈÄèÊòéÊÄß„ÅÆÁêÜË´ñÁöÑ„Å™Ê≠£ÂΩìÊÄß„ÅØ„ÄÅ„É¢„Éá„É´„Éâ„É°„Ç§„É≥„ÅÆ‰∏çÂÆåÂÖ®ÊÄßÔºà„Åô„Å™„Çè„Å°„ÄÅÂÖ±Â§âÈáè„Ç∑„Éï„ÉàÔºâ<span id="id3">[<a class="reference internal" href="#id189" title="Finale Doshi-Velez and Been Kim. Towards a rigorous science of interpretable machine learning. arXiv preprint arXiv:1702.08608, 2017.">DVK17</a>]</span>„ÇíË≠òÂà•„Åô„Çã„ÅÆ„Å´ÂΩπÁ´ã„Å°„Åæ„Åô„ÄÇÊúÄËøë„ÄÅÊ¨ßÂ∑ûÈÄ£Âêà<span id="id4">[<a class="reference internal" href="#id198" title="Bryce Goodman and Seth Flaxman. European Union regulations on algorithmic decision-making and a ‚Äúright to explanation‚Äù. AI Magazine, 38(3):50‚Äì57, 2017.">GF17</a>]</span>„Å®G20<span id="id5">[<a class="reference internal" href="#id199" title="Organisation for Economic Co-operation and Development. Recommendation of the Council on Artificial Intelligence. 2019. URL: https://legalinstruments.oecd.org/en/instruments/OECD-LEGAL-0449.">Dev19</a>]</span>„ÅØ„ÄÅÊ©üÊ¢∞‰∫àÊ∏¨„Å´Èñ¢„Åô„ÇãË™¨Êòé„ÇíÊé®Â•®„Åæ„Åü„ÅØË¶ÅÊ±Ç„Åô„Çã„Ç¨„Ç§„Éâ„É©„Ç§„É≥„ÇíÊé°Êäû„Åó„Åæ„Åó„Åü„ÄÇ„Åù„ÅÆ„Åü„ÇÅ„ÄÅ„Åì„Çå„ÅØÁèæÂú®„ÄÅ„Ç≥„É≥„Éó„É©„Ç§„Ç¢„É≥„Çπ„ÅÆÂïèÈ°å„Å´„Å™„Å£„Å¶„Åç„Å¶„ÅÑ„Åæ„Åô„ÄÇÊ¨ßÂ∑ûÈÄ£Âêà„ÅØ„Åï„Çâ„Å´Ë∏è„ÅøËæº„Çì„Åß„ÄÅ„Çà„Çä<a class="reference external" href="https://digital-strategy.ec.europa.eu/en/library/proposal-regulation-laying-down-harmonised-rules-artificial-intelligence-artificial-intelligence">Âé≥„Åó„ÅÑÊ≥ïÂæãÊ°à</a>„ÇíÊ§úË®é„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ</p>
<div class="admonition- admonition">
<p class="admonition-title">Ë™≠ËÄÖÂ±§„Å®ÁõÆÁöÑ</p>
<p>„Åì„ÅÆÁ´†„ÅØ<a class="reference internal" href="layers.html"><span class="doc">Standard Layers</span></a>„Å®<a class="reference internal" href="NLP.html"><span class="doc">Deep Learning on Sequences</span></a>„Å´Âü∫„Å•„ÅÑ„Å¶„ÅÑ„Åæ„Åô„ÄÇ„Åæ„Åü„ÄÅÊù°‰ª∂‰ªò„ÅçÁ¢∫Áéá„ÇíÂê´„ÇÄÁ¢∫ÁéáË´ñ„Å´Èñ¢„Åô„ÇãÂçÅÂàÜ„Å™Áü•Ë≠ò„Åå„ÅÇ„Çã„Åì„Å®„ÇíÂâçÊèê„Å®„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ„Åù„ÅÜ„Åß„Å™„ÅÑÂ†¥Âêà„ÅØ„ÄÅ<a class="reference external" href="https://raw.githubusercontent.com/whitead/numerical_stats/master/unit_2/lectures/lecture_3.pdf">ÁßÅ„ÅÆ„Éé„Éº„Éà</a>„ÇÑÂÖ•ÈñÄÁöÑ„Å™Á¢∫Áéá„ÅÆ„ÉÜ„Ç≠„Çπ„Éà„ÇíË™≠„Çì„ÅßÊ¶ÇË¶Å„ÇíÁêÜËß£„Åô„Çã„Åì„Å®„Çí„ÅäÂãß„ÇÅ„Åó„Åæ„Åô„ÄÇ„Åì„ÅÆÁ´†„ÇíË™≠„ÇÄ„Å®„ÄÅ‰ª•‰∏ã„ÅÆ„Åì„Å®„Åå„Åß„Åç„Çã„Çà„ÅÜ„Å´„Å™„Çã„Å®ÊÉ≥ÂÆö„Åï„Çå„Åæ„Åô„ÄÇ</p>
<ul class="simple">
<li><p>„Å™„ÅúË™¨Êòé„ÅåÈáçË¶Å„Åã„ÇíÊ≠£ÂΩìÂåñ„Åß„Åç„Çã</p></li>
<li><p>Ê≠£ÂΩìÂåñ„ÄÅËß£Èáà„ÄÅË™¨Êòé„ÅÆÂå∫Âà•„Åå„Åß„Åç„Çã</p></li>
<li><p>ÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶„Å®„Ç∑„É£„Éº„Éó„É¨„Ç§ÂÄ§„ÇíË®àÁÆó„Åß„Åç„Çã</p></li>
<li><p>ÂèçÂÆü‰ªÆÊÉ≥„ÇíÂÆöÁæ©„Åó„ÄÅ„Åù„Çå„ÇíË®àÁÆó„Åß„Åç„Çã</p></li>
<li><p>„Å©„ÅÆ„É¢„Éá„É´„ÅåËß£ÈáàÂèØËÉΩ„Åß„ÄÅ„Å©„ÅÆ„Çà„ÅÜ„Å´Ëß£ÈáàÂèØËÉΩ„Å™„Çµ„É≠„Ç≤„Éº„Éà„É¢„Éá„É´„ÇíÈÅ©Âêà„Åï„Åõ„Çã„Åã„ÇíÁêÜËß£„Åô„Çã</p></li>
</ul>
</div>
<p>Ë™¨ÊòéÂèØËÉΩ„Å™AI„ÅÆÂøÖË¶ÅÊÄß„Å´Èñ¢„Åô„ÇãÊúâÂêç„Å™‰æã„Å®„Åó„Å¶„ÄÅËÇ∫ÁÇé„ÅßER„Å´ÈÅã„Å∞„Çå„ÅüÊÇ£ËÄÖ„ÅÆÊ≠ª‰∫°„É™„Çπ„ÇØ„ÇíË©ï‰æ°„Åô„ÇãML‰∫àÊ∏¨Âô®„ÇíÊßãÁØâ„Åó„ÅüCaruana„Çâ„ÅÆ<span id="id6">[<a class="reference internal" href="#id191" title="Rich Caruana, Yin Lou, Johannes Gehrke, Paul Koch, Marc Sturm, and Noemie Elhadad. Intelligible models for healthcare: Predicting pneumonia risk and hospital 30-day readmission. In Proceedings of the 21th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining, 1721‚Äì1730. ACM, 2015.">CLG+15</a>]</span>„ÅåÊåô„Åí„Çâ„Çå„Åæ„Åô„ÄÇ„Åì„ÅÆË´ñÊñá„ÅÆ„Ç¢„Ç§„Éá„Ç¢„ÅØ„ÄÅËÇ∫ÁÇé„ÅÆÊÇ£ËÄÖ„Çí„Åì„ÅÆ„ÉÑ„Éº„É´„Åß„Çπ„ÇØ„É™„Éº„Éã„É≥„Ç∞„Åô„Çå„Å∞„ÄÅÂåªÂ∏´„Åå„Å©„ÅÆÊÇ£ËÄÖ„Åå„Çà„ÇäÊ≠ª‰∫°„É™„Çπ„ÇØ„ÅåÈ´ò„ÅÑ„Åã„ÇíÁü•„Çã„ÅÆ„Å´ÂΩπÁ´ã„Å§„Å®„ÅÑ„ÅÜ„ÇÇ„ÅÆ„Åß„Åó„Åü„ÄÇ„Åù„ÅÆ„É¢„Éá„É´„ÅØ„Åã„Å™„ÇäÊ≠£Á¢∫„Åß„Åó„Åü„Åå„ÄÅ„Åù„ÅÆ‰∫àÊ∏¨„ÅÆËß£Èáà„ÇíË™ø„Åπ„Åü„Å®„Åì„Çç„ÄÅÂåªÂ≠¶ÁöÑ„Å´„Åä„Åã„Åó„Å™Êé®Ë´ñ„Åå„Å™„Åï„Çå„Å¶„ÅÑ„Åæ„Åó„Åü„ÄÇÈ©ö„Åè„Åπ„Åç„Åì„Å®„Å´„ÄÅ„Åù„ÅÆ„É¢„Éá„É´„ÅØÂñòÊÅØÊåÅ„Å°„ÅÆÊÇ£ËÄÖÔºàÂñòÊÅØÊÇ£ËÄÖ„Å®„ÅÑ„ÅÜÔºâ„ÅåËÇ∫ÁÇé„ÅßER„Å´Êù•Èô¢„Åó„ÅüÂ†¥Âêà„ÄÅÊ≠ª‰∫°„É™„Çπ„ÇØ„Åå‰Ωé‰∏ã„Åô„Çã„Åì„Å®„ÇíÁ§∫ÂîÜ„Åó„Å¶„ÅÑ„Åæ„Åó„Åü„ÄÇÂñòÊÅØ„Å®„ÅÑ„ÅÜ„ÅÆ„ÅØÂëºÂê∏„ÅåÂõ∞Èõ£„Å´„Å™„ÇãÁóÖÊ∞ó„Åß„ÅÇ„Çã„Å´„ÇÇÈñ¢„Çè„Çâ„Åö„ÄÅ<em>ËÇ∫ÁÇéÊÇ£ËÄÖ„ÅÆÊ≠ª‰∫°Áéá„Åå‰Ωé„Åè„Å™„Çã</em>„Å®„ÅÑ„ÅÜ„Åì„Å®„Åå„Çè„Åã„Å£„Åü„ÅÆ„Åß„Åô„ÄÇ</p>
<p>„Åì„ÅÆÁµêÊûú„ÅØÂÅ∂Áô∫ÁöÑ„Å™„ÇÇ„ÅÆ„Åß„Åó„Åü„ÄÇÂñòÊÅØ„ÅØÂÆüÈöõ„Å´„ÅØËÇ∫ÁÇé„Åß„ÅÆÊ≠ª‰∫°„É™„Çπ„ÇØ„ÅåÈ´ò„ÅÑ„ÅÆ„Åß„Åô„Åå„ÄÅÂåªÂ∏´„ÅØ„Åù„ÅÆ„Åì„Å®„ÇíÂÆüÊÑü„Åó„Å¶„ÅÑ„Çã„Åü„ÇÅ„ÄÅÂΩº„Çâ„Å´ÂØæ„Åó„Å¶„Çà„ÇäÁ©çÊ•µÁöÑ„Åß‰∏ÅÂØß„Å™ÂØæÂøú„Çí„Åó„Å¶„ÅÑ„Åü„ÅÆ„Åß„Åô„ÄÇ„Åô„Å™„Çè„Å°„ÄÅÂñòÊÅØÊÇ£ËÄÖ„Å´ÂØæ„Åó„Å¶ÂåªÂ∏´„Åå„Çà„Çä‰∏ÅÂØß„Å™„Ç±„Ç¢„Å®ÈÖçÊÖÆ„Çí„Åó„Å¶„ÅÑ„Åü„Åü„ÇÅ„ÄÅÊ≠ª‰∫°ËÄÖÊï∞„ÅåÂ∞ë„Å™„Åè„Å™„Å£„Å¶„ÅÑ„Åü„ÅÆ„Åß„Åô„ÄÇÁµåÈ®ìÂâá„Åã„ÇâË®Ä„Åà„Å∞„ÄÅ„É¢„Éá„É´„ÅÆ‰∫àÊ∏¨„ÅØÊ≠£„Åó„ÅÑ„Åß„Åô„ÄÇ„Åó„Åã„Åó„ÄÅ„ÇÇ„Åó„Åì„ÅÆ„É¢„Éá„É´„ÅåÂÆüÁî®Âåñ„Åï„Çå„Çå„Å∞„ÄÅÂñòÊÅØÊÇ£ËÄÖ„ÇíÊ≠ª‰∫°„É™„Çπ„ÇØ„Åå‰Ωé„ÅÑ„Å®Ë™§„Å£„Å¶Âà§Êñ≠„Åó„ÄÅÂñòÊÅØÊÇ£ËÄÖ„ÅØÊú¨Êù•Âèó„Åë„Çâ„Çå„Åü„ÅØ„Åö„ÅÆ„Ç±„Ç¢„ÇíÂèó„Åë„Çâ„Çå„Åö„Å´ÂëΩ„ÇíËêΩ„Å®„ÅôÂèØËÉΩÊÄß„Åå„ÅÇ„Çä„Åæ„Åó„Åü„ÄÇÂπ∏„ÅÑ„Å´„ÇÇÁ†îÁ©∂ËÄÖ„ÅØ„É¢„Éá„É´„ÅÆËß£ÈáàÂèØËÉΩÊÄß„Å´„Çà„Å£„Å¶„Åì„ÅÆÂïèÈ°å„ÇíÁâπÂÆö„Åó„ÄÅÂñòÊÅØÊÇ£ËÄÖ„ÇíÂëΩ„ÅÆÂç±Èô∫„Å´„Åï„Çâ„Åô„É™„Çπ„ÇØ„ÇíÂõûÈÅø„Åô„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åó„Åü„ÄÇ„Åì„ÅÆ„Çà„ÅÜ„Å´„ÄÅËß£Èáà„ÅØÂ∏∏„Å´‰∫àÊ∏¨„É¢„Éá„É´„ÇíÊßãÁØâ„Åô„ÇãÈöõ„Å´ËÄÉÊÖÆ„Åô„Åπ„Åç„Çπ„ÉÜ„ÉÉ„Éó„Åß„ÅÇ„Çã„Åì„Å®„Åå„Çè„Åã„Çä„Åæ„Åô„ÄÇ</p>
<section id="id7">
<h2><span class="section-number">12.1. </span>Ë™¨Êòé„Å®„ÅØ‰Ωï„Åã<a class="headerlink" href="#id7" title="Permalink to this headline">¬∂</a></h2>
<p>„Åì„Åì„Åß„ÅØ„ÄÅMiller<span id="id8">[<a class="reference internal" href="#id216" title="Tim Miller. Explanation in artificial intelligence: insights from the social sciences. Artificial intelligence, 267:1‚Äì38, 2019.">Mil19</a>]</span>„ÅÆË™¨Êòé„ÅÆÂÆöÁæ©„Çí‰Ωø„ÅÑ„Åæ„Åô„ÄÇMiller„ÅØ„ÄÅËß£ÈáàÂèØËÉΩÊÄß„ÄÅÊ≠£ÂΩìÂåñ„ÄÅË™¨Êòé„Çí‰ª•‰∏ã„ÅÆÂÆöÁæ©„ÅßÂå∫Âà•„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ</p>
<ul class="simple">
<li><p><strong>Ëß£ÈáàÂèØËÉΩÊÄß</strong>ÔºöË¶≥ÂØüËÄÖ„ÅåÂà§Êñ≠„ÅÆÂéüÂõ†„ÇíÁêÜËß£„Åß„Åç„ÇãÂ∫¶Âêà„ÅÑ„ÇíÊåá„Åó„Åæ„Åô„ÄÇMiller„ÅØ„Åì„Çå„ÇíË™¨ÊòéÂèØËÉΩÊÄß„Å®ÂêåÁæ©„Å®„Åø„Å™„Åó„Åæ„Åó„Åü„ÄÇ<em>„Åì„Çå„ÅØ‰∏ÄËà¨ÁöÑ„Å´„É¢„Éá„É´„ÅÆÁâπÊÄß„Åß„Åô„ÄÇ</em></p></li>
<li><p><strong>Ê≠£ÂΩìÂåñ</strong>Ôºö„É¢„Éá„É´„ÅÆ„ÉÜ„Çπ„Éà„Ç®„É©„Éº„ÇÑÊ≠£Á¢∫Â∫¶„ÅÆ„Çà„ÅÜ„Å´„ÄÅ„Å™„Åú„Åù„ÅÆÊ±∫ÂÆö„ÅåËâØ„ÅÑ„ÅÆ„Åã„Å´„Å§„ÅÑ„Å¶„ÅÆË®ºÊã†„ÇÑË™¨Êòé„Åß„Åô„ÄÇ<em>„Åì„Çå„ÅØ„É¢„Éá„É´„ÅÆÁâπÊÄß„Åß„Åô„ÄÇ</em></p></li>
<li><p><strong>Ë™¨Êòé</strong>ÔºöÁµêÊûú„ÅÆÊñáËÑà„Å®ÂéüÂõ†„Çí‰∏é„Åà„Çã„ÄÅ‰∫∫Èñì„ÇíÂØæË±°„Å®„Åó„ÅüÊÉÖÂ†±„ÅÆÊèêÁ§∫„Åß„Åô„ÄÇ„Åì„Çå„Çâ„ÅåÊú¨Á´†„ÅÆ‰∏ªË¶Å„Å™Ë´ñÁÇπ„Åß„Åô„ÄÇ<em>„Åì„Çå„ÅØ‰∏ÄËà¨ÁöÑ„Å´„É¢„Éá„É´„ÅÆÁâπÊÄß„Åß„ÅØ„Å™„Åè„ÄÅÊñ∞„Åü„Å´ÁîüÊàê„Åô„ÇãËøΩÂä†ÁöÑ„Å™ÊÉÖÂ†±„Åß„Åô„ÄÇ</em></p></li>
</ul>
<p><em>Ë™¨Êòé</em>„ÅÆÊßãÊàêË¶ÅÁ¥†„Å´„Å§„ÅÑ„Å¶Ë©≥„Åó„ÅèË™¨Êòé„Åó„Åæ„Åô„Åå„ÄÅË™¨Êòé„ÅØ‰∫àÊ∏¨„ÇíÊ≠£ÂΩìÂåñ„Åô„Çã„Åì„Å®„Å®„ÅØÁï∞„Å™„Çã„Åì„Å®„Å´Ê≥®ÊÑè„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇÊ≠£ÂΩìÂåñ„Å®„ÅØÊó¢„Å´Ë¶ã„Åü„Çà„ÅÜ„Å´„ÄÅ„É¢„Éá„É´„ÅÆ‰∫àÊ∏¨„ÅåÊ≠£Á¢∫„Åß„ÅÇ„Çã„Å®‰ø°„Åò„Çã„Åπ„ÅçÁêÜÁî±„Å´„Å§„ÅÑ„Å¶„ÅÆÁµåÈ®ìÁöÑ„Å™Ë®ºÊã†„Åß„Åô„ÄÇ‰∏ÄÊñπ„ÄÅË™¨Êòé„Å®„ÅØ‰∫àÊ∏¨„ÅÆ<em>ÂéüÂõ†</em>„ÇíÊòé„Çâ„Åã„Å´„Åô„Çã„Åì„Å®„Åß„ÅÇ„Çä„ÄÅÊúÄÁµÇÁöÑ„Å´‰∫∫„Å´ÁêÜËß£„Åï„Çå„Çã„Åì„Å®„ÇíÁõÆÁöÑ„Å®„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ</p>
<p>„Éá„Ç£„Éº„Éó„É©„Éº„Éã„É≥„Ç∞„ÅØ„Åù„Çå„Å†„Åë„Åß„ÅØ„Éñ„É©„ÉÉ„ÇØ„Éú„ÉÉ„ÇØ„ÇπÁöÑ„Å™„É¢„Éá„É™„É≥„Ç∞ÊâãÊ≥ï„Åß„Åô„ÄÇËß£ÈáàÂèØËÉΩÊÄß„ÇÇË™¨ÊòéÂèØËÉΩÊÄß„ÇÇ„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇÈáç„Åø„ÇÑ„É¢„Éá„É´Âºè„ÇíË™ø„Åπ„Å¶„ÇÇ„ÄÅ„Å™„Åú„Åù„ÅÆ‰∫àÊ∏¨„Åå„Å™„Åï„Çå„Çã„ÅÆ„Åã„Å´„Å§„ÅÑ„Å¶„ÅÆÊ¥ûÂØü„ÅØ„Åª„Å®„Çì„Å©Âæó„Çâ„Çå„Åæ„Åõ„Çì„ÄÇËß£ÈáàÂèØËÉΩÊÄß„ÅØ„Éá„Ç£„Éº„Éó„É©„Éº„Éã„É≥„Ç∞„Å´ÂØæ„Åô„ÇãËøΩÂä†ÁöÑ„Å™„Çø„Çπ„ÇØ„Åß„ÅÇ„Çä„ÄÅ„É¢„Éá„É´„ÅÆ‰∫àÊ∏¨„Å´Ë™¨Êòé„ÇíÂä†„Åà„Çã„Åì„Å®„ÇíÊÑèÂë≥„Åó„Åæ„Åô„ÄÇ„Åó„Åã„Åó„Åì„Çå„ÅØÈõ£„Åó„ÅÑÂïèÈ°å„Åß„Åô„ÄÇ„Éá„Ç£„Éº„Éó„É©„Éº„Éã„É≥„Ç∞„ÅÆ„Éñ„É©„ÉÉ„ÇØ„Éú„ÉÉ„ÇØ„ÇπÁöÑ„Å™ÊÄßË≥™„Å´Âä†„Åà„Å¶„ÄÅ„É¢„Éá„É´„ÅÆ‰∫àÊ∏¨„Å´ÂØæ„Åô„ÇãË™¨Êòé„Å®„ÅØ‰Ωï„Åã„Å´„Å§„ÅÑ„Å¶„ÅÆ„Ç≥„É≥„Çª„É≥„Çµ„Çπ„ÅåÂèñ„Çå„Å¶„ÅÑ„Å™„ÅÑ„Åü„ÇÅ„Åß„Åô<span id="id9">[<a class="reference internal" href="#id189" title="Finale Doshi-Velez and Been Kim. Towards a rigorous science of interpretable machine learning. arXiv preprint arXiv:1702.08608, 2017.">DVK17</a>]</span>„ÄÇ„ÅÇ„Çã‰∫∫„ÅØËß£ÈáàÂèØËÉΩÊÄß„Å´ÂêÑ‰∫àÊ∏¨„ÇíÊ≠£ÂΩìÂåñ„Åô„ÇãËá™ÁÑ∂Ë®ÄË™û„ÅÆË™¨Êòé„ÇíÊúüÂæÖ„Åó„Åæ„Åô„Åå„ÄÅ„ÅÇ„Çã‰∫∫„ÅØ„Å©„ÅÆÁâπÂæ¥„Åå‰∫àÊ∏¨„Å´ÊúÄ„ÇÇË≤¢ÁåÆ„Åó„Åü„Åã„ÇíÁ§∫„Åô„Å†„Åë„ÅßÂçÅÂàÜ„Å®ËÄÉ„Åà„Åæ„Åô„ÄÇ</p>
<p>ML„É¢„Éá„É´„ÅÆËß£Èáà„Å´„ÅØ2„Å§„ÅÆ„Ç¢„Éó„É≠„Éº„ÉÅ„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇË™¨Êòé„Å´„Çà„Çã‰∫ãÂæåËß£Èáà„Å®Ëá™Â∑±Ë™¨ÊòéÂûã„É¢„Éá„É´<span id="id10">[<a class="reference internal" href="#id192" title="James W Murdoch, Chandan Singh, Karl Kumbier, Reza Abbasi-Asl, and Bin Yu. Interpretable machine learning: definitions, methods, and applications. eprint arXiv, pages 1‚Äì11, 2019. URL: http://arxiv.org/abs/1901.04592.">MSK+19</a>]</span>„Åß„Åô„ÄÇËá™Â∑±Ë™¨ÊòéÂûã„É¢„Éá„É´„ÅØÔºåÂ∞ÇÈñÄÂÆ∂„Åå„É¢„Éá„É´„ÅÆÂá∫Âäõ„ÇíË¶ã„Å¶ÔºåË´ñÁêÜÁöÑ„Å´ÁâπÂæ¥Èáè„Å®Áµê„Å≥„Å§„Åë„Çã„Åì„Å®„Åå„Åß„Åç„Çã„Çà„ÅÜ„Å´ÊßãÁØâ„Åï„Çå„Å¶„Åä„Çä„ÄÅÊú¨Ë≥™ÁöÑ„Å´Ëß£ÈáàÂèØËÉΩ„Åß„Åô„ÄÇ„Åü„Å†„Åó„Çø„Çπ„ÇØ„É¢„Éá„É´„Å´Âº∑„Åè‰æùÂ≠ò„Åó„Åæ„Åô<span id="id11">[<a class="reference internal" href="#id193" title="Gr√©goire Montavon, Wojciech Samek, and Klaus-Robert M√ºller. Methods for interpreting and understanding deep neural networks. Digital Signal Processing, 73:1‚Äì15, 2018.">MSMuller18</a>]</span>„ÄÇË∫´Ëøë„Å™‰æã„Åß„ÅØ„ÄÅÂàÜÂ≠êÂãïÂäõÂ≠¶„ÇÑ‰∏ÄÁÇπÈáèÂ≠ê„Ç®„Éç„É´„ÇÆ„ÉºË®àÁÆó„ÅÆ„Çà„ÅÜ„Å™Áâ©ÁêÜÂ≠¶„Å´Âü∫„Å•„Åè„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇÂàÜÂ≠êÂãïÂäõÂ≠¶„ÅÆËªåË∑°„ÇíË™ø„Åπ„ÄÅÂá∫Âäõ„Åï„Çå„ÅüÊï∞ÂÄ§„ÇíË¶ã„Å¶„ÄÅ‰æã„Åà„Å∞Ëñ¨Áâ©ÂàÜÂ≠ê„Åå„Çø„É≥„Éë„ÇØË≥™„Å´ÁµêÂêà„Åô„Çã„Å®‰∫àÊ∏¨„Åô„ÇãÁêÜÁî±„ÇíË™¨Êòé„Åô„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ</p>
<p>Ëá™Â∑±Ë™¨ÊòéÂûã„É¢„Éá„É´„ÅØ„Éá„Ç£„Éº„Éó„É©„Éº„Éã„É≥„Ç∞„ÅÆËß£Èáà„Å´„ÅØÂΩπ„Å´Á´ã„Åü„Å™„ÅÑ/Èñ¢ÈÄ£‰ªò„Åã„Å™„ÅÑ„Çà„ÅÜ„Å´ÊÄù„Åà„Çã„Åã„ÇÇ„Åó„Çå„Åæ„Åõ„Çì„ÄÇ„Åó„Åã„Åó„ÄÅÂæå„ÅÆÁØÄ„Åß„ÄÅËá™Â∑±Ë™¨ÊòéÂûã„ÅÆ<strong>„Çµ„É≠„Ç≤„Éº„Éà„É¢„Éá„É´</strong> („Åæ„Åü„ÅØ<strong>„Éó„É≠„Ç≠„Ç∑„É¢„Éá„É´</strong>Ôºâ„Çí‰Ωú„Çä„ÄÅ„Éá„Ç£„Éº„Éó„É©„Éº„Éã„É≥„Ç∞„É¢„Éá„É´„Å®‰∏ÄËá¥„Åô„Çã„Çà„ÅÜ„Å´Ë®ìÁ∑¥„Åô„Çå„Å∞„Çà„ÅÑ„Åì„Å®„Åå„Çè„Åã„Çã„Åß„Åó„Çá„ÅÜ„ÄÇÊúÄÂàù„Åã„Çâ„Çµ„É≠„Ç≤„Éº„Éà„É¢„Éá„É´„Çí‰Ωø„Çè„Åö„Å´„Éá„Ç£„Éº„Éó„É©„Éº„Éã„É≥„Ç∞„É¢„Éá„É´„Çí‰ªã„Åô„Çã„ÅÆ„ÅØË®ìÁ∑¥„Ç≥„Çπ„Éà„ÇíÊ∏õ„Çâ„Åõ„Çã„Åã„Çâ„Åß„Åô„Åå„ÄÅ„Åù„Çå„ÅØ„Å™„Åú„Åß„Åó„Çá„ÅÜ„Åã„ÄÇÂ≠¶ÁøíÊ∏à„Åø„Éã„É•„Éº„É©„É´„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„ÅØ‰ªªÊÑè„ÅÆÁÇπ„Çí„É©„Éô„É´‰ªò„Åë„Åß„Åç„Çã„ÄÅ„Åô„Å™„Çè„Å°Â≠¶Áøí„Éá„Éº„Çø„ÇíÁÑ°Èôê„Å´ÁîüÊàê„Åô„Çã„Åì„Å®„Åå„Åß„Åç„Çã„Åã„Çâ„Åß„Åô„ÄÇ„Çµ„É≠„Ç≤„Éº„Éà„É¢„Éá„É´„ÅÆ‰ªñ„Å´„ÄÅAttentionÊ©üÊßã<span id="id12">[<a class="reference internal" href="#id203" title="Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Bengio. Neural machine translation by jointly learning to align and translate. arXiv preprint arXiv:1409.0473, 2014.">BCB14</a>]</span>„ÅÆ„Çà„ÅÜ„Å´Ëá™Â∑±Ë™¨ÊòéÁöÑ„Å™ÁâπÂæ¥„ÇíÂÜÖÂåÖ„Åó„Åü„Éá„Ç£„Éº„Éó„É©„Éº„Éã„É≥„Ç∞„É¢„Éá„É´„ÇíÊßãÁØâ„Åô„Çã„Åì„Å®„ÇÇ„Åß„Åç„Åæ„Åô„ÄÇAttentionÊ©üÊßã„Å´Âü∫„Å•„ÅÑ„Å¶ÂÖ•ÂäõÁâπÂæ¥Èáè„Å®‰∫àÊ∏¨ÂÄ§„ÇíÁµê„Å≥„Å§„Åë„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ„Åæ„ÅüÊ©üÊ¢∞Â≠¶Áøí„Å´„ÅØ<strong>„Ç∑„É≥„Éú„É™„ÉÉ„ÇØÂõûÂ∏∞</strong>„Å®„ÅÑ„ÅÜ„ÇÇ„ÅÆ„Åå„ÅÇ„Çä„ÄÅÁõ¥Êé•Ëß£Èáà„Åß„Åç„ÇãÊï∞Âºè„ÇíÊâ±„ÅÜ„Åì„Å®„ÅßËá™Â∑±Ë™¨ÊòéÁöÑ„Å™„É¢„Éá„É´„ÇíÊßãÁØâ„Åó„Çà„ÅÜ„Å®„Åó„Åæ„Åô<span id="id13">[<a class="reference internal" href="#id232" title="Mehrad Ansari, Heta A Gandhi, David G Foster, and Andrew D White. Iterative symbolic regression for learning transport equations. arXiv preprint arXiv:2108.03293, 2021.">AGFW21</a>, <a class="reference internal" href="#id233" title="Lynne Billard and Edwin Diday. Regression analysis for interval-valued data. In Data analysis, classification, and related methods, pages 369‚Äì374. Springer, 2000.">BD00</a>, <a class="reference internal" href="#id234" title="Silviu-Marian Udrescu and Max Tegmark. Ai feynman: a physics-inspired method for symbolic regression. Science Advances, 6(16):eaay2631, 2020.">UT20</a>]</span>„ÄÇ„Åù„ÅÆÁâπÊÄß„Åã„Çâ„ÄÅ„Ç∑„É≥„Éú„É™„ÉÉ„ÇØÂõûÂ∏∞„ÅØ„Çµ„É≠„Ç≤„Éº„Éà„É¢„Éá„É´„ÇíÁîüÊàê„Åô„Çã„Åü„ÇÅ„Å´Áî®„ÅÑ„Çâ„Çå„Åæ„Åô<span id="id14">[<a class="reference internal" href="#id235" title="Miles Cranmer, Alvaro Sanchez Gonzalez, Peter Battaglia, Rui Xu, Kyle Cranmer, David Spergel, and Shirley Ho. Discovering symbolic models from deep learning with inductive biases. Advances in Neural Information Processing Systems, 33:17429‚Äì17442, 2020.">CSGB+20</a>]</span>„ÄÇ</p>
<p>Ë™¨Êòé„Å´„Çà„Çã‰∫ãÂæåËß£Èáà„Å´„ÅØÊßò„ÄÖ„Å™„Ç¢„Éó„É≠„Éº„ÉÅ„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ‰ª£Ë°®ÁöÑ„Å™„ÇÇ„ÅÆ„ÅØÂ≠¶Áøí„Éá„Éº„Çø„ÅÆÈáçË¶ÅÂ∫¶„ÄÅÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶„ÄÅÂèçÂÆü‰ªÆÊÉ≥ÁöÑ„Å™Ë™¨Êòé<span id="id15">[<a class="reference internal" href="#id215" title="Geemi P Wellawatte, Aditi Seshadri, and Andrew D White. Model agnostic generation of counterfactual explanations for molecules. Chem. Sci., pages -, 2022. URL: http://dx.doi.org/10.1039/D1SC05259D, doi:10.1039/D1SC05259D.">WSW22</a>, <a class="reference internal" href="#id194" title="Marco Tulio Ribeiro, Sameer Singh, and Carlos Guestrin. &quot; why should i trust you?&quot; explaining the predictions of any classifier. In Proceedings of the 22nd ACM SIGKDD international conference on knowledge discovery and data mining, 1135‚Äì1144. 2016.">RSG16a</a>, <a class="reference internal" href="#id195" title="Marco Tulio Ribeiro, Sameer Singh, and Carlos Guestrin. Model-agnostic interpretability of machine learning. arXiv preprint arXiv:1606.05386, 2016.">RSG16b</a>, <a class="reference internal" href="#id197" title="Sandra Wachter, Brent Mittelstadt, and Chris Russell. Counterfactual explanations without opening the black box: automated decisions and the gdpr. Harv. JL &amp; Tech., 31:841, 2017.">WMR17</a>]</span>„Åß„Åô„ÄÇ„Éá„Éº„Çø„ÅÆÈáçË¶ÅÂ∫¶„Å´Âü∫„Å•„Åè‰∫ãÂæåËß£Èáà„ÅÆ‰æã„ÅØ„ÄÅ‰∫àÊ∏¨„ÇíË™¨Êòé„Åô„ÇãÊúÄ„ÇÇÂΩ±ÈüøÂäõ„ÅÆ„ÅÇ„ÇãÂ≠¶Áøí„Éá„Éº„Çø„ÇíÁâπÂÆö„Åô„Çã„Åì„Å®„Åß„Åô<span id="id16">[<a class="reference internal" href="#id196" title="Pang Wei Koh and Percy Liang. Understanding black-box predictions via influence functions. In International Conference on Machine Learning, 1885‚Äì1894. PMLR, 2017.">KL17</a>]</span>„ÄÇ„Åù„Çå„Å´„Çà„Å£„Å¶<em>Ë™¨Êòé</em>„Åå„Å§„Åè„Åã„Å©„ÅÜ„Åã„ÅØË≠∞Ë´ñ„ÅÆ‰ΩôÂú∞„Åå„ÅÇ„Çä„Åæ„Åô„Åå„ÄÅ„Å©„ÅÆ„Éá„Éº„Çø„Åå‰∫àÊ∏¨„Å´Èñ¢ÈÄ£„Åó„Å¶„ÅÑ„Çã„Åã„ÇíÁêÜËß£„Åô„Çã„ÅÆ„Å´ÂΩπÁ´ã„Å§„Åì„Å®„ÅØÁ¢∫„Åã„Åß„Åô„ÄÇÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶„ÅØ„Åä„Åù„Çâ„ÅèÊúÄ„ÇÇ‰∏ÄËà¨ÁöÑ„Å™XAI„Ç¢„Éó„É≠„Éº„ÉÅ„Åß„ÄÅ„Ç≥„É≥„Éî„É•„Éº„Çø„Éì„Ç∏„Éß„É≥„ÅÆÁ†îÁ©∂„Å´È†ªÁπÅ„Å´ÁôªÂ†¥„Åó„ÄÅ‰æã„Åà„Å∞ÁîªÂÉè„ÅÆÂàÜÈ°û„Å´„Å®„Å£„Å¶ÊúÄ„ÇÇÈáçË¶Å„Å™„Éî„ÇØ„Çª„É´„Çí„Éè„Ç§„É©„Ç§„Éà„Åó„Åæ„Åô„ÄÇ</p>
<p>ÂèçÂÆü‰ªÆÊÉ≥ÁöÑ„Å™Ë™¨Êòé„ÅØ‰∫ãÂæåËß£Èáà„ÅÆÊñ∞„Åó„ÅÑÊñπÊ≥ï„Åß„Åô„ÄÇÂèçÂÆü‰ªÆÊÉ≥„ÅØË™¨Êòé„Å®„Åó„Å¶Ê©üËÉΩ„Åô„ÇãÊñ∞„Åó„ÅÑ„Éá„Éº„ÇøÁÇπ„Åß„Åô„ÄÇÂèçÂÆü‰ªÆÊÉ≥„ÅØ„ÄÅ„Åù„ÅÆÁâπÂæ¥Èáè„Åå„Å©„Çå„Åª„Å©ÈáçË¶Å„ÅßÊïèÊÑü„Åß„ÅÇ„Çã„Åã„Å´„Å§„ÅÑ„Å¶„ÅÆÊ¥ûÂØü„Çí‰∏é„Åà„Åæ„Åô„ÄÇ‰æã„Å®„Åó„Å¶ËûçË≥á„ÇíÂãß„ÇÅ„Çã„É¢„Éá„É´„Åå„ÅÇ„Çã„Å®„Åó„Åæ„Åô„ÄÇ„Åù„ÅÆ„É¢„Éá„É´„ÅØ‰ª•‰∏ã„ÅÆÂèçÂÆü‰ªÆÊÉ≥ÁöÑ„Å™Ë™¨Êòé„ÇíÁîüÊàê„Åô„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„ÅôÔºà<span id="id17">[<a class="reference internal" href="#id197" title="Sandra Wachter, Brent Mittelstadt, and Chris Russell. Counterfactual explanations without opening the black box: automated decisions and the gdpr. Harv. JL &amp; Tech., 31:841, 2017.">WMR17</a>]</span>„Çà„ÇäÔºâ„ÄÇ</p>
<blockquote>
<div><p>„ÅÇ„Å™„Åü„ÅØ„ÄÅÂπ¥Âèé„ÄÅÈÉµ‰æøÁï™Âè∑„ÄÅË≥áÁî£„Å´Âü∫„Å•„ÅÑ„Å¶„É≠„Éº„É≥„ÇíÊãíÂê¶„Åï„Çå„Åæ„Åó„Åü„ÄÇ„ÇÇ„Åó„ÄÅ„ÅÇ„Å™„Åü„ÅÆÂπ¥Âèé„Åå45,000„Éâ„É´„Åß„ÅÇ„Çå„Å∞„ÄÅ„ÅÇ„Å™„Åü„ÅØ„É≠„Éº„É≥„ÇíÊèê‰æõ„Åï„Çå„Åü„Åß„Åó„Çá„ÅÜ„ÄÇ</p>
</div></blockquote>
<p>2Áï™ÁõÆ„ÅÆÊñá„ÅåÂèçÂÆü‰ªÆÊÉ≥„Åß„ÅÇ„Çä„ÄÅÁâπÂæ¥Èáè„Çí„Å©„ÅÆ„Çà„ÅÜ„Å´Â§â„Åà„Çå„Å∞„É¢„Éá„É´„ÅÆÁµêÊûú„Å´ÂΩ±Èüø„Çí‰∏é„Åà„Çã„Åã„ÇíÁ§∫„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇÂèçÂÆü‰ªÆÊÉ≥„ÅØË§áÈõë„Åï„Å®Ë™¨ÊòéÂäõ„ÇíËâØ„ÅÑ„Éê„É©„É≥„Çπ„ÅßÊèê‰æõ„Åó„Åæ„Åô„ÄÇ</p>
<p>‰ª•‰∏ä„ÅåÂ∫ÉÁØÑ„Å™XAIÂàÜÈáé„Å´Èñ¢„Åô„ÇãÊ¶ÇË¶≥„Åß„Åó„Åü„ÄÇËß£ÈáàÂèØËÉΩ„Å™„Éá„Ç£„Éº„Éó„É©„Éº„Éã„É≥„Ç∞„Å´„Å§„ÅÑ„Å¶„ÅÆÊúÄËøë„ÅÆ„É¨„Éì„É•„Éº„ÅØSamek„Çâ„ÅÆ<span id="id18">[<a class="reference internal" href="#id201" title="Wojciech Samek, Gr√©goire Montavon, Sebastian Lapuschkin, Christopher J. Anders, and Klaus-Robert M√ºller. Explaining deep neural networks and beyond: a review of methods and applications. Proceedings of the IEEE, 109(3):247‚Äì278, 2021. doi:10.1109/JPROC.2021.3060483.">SML+21</a>]</span>„ÇíË¶ã„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ„Åæ„Åü„Éá„Ç£„Éº„Éó„É©„Éº„Éã„É≥„Ç∞„ÇíÂê´„ÇÄËß£ÈáàÂèØËÉΩ„Å™Ê©üÊ¢∞Â≠¶Áøí„Å´Èñ¢„Åô„ÇãÁ∂≤ÁæÖÁöÑ„Å™ÊÉÖÂ†±„ÅØChristopher Molnar„Åå<a class="reference external" href="https://christophm.github.io/interpretable-ml-book/">„Ç™„É≥„É©„Ç§„É≥„Éñ„ÉÉ„ÇØ</a>„ÅßÂÖ¨Èñã„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ‰∫àÊ∏¨Ë™§Â∑Æ„ÇÑ‰∫àÊ∏¨„ÅÆ‰ø°È†ºÊÄß„ÅØÊ≠£ÂΩìÂåñ„ÅÆÊÑèÂë≥Âêà„ÅÑ„ÅåÂº∑„ÅÑ„ÅÆ„Åß„Åì„Åì„Åß„ÅØÊâ±„ÅÑ„Åæ„Åõ„Çì„Åå„ÄÅ<a class="reference internal" href="../ml/regression.html"><span class="doc">Regression &amp; Model Assessment</span></a>„ÅÆÊâãÊ≥ï„ÅåÈÅ©Áî®„Åß„Åç„Çã„ÅÆ„ÅßÂèÇÁÖß„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
</section>
<section id="id19">
<h2><span class="section-number">12.2. </span>ÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶<a class="headerlink" href="#id19" title="Permalink to this headline">¬∂</a></h2>
<p>ÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶„ÅØ„ÄÅÊ©üÊ¢∞Â≠¶Áøí„É¢„Éá„É´„ÇíËß£Èáà„Åô„Çã‰∏ä„ÅßÊúÄ„ÇÇ„Çè„Åã„Çä„ÇÑ„Åô„Åè„ÄÅÊúÄ„ÇÇ‰∏ÄËà¨ÁöÑ„Å™ÊñπÊ≥ï„Åß„Åô„ÄÇÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶„ÅÆÂá∫Âäõ„ÅØÂêÑÁâπÂæ¥Èáè„Å´ÂØæ„Åô„Çã„É©„É≥„Ç≠„É≥„Ç∞„Åæ„Åü„ÅØÊï∞ÂÄ§„Åß„ÅÇ„Çä„ÄÅÈÄöÂ∏∏„ÅØÂçò‰∏Ä„ÅÆ‰∫àÊ∏¨„Å´ÂØæ„Åô„Çã„ÇÇ„ÅÆ„Åß„Åô„ÄÇ„É¢„Éá„É´ÂÖ®‰Ωì„ÅÆÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶„ÅØ<strong>Â§ßÂüüÁöÑ</strong>ÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶„Å®Âëº„Å∞„Çå„ÄÅÂçò‰∏Ä„ÅÆ‰∫àÊ∏¨„Å´ÂØæ„Åó„Å¶„ÅØ<strong>Â±ÄÊâÄÁöÑ</strong>ÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶„Å®Âëº„Å∞„Çå„Åæ„Åô„ÄÇÂ§ßÂüüÁöÑ„Å™ÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶„Å®Ëß£ÈáàÂèØËÉΩÊÄß„ÇíÊåÅ„Å§„Åì„Å®„ÅØÊØîËºÉÁöÑ„Åæ„Çå„Åß„Åô„ÄÇÊ≠£Á¢∫„Å™„Éá„Ç£„Éº„Éó„É©„Éº„Éã„É≥„Ç∞„É¢„Éá„É´„ÅØÁâπÂæ¥Á©∫Èñì„ÅÆ‰ΩçÁΩÆ„Å´„Çà„Å£„Å¶ÈáçË¶Å„Å™ÁâπÂæ¥Èáè„ÅåÂ§â„Çè„Çã„Åü„ÇÅ„Åß„Åô„ÄÇ</p>
<p>„Åæ„Åö„ÅØÁ∑öÂΩ¢„É¢„Éá„É´„ÅßÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶„ÇíË¶ã„Å¶„Åø„Åæ„Åó„Çá„ÅÜ„ÄÇ</p>
<div class="amsmath math notranslate nohighlight" id="equation-c8e0172d-c498-43c9-8279-84ac8a350bf5">
<span class="eqno">(12.1)<a class="headerlink" href="#equation-c8e0172d-c498-43c9-8279-84ac8a350bf5" title="Permalink to this equation">¬∂</a></span>\[\begin{equation}
\hat{y} = \vec{w}\vec{x} + b 
\end{equation}\]</div>
<p>„Åì„Åì„Åß <span class="math notranslate nohighlight">\(\vec{x}\)</span>„ÅØÁâπÂæ¥Èáè„Éô„ÇØ„Éà„É´„Åß„Åô„ÄÇÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶„ÇíË©ï‰æ°„Åô„ÇãÁ∞°Âçò„Å™ÊñπÊ≥ï„ÅØ„ÄÅÁâπÂÆö„ÅÆÁâπÂæ¥Èáè<span class="math notranslate nohighlight">\(x_i\)</span>„Å´Èñ¢„Åô„ÇãÈáç„Åø<span class="math notranslate nohighlight">\(w_i\)</span>„ÇíÂçò„Å´Ë¶ã„Çã„Åì„Å®„Åß„Åô„ÄÇ„Åì„ÅÆÈáç„Åø<span class="math notranslate nohighlight">\(w_i\)</span>„ÅØ„ÄÅ‰ªñ„ÅÆ„Åô„Åπ„Å¶„ÅÆÁâπÂæ¥„Åå‰∏ÄÂÆö„Åß„ÄÅ<span class="math notranslate nohighlight">\(x_i\)</span>„Åå1Â¢óÂä†„Åó„ÅüÂ†¥Âêà„Å´„Å©„ÅÆÁ®ãÂ∫¶Â§âÂåñ„Åô„Çã„Åã„ÇíÁ§∫„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ„ÇÇ„Åó„ÄÅÁâπÂæ¥Èáè„ÅÆÂ§ß„Åç„Åï„ÅåÂêåÁ®ãÂ∫¶„Åß„ÅÇ„Çå„Å∞„ÄÅ„Åì„ÅÆÊñπÊ≥ï„ÅØÁâπÂæ¥Èáè„ÅÆÈ†Ü‰Ωç‰ªò„Åë„Å®„Åó„Å¶Ê©üËÉΩ„Åô„Çã„Åß„Åó„Çá„ÅÜ„ÄÇ„Åó„Åã„Åó„ÄÅÁâπÂæ¥Èáè„ÅåÂçò‰Ωç„ÇíÊåÅ„Å§Â†¥Âêà„ÄÅÂçò‰Ωç„ÅÆÈÅ∏Êäû„Å®ÁâπÂæ¥Èáè„ÅÆÁõ∏ÂØæÁöÑ„Å™Â§ß„Åç„Åï„Å´ÂΩ±Èüø„Åï„Çå„Åæ„Åô„ÄÇ‰æã„Åà„Å∞„ÄÅÊ∞óÊ∏©„ÅåÊëÇÊ∞è„Åã„ÇâËèØÊ∞è„Å´Â§âÊõ¥„Åï„Çå„ÅüÂ†¥Âêà„ÄÅ1Â∫¶‰∏äÊòá„Åó„ÅüÊôÇ„ÅÆÂΩ±Èüø„ÅØÂ∞è„Åï„Åè„Å™„Çä„Åæ„Åô„ÄÇ</p>
<p>ÁâπÂæ¥Èáè„ÅÆÂ§ß„Åç„Åï„ÇÑÂçò‰Ωç„ÅÆÂΩ±Èüø„ÇíÊéíÈô§„Åó„Å¶ÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶„ÇíË©ï‰æ°„Åô„ÇãÂ∞ë„ÅóËâØ„ÅÑÊñπÊ≥ï„ÅØ„ÄÅ<span class="math notranslate nohighlight">\(w_i\)</span>„ÇíÁâπÂæ¥Èáè„ÅÆ<strong>Ê®ôÊ∫ñÂÅèÂ∑Æ</strong>„ÅßÂâ≤„Çã„Åì„Å®„Åß„Åô„ÄÇÊ®ôÊ∫ñÂÅèÂ∑Æ„Å®„ÅØ„ÄÅ‰∫àÊ∏¨ÂÄ§„ÅÆ‰∫å‰πóË™§Â∑Æ„ÅÆÁ∑èÂíå„ÇíÂÅèÂ∑ÆÂπ≥ÊñπÂíå„ÅßÂâ≤„Å£„ÅüÂÄ§„Åß„Åô„ÄÇ„Åô„Å™„Çè„Å°Ê®ôÊ∫ñÂÅèÂ∑Æ„ÅØ‰∫àÊ∏¨„ÅÆÊ≠£Á¢∫Â∫¶„Å®ÁâπÂæ¥Èáè„ÅÆÂàÜÊï£„ÅÆÊØî„Åß„Åô„ÄÇÊ®ôÊ∫ñÂÅèÂ∑Æ„ÅßÂâ≤„Å£„Åü<span class="math notranslate nohighlight">\(w_i\)</span>„ÅØt-ÂàÜÂ∏É„Å®ÊØîËºÉ„Åß„Åç„Çã„Åü„ÇÅ„ÄÅ<span class="math notranslate nohighlight">\(t\)</span>-Áµ±Ë®àÈáè„Å®Âëº„Å∞„Çå„Åæ„Åô„ÄÇ</p>
<div class="amsmath math notranslate nohighlight" id="equation-0b13872b-2772-47d9-a43a-ff38ce142725">
<span class="eqno">(12.2)<a class="headerlink" href="#equation-0b13872b-2772-47d9-a43a-ff38ce142725" title="Permalink to this equation">¬∂</a></span>\[\begin{equation}
t_i = \frac{w_i}{S_{w_i}},\; S^2_{w_i} = \frac{1}{N - D}\sum_j \frac{\left(\hat{y}_j - y_j\right)^2}{\left(x_{ij} - \bar{x}_i\right)^2}
\end{equation}\]</div>
<p>„Åì„Åì„Åß„ÄÅN„ÅØ‰æãÊï∞„ÄÅ D„ÅØÁâπÂæ¥ÈáèÊï∞„ÄÅ <span class="math notranslate nohighlight">\(\bar{x}_i\)</span>„ÅØiÁï™ÁõÆ„ÅÆÁâπÂæ¥Èáè„ÅÆÂπ≥ÂùáÂÄ§„Åß„Åô„ÄÇ<span class="math notranslate nohighlight">\(t_i\)</span>ÂÄ§„ÅØ„ÄÅÁâπÂæ¥Èáè„ÅÆÈ†Ü‰Ωç‰ªò„Åë„Å®‰ªÆË™¨Ê§úÂÆö„Å´Âà©Áî®„Åß„Åç„Åæ„Åô„ÄÇ„ÇÇ„Åó<span class="math notranslate nohighlight">\(P(t &gt; t_i) &lt; 0.05\)</span>„Åß„ÅÇ„Çå„Å∞„ÄÅ„Åù„ÅÆÁâπÂæ¥Èáè„ÅØÁµ±Ë®àÁöÑ„Å´ÊúâÊÑè„Åß„ÄÅ<span class="math notranslate nohighlight">\(P(t)\)</span>„ÅØStudent‚Äôs <span class="math notranslate nohighlight">\(t\)</span>-ÂàÜÂ∏É„Åß„Åô„ÄÇÁâπÂæ¥Èáè„ÅÆÊúâÊÑèÊÄß„ÅØ„É¢„Éá„É´„Å´Â≠òÂú®„Åô„Çã‰ªñ„ÅÆÁâπÂæ¥Èáè„Å´‰æùÂ≠ò„Åô„Çã„Åì„Å®„Å´Ê≥®ÊÑè„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ„Å§„Åæ„ÇäÊñ∞„Åó„ÅÑÁâπÂæ¥Èáè„ÇíËøΩÂä†„Åô„Çã„Å®„ÄÅ‰∏ÄÈÉ®„ÅåÂÜóÈï∑„Å´„Å™„ÇãÂèØËÉΩÊÄß„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ</p>
<p>Ê¨°„Å´ÈùûÁ∑öÂΩ¢„ÅÆÂ†¥Âêà„ÇíË¶ã„Å¶„Åø„Åæ„Åó„Çá„ÅÜ„ÄÇÈùûÁ∑öÂΩ¢Â≠¶ÁøíÈñ¢Êï∞<span class="math notranslate nohighlight">\(\hat{f}(\vec{x})\)</span>„Åß„ÅØ„ÄÅÁâπÂæ¥Èáè„Åå1Â¢óÂä†„Åó„ÅüÂ†¥Âêà„Å´‰∫àÊ∏¨„Åå„Å©„ÅÆ„Çà„ÅÜ„Å´Â§âÂåñ„Åô„Çã„Åã„ÇíÂæÆÂàÜËøë‰ºº„ÅßË®àÁÆó„Åó„Åæ„Åô„ÄÇ</p>
<div class="math notranslate nohighlight">
\[
\frac{\Delta \hat{f}(\vec{x})}{\Delta x_i} \approx \frac{\partial  \hat{f}(\vec{x})}{\partial x_i}
\]</div>
<p>1„Å†„ÅëÂ§âÂåñ„Åï„Åõ„Çã„Å®</p>
<div class="amsmath math notranslate nohighlight" id="equation-ed990931-ff83-4abd-b0a9-11175cca5dd2">
<span class="eqno">(12.3)<a class="headerlink" href="#equation-ed990931-ff83-4abd-b0a9-11175cca5dd2" title="Permalink to this equation">¬∂</a></span>\[\begin{equation}
\Delta \hat{f}(\vec{x}) \approx \frac{\partial  \hat{f}(\vec{x})}{\partial x_i}.
\end{equation}\]</div>
<p>ÂÆüÈöõ„Å´„ÅØ„Åì„ÅÆÂºè„ÇíÂ∞ë„ÅóÂ§âÂΩ¢„Åó„Åæ„Åô„ÄÇ0„Çí‰∏≠ÂøÉ„Å®„Åó„Åü„ÉÜ„Ç§„É©„ÉºÁ¥öÊï∞„Çí‰Ωø„ÅÜ‰ª£„Çè„Çä„Å´„ÄÅ‰ªñ„ÅÆ„É´„Éº„ÉàÔºàÈñ¢Êï∞„Åå0„Å®„Å™„ÇãÁÇπÔºâ„Çí‰∏≠ÂøÉ„Å´„Åó„Åæ„Åô„ÄÇ„Åù„ÅÜ„Åô„Çã„Åì„Å®„Åß„ÄÅÊ±∫ÂÆöÂ¢ÉÁïåÔºà„É´„Éº„ÉàÔºâ„ÅßÁ≥ªÂàó„Çí„ÄåÊé•Âú∞„Äç„Åó„ÄÅ‰∫àÊ∏¨„Åï„Çå„Çã„ÇØ„É©„Çπ„ÇíÊ±∫ÂÆöÂ¢ÉÁïå„Åã„Çâ„ÄåÈÅ†„Åñ„Åë„Äç„Åü„Çä„ÄåËøë„Å•„Åë„Äç„Åü„Çä„Åô„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ„ÇÇ„ÅÜ1„Å§„ÅÆÊñπÊ≥ï„ÅØ„ÄÅ„ÉÜ„Ç§„É©„ÉºÁ¥öÊï∞„ÅÆ1Ê¨°„ÅÆÈ†Ö„Çí‰ΩøÁî®„Åó„Å¶Á∑öÂΩ¢„É¢„Éá„É´„ÇíÊßãÁØâ„Åô„Çã„Å®„ÅÑ„ÅÜ„ÇÇ„ÅÆ„Åß„Åô„ÄÇ„Åù„Åó„Å¶„ÄÅ„Åù„ÅÆÁ∑öÂΩ¢„É¢„Éá„É´„Å´‰∏äË®ò„Å®ÂêåÊßò„ÅÆ„Åì„Å®„ÇíË°å„ÅÑ„ÄÅ„Åù„ÅÆ‰øÇÊï∞„ÇíÁâπÂæ¥Èáè„ÅÆ„ÄåÈáçË¶ÅÂ∫¶„Äç„Å®„Åó„Å¶‰ΩøÁî®„Åó„Åæ„Åô„ÄÇÂÖ∑‰ΩìÁöÑ„Å´„ÅØ„ÄÅ<span class="math notranslate nohighlight">\(\hat{f}(\vec{x})\)</span>„Å´ÂØæ„Åó„Å¶‰ª•‰∏ã„ÅÆ„Çà„ÅÜ„Å™„Çµ„É≠„Ç≤„Éº„ÉàÈñ¢Êï∞„Çí‰ΩøÁî®„Åó„Åæ„Åô„ÄÇ</p>
<div class="amsmath math notranslate nohighlight" id="equation-5b6b820a-2ca9-4255-9e7a-2c35d5a3290b">
<span class="eqno">(12.4)<a class="headerlink" href="#equation-5b6b820a-2ca9-4255-9e7a-2c35d5a3290b" title="Permalink to this equation">¬∂</a></span>\[\begin{equation}
\require{cancel}
\hat{f}(\vec{x}) \approx \cancelto{0}{f(\vec{x}')} +  \nabla\hat{f}(\vec{x}')\cdot\left(\vec{x} - \vec{x}'\right)
\end{equation}\]</div>
<p>„Åì„Åì„Åß„ÄÅ<span class="math notranslate nohighlight">\(\vec{x}'\)</span>„ÅØ<span class="math notranslate nohighlight">\(\hat{f}(\vec{x})\)</span>„ÅÆ„É´„Éº„Éà„Åß„Åô„ÄÇ„Åü„ÅÑ„Å¶„ÅÑËá™Êòé„Å™„É´„Éº„Éà<span class="math notranslate nohighlight">\(\vec{x}' = \vec{0}\)</span>„ÇíÈÅ∏Êäû„Åô„Çã„Åã„ÇÇ„Åó„Çå„Åæ„Åõ„Çì„Åå„ÄÅËøëÂÇç„ÅÆ„É´„Éº„Éà„ÅåÁêÜÊÉ≥ÁöÑ„Åß„Åô„ÄÇ„Åì„ÅÆ„É´„Éº„Éà„ÅØ„Åó„Å∞„Åó„Å∞<strong>„Éô„Éº„Çπ„É©„Ç§„É≥</strong>ÂÖ•Âäõ„Å®Âëº„Å∞„Çå„Åæ„Åô„ÄÇ‰∏äË®ò„ÅÆÁ∑öÂΩ¢„ÅÆ‰æã„Å®„ÅØÂØæÁÖßÁöÑ„Å´„ÄÅÈÉ®ÂàÜÁöÑ„Å™<span class="math notranslate nohighlight">\(\frac{\partial  \hat{f}(\vec{x})}{\partial x_i}\)</span>„ÅÆÁ©ç„Å®„Éô„Éº„Çπ„É©„Ç§„É≥„Åã„Çâ„ÅÆÂ¢óÂàÜ<span class="math notranslate nohighlight">\((x_i - x_i')\)</span>„ÇíËÄÉ„Åà„Åæ„Åô„ÄÇ</p>
<section id="id20">
<h3><span class="section-number">12.2.1. </span>„Éã„É•„Éº„É©„É´„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„ÅÆÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶<a class="headerlink" href="#id20" title="Permalink to this headline">¬∂</a></h3>
<p>„Éã„É•„Éº„É©„É´„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„Åß„ÅØ„ÄÅÂÅèÂ∞éÈñ¢Êï∞„ÅØÂá∫Âäõ„Å´ÂØæ„Åô„ÇãÂÆüÈöõ„ÅÆÂ§âÂåñ„ÇíËøë‰ºº„Åô„Çã„Å´„ÅØ‰∏çÂçÅÂàÜ„Åß„Åô„ÄÇÂÖ•Âäõ„Å´ÂØæ„Åô„ÇãÂ∞è„Åï„Å™Â§âÂåñ„Åå‰∏çÈÄ£Á∂ö„Å™Â†¥ÂêàÔºàReLU„ÅÆ„Çà„ÅÜ„Å™ÈùûÁ∑öÂΩ¢ÊÄß„ÅÆ„Åü„ÇÅÔºâ„ÄÅ„Åª„Å®„Çì„Å©Ë™¨ÊòéÂäõ„ÇíÊåÅ„Åü„Å™„Åè„Å™„Çã„Åì„Å®„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ„Åì„Çå„ÅØ<strong>shattered gradients</strong>ÂïèÈ°å<span id="id21">[<a class="reference internal" href="#id204" title="David Balduzzi, Marcus Frean, Lennox Leary, J. P. Lewis, Kurt Wan-Duo Ma, and Brian McWilliams. The shattered gradients problem: if resnets are the answer, then what is the question? In Doina Precup and Yee Whye Teh, editors, Proceedings of the 34th International Conference on Machine Learning, volume 70 of Proceedings of Machine Learning Research, 342‚Äì350. PMLR, 06‚Äì11 Aug 2017. URL: http://proceedings.mlr.press/v70/balduzzi17b.html.">BFL+17</a>]</span>„Å®Âëº„Å∞„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ„Åæ„ÅüÂÄã„ÄÖ„ÅÆÁâπÂæ¥Èáè„Å´ÂàÜ„Åë„Çã„Å®„ÄÅÁâπÂæ¥ÈáèÈñì„ÅÆÁõ∏Èñ¢„ÇÇÊ¨†ËêΩ„Åó„Å¶„Åó„Åæ„ÅÑ„Åæ„Åô„ÄÇ„Åì„Çå„ÅØÁ∑öÂΩ¢„É¢„Éá„É´„Å´„ÅØ„Å™„ÅÑÂïèÈ°å„Åß„Åô„ÄÇ„Åó„Åü„Åå„Å£„Å¶„ÄÅÂæÆÂàÜËøë‰ºº„ÅØÂ±ÄÊâÄÁöÑ„Å™Á∑öÂΩ¢„É¢„Éá„É´„Åß„ÅØÂçÅÂàÜ„Å´Ê©üËÉΩ„Åó„Åæ„Åô„Åå„ÄÅ„Éá„Ç£„Éº„Éó„Éã„É•„Éº„É©„É´„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„Åß„ÅØÊ©üËÉΩ„Åó„Åæ„Åõ„Çì„ÄÇ</p>
<p>„Éã„É•„Éº„É©„É´„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„Å´„Åä„Åë„Çãshattered gradientsÂïèÈ°å„ÇíÂõûÈÅø„Åô„ÇãÊñπÊ≥ï„ÅØ„ÅÑ„Çç„ÅÑ„Çç„ÅÇ„Çä„Åæ„Åô„ÄÇ„Çà„Åè‰Ωø„Çè„Çå„Çã„ÅÆ„ÅØintegrated gradients <span id="id22">[<a class="reference internal" href="#id206" title="Mukund Sundararajan, Ankur Taly, and Qiqi Yan. Axiomatic attribution for deep networks. In International Conference on Machine Learning, 3319‚Äì3328. PMLR, 2017.">STY17</a>]</span> „Å®SmoothGrad<span id="id23">[<a class="reference internal" href="#id207" title="Daniel Smilkov, Nikhil Thorat, Been Kim, Fernanda Vi√©gas, and Martin Wattenberg. Smoothgrad: removing noise by adding noise. arXiv preprint arXiv:1706.03825, 2017.">STK+17</a>]</span>„ÅÆ2„Å§„ÅÆÊñπÊ≥ï„Åß„Åô„ÄÇintegrated gradients„ÅØ<span class="math notranslate nohighlight">\(\vec{x}'\)</span>„Åã„Çâ<span class="math notranslate nohighlight">\(\vec{x}\)</span>„Åæ„ÅßÁõ¥Á∑ö„ÅßÁµê„Å∂ÁµåË∑Ø„ÇíËÄÉ„Åà„ÄÅ„Åì„ÅÆÁµåË∑Ø‰∏ä„ÅßÂØæË±°„Å®„Å™„ÇãÂ§âÊï∞„ÅÆÂæÆÂàÜÂÄ§„ÇíÁ©çÂàÜ„ÅßÁµ±Âêà„Åó„Åæ„Åô„ÄÇ</p>
<div class="amsmath math notranslate nohighlight" id="equation-d5d2db8e-ba88-4562-bc9c-ddcc4d2e3822">
<span class="eqno">(12.5)<a class="headerlink" href="#equation-d5d2db8e-ba88-4562-bc9c-ddcc4d2e3822" title="Permalink to this equation">¬∂</a></span>\[\begin{equation}
\textrm{IG}_i = \left(\vec{x} - \vec{x}'\right) \int_0^1\left[\nabla\hat{f}\left(\vec{x}' + t\left(\vec{x} - \vec{x}'\right)\right)\right]_i\,dt
\end{equation}\]</div>
<p><span class="math notranslate nohighlight">\(t\)</span>„ÅØÁµåË∑Ø„Å´Ê≤ø„Å£„Åü„ÅÇ„ÇãÂ¢óÂàÜ„Åß„ÄÅ<span class="math notranslate nohighlight">\(t = 0\)</span> „ÅÆ„Å®„Åç <span class="math notranslate nohighlight">\(\vec{x}' + t\left(\vec{x} - \vec{x}'\right) = \vec{x}'\)</span>„ÄÅ<span class="math notranslate nohighlight">\(t = 1\)</span> „ÅÆ„Å®„Åç <span class="math notranslate nohighlight">\(\vec{x}' + t\left(\vec{x} - \vec{x}'\right) = \vec{x}\)</span> „Åß„Åô„ÄÇ„Åì„ÅÆÂºè„Å´„Çà„ÇäÂêÑÁâπÂæ¥Èáè<span class="math notranslate nohighlight">\(i\)</span>„ÅÆintegrated gradient„ÇíÂæó„Åæ„Åô„ÄÇintegrated gradient„ÅØÂêÑÁâπÂæ¥Èáè„ÅÆÈáçË¶ÅÂ∫¶„Åß„Åô„Åå„ÄÅshattered gradients„ÅÆÊåÅ„Å§Ë§áÈõë„Åï„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ„Åæ„Åü„É¢„Éá„É´ <span class="math notranslate nohighlight">\(f(\vec{x})\)</span> „Åå„Åª„Å®„Çì„Å©Ëá≥„Çã„Å®„Åì„Çç„ÅßÂæÆÂàÜÂèØËÉΩ„Åß„ÅÇ„Çå„Å∞„ÄÅ <span class="math notranslate nohighlight">\(\sum_i \textrm{IG}_i = f(\vec{x}) - f(\vec{x}')\)</span> „Å®„ÅÑ„ÅÜÂºè„ÅåÊàêÁ´ã„Åó„Åæ„Åô„ÄÇ„Åì„Çå„ÅØintegrated gradients„ÅßË®àÁÆó„Åï„Çå„ÅüÂêÑÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶„ÅÆÂêàË®àÂÄ§„Åå„ÄÅ„Éô„Éº„Çπ„É©„Ç§„É≥„Å®‰∫àÊ∏¨ÂÄ§„ÅÆÂ∑Æ„Å´Á≠â„Åó„Åè„Å™„Çã„Åì„Å®„ÇíÊÑèÂë≥„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ„Åô„Å™„Çè„Å°„Éô„Éº„Çπ„É©„Ç§„É≥„Åã„Çâ‰∫àÊ∏¨ÂÄ§„ÅÆÂ§âÂåñÈáè„ÇíÂÆåÂÖ®„Å´ÂàÜÈõ¢„Åó„Å¶„Åè„Çå„Åæ„Åô<span id="id24">[<a class="reference internal" href="#id206" title="Mukund Sundararajan, Ankur Taly, and Qiqi Yan. Axiomatic attribution for deep networks. In International Conference on Machine Learning, 3319‚Äì3328. PMLR, 2017.">STY17</a>]</span></p>
<p>integrated gradients„ÅÆÂÆüË£Ö„ÅØÊØîËºÉÁöÑÁ∞°Âçò„Åß„Åô„ÄÇÁµåË∑Ø„ÇíÂÖ•ÂäõÁâπÂæ¥Èáè <span class="math notranslate nohighlight">\(\vec{x}\)</span>„Å®„Éô„Éº„Çπ„É©„Ç§„É≥ <span class="math notranslate nohighlight">\(\vec{x}'\)</span>„ÅÆÈñì„Å´„ÅÇ„ÇãÈõ¢Êï£ÂÖ•Âäõ„ÅÆÈõÜÂêà„Å´ÂàÜÂâ≤„Åô„Çã„Åì„Å®„Å´„Çà„Çä„ÄÅ„É™„Éº„Éû„É≥Âíå„ÅßÁµåË∑Ø„ÅÆÁ©çÂàÜ„ÇíËøë‰ºº„Åó„Åæ„Åô„ÄÇ„Åì„Çå„Çâ„ÅÆÂÖ•Âäõ„ÅÆÂãæÈÖç„Çí„Éã„É•„Éº„É©„É´„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„ÅßË®àÁÆó„Åó„Åæ„Åô„ÄÇ„Åù„Åó„Å¶„ÄÅ„Éô„Éº„Çπ„É©„Ç§„É≥„Åã„Çâ„ÅÆÁâπÂæ¥Èáè„ÅÆÂ§âÂåñÈáè<span class="math notranslate nohighlight">\(\left(\vec{x} - \vec{x}'\right)\)</span>„Çí‰πó„Åò„Åæ„Åô„ÄÇ</p>
<p>SmmothGrad„ÅØintegrated gradients„Å®ÂêåÊßò„ÅÆËÄÉ„ÅàÊñπ„Åß„Åô„ÄÇ„Åó„Åã„ÅóÁµåË∑Ø„Å´„Åù„Å£„ÅüÂãæÈÖç„ÇíÂêàË®à„Åô„Çã„ÅÆ„Åß„ÅØ„Å™„Åè„ÄÅ‰∫àÊ∏¨„ÅÆËøë„Åè„Å´„ÅÇ„Çã„É©„É≥„ÉÄ„É†„Å™ÁÇπ„Åã„ÇâÂãæÈÖç„ÇíË®àÁÆó„Åó„Åæ„Åô„ÄÇÂºè„ÅØ‰ª•‰∏ã„ÅÆÈÄö„Çä„Åß„Åô„ÄÇ</p>
<div class="amsmath math notranslate nohighlight" id="equation-fca7a686-88c4-4362-9891-747a7de7caca">
<span class="eqno">(12.6)<a class="headerlink" href="#equation-fca7a686-88c4-4362-9891-747a7de7caca" title="Permalink to this equation">¬∂</a></span>\[\begin{equation}
\textrm{SG}_i = \sum_j^M\left[\nabla\hat{f}\left(\vec{x}' + \vec{\epsilon}\right)\right]_i
\end{equation}\]</div>
<p><span class="math notranslate nohighlight">\(M\)</span>„ÅØ„Çµ„É≥„Éó„É´Êï∞„ÅÆÈÅ∏Êäû„Åß„ÅÇ„Çä„ÄÅ<span class="math notranslate nohighlight">\(\vec{\epsilon}\)</span>„ÅØ<span class="math notranslate nohighlight">\(D\)</span>„Çº„É≠Âπ≥Âùá„Ç¨„Ç¶„Ç∑„Ç¢„É≥„Åã„Çâ„Çµ„É≥„Éó„É™„É≥„Ç∞„Åï„Çå„Åæ„Åô<span id="id25">[<a class="reference internal" href="#id207" title="Daniel Smilkov, Nikhil Thorat, Been Kim, Fernanda Vi√©gas, and Martin Wattenberg. Smoothgrad: removing noise by adding noise. arXiv preprint arXiv:1706.03825, 2017.">STK+17</a>]</span>„ÄÇ
„Åì„Åì„Åß„ÅÆÂÆüË£Ö‰∏ä„ÅÆÂîØ‰∏Ä„ÅÆÂ§âÊõ¥ÁÇπ„ÅØ„ÄÅÁµåË∑Ø„Çí‰∏ÄÈÄ£„ÅÆ„É©„É≥„ÉÄ„É†„Å™ÊëÇÂãï„Å´ÁΩÆ„ÅçÊèõ„Åà„Çã„Åì„Å®„Åß„Åô„ÄÇ</p>
<p>„Åì„Çå„Çâ„ÅÆÂãæÈÖç„Éô„Éº„Çπ„ÅÆÊñπÊ≥ï‰ª•Â§ñ„Å´„ÇÇ„ÄÅLayer-wise Relevance Propagation (LRP)„ÅØ„Éã„É•„Éº„É©„É´„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„Å´„Åä„Åë„ÇãÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶„ÅÆËß£Êûê„ÅÆ‰∏ÄËà¨ÁöÑ„Å™ÊñπÊ≥ï„Åß„Åô„ÄÇLPR„ÅØ„ÄÅ1„Å§„ÅÆÂ±§„ÅÆÂá∫ÂäõÂÄ§„ÇíÂÖ•ÂäõÁâπÂæ¥Èáè„Å´ÂàÜÂâ≤„Åô„Çã„Éã„É•„Éº„É©„É´„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„Çí‰ªã„Åó„ÅüÈÄÜ‰ºùÊí≠„ÇíË°å„ÅÜ„Åì„Å®„ÅßÊ©üËÉΩ„Åó„Åæ„Åô„ÄÇ„Åì„Çå„ÅØ„ÄåÈñ¢ÈÄ£ÊÄß„ÇíÂàÜÊï£„Åï„Åõ„Çã„Äç„Å®„ÅÑ„ÅÜ„Åì„Å®„Åß„Åô„ÄÇLPR„ÅÆÂ§â„Çè„Å£„Åü„Å®„Åì„Çç„ÅØ„ÄÅÂêÑÂ±§„ÅÆÁ®ÆÈ°ûÊØé„Å´Áã¨Ëá™„ÅÆÂÆüË£Ö„ÅåÂøÖË¶Å„Å™„Åì„Å®„Åß„Åô„ÄÇËß£ÊûêÁöÑ„Å™Â∞éÈñ¢Êï∞„Å´È†º„Çâ„Åö„ÄÅÂ±§„ÅÆÊñπÁ®ãÂºè„ÅÆ„ÉÜ„Ç§„É©„ÉºÁ¥öÊï∞Â±ïÈñã„ÅßÂØæÂøú„Åó„Åæ„Åô„ÄÇGNN„ÇÑ„Ç∑„Éº„Ç±„É≥„Çπ„É¢„Éá„É´Áî®„ÅÆLRP„ÇÇ„ÅÇ„Çä„ÄÅLRP„ÅØÊùêÊñô„ÇÑÂåñÂ≠¶„ÅÆ„Åª„Å®„Çì„Å©„ÅÆÂ†¥Èù¢„Åß‰Ωø„ÅÜ„Åì„Å®„Åå„Åß„Åç„Åæ„Åô<span id="id26">[<a class="reference internal" href="#id208" title="Gr√©goire Montavon, Alexander Binder, Sebastian Lapuschkin, Wojciech Samek, and Klaus-Robert M√ºller. Layer-Wise Relevance Propagation: An Overview, pages 193‚Äì209. Springer International Publishing, Cham, 2019. URL: https://link.springer.com/chapter/10.1007%2F978-3-030-28954-6_10.">MBL+19</a>]</span>„ÄÇ</p>
</section>
<section id="id27">
<h3><span class="section-number">12.2.2. </span>„Ç∑„É£„Éº„Éó„É¨„Ç§ÂÄ§<a class="headerlink" href="#id27" title="Permalink to this headline">¬∂</a></h3>
<p>„É¢„Éá„É´Èùû‰æùÂ≠òÁöÑ„Å´ÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶„ÇíÊâ±„ÅÜÊñπÊ≥ï„Å®„Åó„Å¶„ÄÅ<strong>„Ç∑„É£„Éº„Éó„É¨„Ç§ÂÄ§</strong>„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ„Ç∑„É£„Éº„Éó„É¨„Ç§ÂÄ§„ÅØ„Ç≤„Éº„É†ÁêÜË´ñ„Å´Áî±Êù•„Åô„Çã„ÇÇ„ÅÆ„Åß„ÄÅÂçîÂäõÁöÑ„Å™„Éó„É¨„Éº„É§„Éº„Å´„ÄÅ„Åù„ÅÆË≤¢ÁåÆÂ∫¶„Å´Âøú„Åò„Å¶Â†±ÈÖ¨„ÇíÊîØÊâï„ÅÜÊñπÊ≥ï„Å´„Å§„ÅÑ„Å¶„ÅÆËß£Ê±∫Á≠ñ„Åß„Åô„ÄÇÂêÑÁâπÂæ¥Èáè„Åå„Éó„É¨„Éº„É§„Éº„Åß„ÅÇ„Çä„ÄÅ‰∫àÊ∏¨ÂÄ§„Å∏„ÅÆË≤¢ÁåÆÂ∫¶„Å´Âøú„Åò„Å¶„ÄåÊîØÊâï„ÅÜ„Äç„Åì„Å®„ÇíÊÉ≥ÂÆö„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ„Ç∑„É£„Éº„Éó„É¨„Ç§ÂÄ§ <span class="math notranslate nohighlight">\(\phi_i(x)\)</span>„ÅØ„ÄÅ„Ç§„É≥„Çπ„Çø„É≥„Çπ<span class="math notranslate nohighlight">\(x\)</span>„ÅÆÁâπÂæ¥Èáè<span class="math notranslate nohighlight">\(i\)</span>„Å´ÂØæ„Åô„ÇãÊîØÊâï„ÅÑ„Åß„Åô„ÄÇ‰∫àÊ∏¨Èñ¢Êï∞ÂÄ§ <span class="math notranslate nohighlight">\(\hat{f}(x)\)</span>„Çí„Ç∑„É£„Éº„Éó„É¨„Ç§ÂÄ§„Å´ÂàÜÂâ≤„Åó„Å¶„ÄÅ„Åù„ÅÆÂíå„ÅåÈñ¢Êï∞ÂÄ§<span class="math notranslate nohighlight">\(\sum_i \phi_i(x) = \hat{f}(x)\)</span>„Å®„Å™„Çã„Çà„ÅÜ„Å´„Åó„Åæ„Åô„ÄÇ„Å§„Åæ„Çä„ÄÅ„ÅÇ„ÇãÁâπÂæ¥Èáè„ÅÆ„Ç∑„É£„Éº„Éó„É¨„Ç§ÂÄ§„ÅØ‰∫àÊ∏¨„Å´ÂØæ„Åô„ÇãÊï∞ÂÄ§ÁöÑ„Å™Ë≤¢ÁåÆÂ∫¶„Å®Ëß£Èáà„Åß„Åç„Åæ„Åô„ÄÇ„Ç∑„É£„Éº„Éó„É¨„Ç§ÂÄ§„ÅÆÂº∑Âäõ„Å™Âà©ÁÇπ„ÅØ„ÄÅ„É¢„Éá„É´„Å´‰æùÂ≠ò„Åõ„Åö„ÄÅ‰∫àÊ∏¨ÂÄ§„ÇíÂêÑÁâπÂæ¥Èáè„Å´ÂàÜÂâ≤„Åß„Åç„ÄÅ‰∫àÊ∏¨„ÅÆË™¨Êòé„Å´ÂøÖË¶Å„Å™Â±ûÊÄßÔºàÂØæÁß∞ÊÄß„ÄÅÁ∑öÂΩ¢ÊÄß„ÄÅÈ†ÜÂ∫è‰∏çÂ§âÊÄß„Å™„Å©Ôºâ„ÇíÊåÅ„Å§„Åì„Å®„Åß„Åô„ÄÇÊ¨†ÁÇπ„ÅØ„ÄÅÂé≥ÂØÜ„Å™Ë®àÁÆó„Å´„ÅØÁâπÂæ¥Èáè„ÅÆÁµÑ„ÅøÂêà„Çè„Åõ„ÅÆÊï∞„Å†„Åë„Ç≥„Çπ„Éà„Åå„Åã„Åã„Çã„Åì„Å®„ÄÅ„Çπ„Éë„Éº„ÇπÊÄß„ÇíÊåÅ„Åü„Å™„ÅÑ„Åì„Å®„Åß„ÅÇ„Çä„ÄÅÁµêÊûúÁöÑ„Å´ÁâπÂæ¥ÈáèÊï∞„ÅÆÂ¢óÂä†„Å´‰º¥„Å£„Å¶ÊúâÁî®ÊÄß„Åå‰Ωé„Åè„Å™„Çä„Åæ„Åô„ÄÇ„Åì„Åì„ÅßÁ¥π‰ªã„Åô„ÇãÊâãÊ≥ï„ÇÇ„Çπ„Éë„Éº„ÇπÊÄß„ÇíÊåÅ„Åü„Å™„ÅÑ„ÇÇ„ÅÆ„Åå„Åª„Å®„Çì„Å©„Åß„Åô„ÄÇL1Ê≠£ÂâáÂåñ(<a class="reference internal" href="layers.html"><span class="doc">Standard Layers</span></a>ÂèÇÁÖß)„ÅÆ„Çà„ÅÜ„Å´„ÄÅÂ∏∏„Å´„É¢„Éá„É´„Çí„Çπ„Éë„Éº„Çπ„Å´„Åô„Çã„Åì„Å®„Åß„Çπ„Éë„Éº„Çπ„Å™Ë™¨Êòé„ÇíÂÆüÁèæ„Åô„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ</p>
<p>„Ç∑„É£„Éº„Éó„É¨„Ç§ÂÄ§„ÅØÊ¨°„ÅÆ„Çà„ÅÜ„Å´Ë®àÁÆó„Åï„Çå„Åæ„Åô„ÄÇ</p>
<div class="amsmath math notranslate nohighlight" id="equation-7fea6854-03a2-48d4-af1a-2a41a3a49bde">
<span class="eqno">(12.7)<a class="headerlink" href="#equation-7fea6854-03a2-48d4-af1a-2a41a3a49bde" title="Permalink to this equation">¬∂</a></span>\[\begin{equation}
\phi_i(x) = \frac{1}{Z}\sum_{S \in N \backslash x_i}v(S\cup x_i) - v(S)
\end{equation}\]</div>
<div class="math notranslate nohighlight">
\[
Z = \frac{|S|!\left(N - |S| - 1\right)!}{N!}
\]</div>
<p><span class="math notranslate nohighlight">\(S \in N \backslash x_i\)</span>„ÅØÁâπÂæ¥Èáè<span class="math notranslate nohighlight">\(x_i\)</span>„ÇíÈô§„ÅÑ„ÅüÂÖ®„Å¶„ÅÆÁâπÂæ¥Èáè„ÅÆÈõÜÂêà„ÇíÊÑèÂë≥„Åó„ÄÅ<span class="math notranslate nohighlight">\(S\cup x_i\)</span>„ÅØÁâπÂæ¥Èáè <span class="math notranslate nohighlight">\(x_i\)</span>„ÇíÈõÜÂêà„Å´Êàª„Åô„Åì„Å®„ÇíÊÑèÂë≥„Åó„Åæ„Åô„ÄÇ„Åæ„Åü<span class="math notranslate nohighlight">\(v(S)\)</span>„ÅØ<span class="math notranslate nohighlight">\(S\)</span>„Å´Âê´„Åæ„Çå„ÇãÁâπÂæ¥Èáè„ÅÆ„Åø„Çí‰ΩøÁî®„Åó„ÅüÂ†¥Âêà„ÅÆ<span class="math notranslate nohighlight">\(\hat{f}(x)\)</span>„ÅÆÂÄ§„Åß„ÅÇ„Çä„ÄÅ<span class="math notranslate nohighlight">\(Z\)</span>„ÅØÊ≠£Ë¶èÂåñÁî®„ÅÆÂÄ§„Åß„Åô„ÄÇ„Åì„ÅÆÂºè„ÅØ„ÄÅÁâπÂæ¥Èáè<span class="math notranslate nohighlight">\(i\)</span>„ÇíËøΩÂä†/ÂâäÈô§„Åô„Çã„Åì„Å®„Å´„Çà„Å£„Å¶ÂΩ¢Êàê„Åï„Çå„Çã<span class="math notranslate nohighlight">\(\hat{f}\)</span>„ÅÆÂèñ„Çä„ÅÜ„Çã„Åô„Åπ„Å¶„ÅÆÂ∑Æ„ÅÆÂπ≥Âùá„Å®Ëß£Èáà„Åô„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ</p>
<p>„Åó„Åã„Åó„ÄÅÁâπÂæ¥Èáè<span class="math notranslate nohighlight">\(i\)</span>„Çí„É¢„Éá„É´Âºè„Åã„Çâ„Å©„ÅÆ„Çà„ÅÜ„Å´„ÄåÂèñ„ÇäÈô§„Åè„Äç„Åì„Å®„Åå„Åß„Åç„Çã„Åß„Åó„Çá„ÅÜ„Åã„ÄÇÁâπÂæ¥Èáè<span class="math notranslate nohighlight">\(i\)</span>„ÇíÁÑ°Áî®„ÅÆ„ÇÇ„ÅÆ„Å®„Åó„Å¶Êâ±„ÅÜÔºàÂë®Ëæ∫Âåñ„Åô„ÇãÔºâ„Åì„Å®„Åß„Åß„Åç„Åæ„Åô„ÄÇÂë®Ëæ∫Âåñ„Å®„ÅØÁ¢∫ÁéáÂ§âÊï∞<span class="math notranslate nohighlight">\(P(x) = \int\, P(x,y)\,dy\)</span>„ÇíÁ©çÂàÜ„Åô„ÇãÊñπÊ≥ï„Åß„ÅÇ„Çã„Åì„Å®„ÇíÊÄù„ÅÑÂá∫„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ„Åì„Çå„ÅØÂèñ„Çä„ÅÜ„Çã„Åô„Åπ„Å¶„ÅÆÂÄ§<span class="math notranslate nohighlight">\(x\)</span>„ÇíÁ©çÂàÜ„Åó„Åæ„Åô„ÄÇÂë®Ëæ∫Âåñ„ÅØÁ¢∫ÁéáÂ§âÊï∞„ÅÆÈñ¢Êï∞„Å´„ÇÇ‰Ωø„ÅÜ„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ„Åù„Çå„ÅØÊòé„Çâ„Åã„Å´Á¢∫ÁéáÂ§âÊï∞„Åß„ÇÇ„ÅÇ„Çã„ÅÆ„Åß„Åô„Åå„ÄÅÊúüÂæÖÂÄ§<span class="math notranslate nohighlight">\(E_y[f | X = x] = \int\,f(X=x,y)P(X=x,y)\, dy\)</span>„ÇíÂèñ„Çã„Åì„Å®„Å´„Çà„Å£„Å¶‰Ωø„ÅÜ„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇÁ©çÂàÜ„Åß„ÅØÁ¢∫ÁéáÂ§âÊï∞<span class="math notranslate nohighlight">\(X\)</span>„ÅåÂõ∫ÂÆö„Åï„Çå„Å¶„ÅÑ„Çã„Åü„ÇÅ„ÄÅ<span class="math notranslate nohighlight">\(E_y[f]\)</span>„ÅØ<span class="math notranslate nohighlight">\(x\)</span>„ÅÆÈñ¢Êï∞„Åß„ÅÇ„Çã„Åì„Å®„ÇíÂº∑Ë™ø„Åó„Åæ„Åó„Åü„Åå„ÄÅ<span class="math notranslate nohighlight">\(x\)</span>„ÅåÂõ∫ÂÆö„Åï„Çå„Å¶„ÅÑ„ÇãÂ†¥ÊâÄÔºàÈñ¢Êï∞„ÅÆÂºïÊï∞Ôºâ<span class="math notranslate nohighlight">\(f(x,y)\)</span>„ÅÆÊúüÂæÖÂÄ§„ÇíË®àÁÆó„Åô„Çã„Åì„Å®„Å´„Çà„Å£„Å¶Èô§„Åã„Çå„Åæ„Åô„ÄÇÊú¨Ë≥™ÁöÑ„Å´„ÅØ„ÄÅ„Åô„Åπ„Å¶„ÅÆÂèñ„ÇäÂæó„ÇãÂÄ§<span class="math notranslate nohighlight">\(y\)</span>„ÅÆÂπ≥Âùá„Åß„ÅÇ„Çã<span class="math notranslate nohighlight">\(f(x,y)\)</span>„ÇíÊñ∞„Åó„ÅÑÈñ¢Êï∞<span class="math notranslate nohighlight">\(E_y[f]\)</span>„Å´ÁΩÆ„ÅçÊèõ„Åà„Å¶„ÅÑ„Åæ„Åô„ÄÇ„Åì„Åì„Åæ„Åß„Åã„Å™„ÇäË©≥Á¥∞„Å´Ë™¨Êòé„Åó„Å¶„Åç„Åæ„Åó„Åü„Åå„ÄÅ‰∏ã„ÅÆ„Ç≥„Éº„Éâ„ÇíË¶ã„Çå„Å∞Áõ¥ÊÑüÁöÑ„Å´ÁêÜËß£„Åß„Åç„Åæ„Åô„ÄÇ„ÇÇ„ÅÜ‰∏Ä„Å§‰ªò„ÅëÂä†„Åà„Çã„Å®„Åô„Çå„Å∞„ÄÅ<em>ÂÄ§</em>„Åå<span class="math notranslate nohighlight">\(\hat{f}\)</span>„ÅÆÂπ≥ÂùáÂÄ§„Å´ÂØæ„Åô„ÇãÁõ∏ÂØæÁöÑ„Å™Â§âÂåñ„Åß„ÅÇ„Çã„Å®„ÅÑ„ÅÜ„Åì„Å®„Åß„Åô„ÄÇ‰ΩôÂàÜ„Å™È†Ö„ÅØÁÑ°Ë¶ñ„Åó„Å¶„ÇÇ„Åã„Åæ„ÅÑ„Åæ„Åõ„Çì„Åå„ÄÅÂøµ„ÅÆ„Åü„ÇÅÂÖ•„Çå„Å¶„Åä„Åç„Åæ„Åô„ÄÇ„Åó„Åü„Åå„Å£„Å¶„ÄÅÂÄ§„ÅÆÊñπÁ®ãÂºè„ÅØ <span id="id28">[<a class="reference internal" href="#id210" title="Erik ≈†trumbelj and Igor Kononenko. Explaining prediction models and individual predictions with feature contributions. Knowledge and information systems, 41(3):647‚Äì665, 2014.">vStrumbeljK14</a>]</span>„Å®„Å™„Çä„Åæ„Åô„ÄÇ</p>
<div class="amsmath math notranslate nohighlight" id="equation-e9515366-de85-45dd-89c8-515e4b822a7a">
<span class="eqno">(12.8)<a class="headerlink" href="#equation-e9515366-de85-45dd-89c8-515e4b822a7a" title="Permalink to this equation">¬∂</a></span>\[\begin{equation}
v(x_i) = \int\,f(x_0, x_1, \ldots, x_i,\ldots, x_N)P(x_0, x_1, \ldots, x_i,\ldots, x_N)\, dx_i - E\left[\hat{f}(\vec{x})\right]
\end{equation}\]</div>
<p>Âë®Ëæ∫Âåñ<span class="math notranslate nohighlight">\(\int\,f(x_0, x_1, \ldots, x_i,\ldots, x_N)P(x_0, x_1, \ldots, x_i,\ldots, x_N)\, dx_i\)</span>„ÅØ„Å©„ÅÆ„Çà„ÅÜ„Å´Ë®àÁÆó„Åô„Çã„ÅÆ„Åß„Åó„Çá„ÅÜ„Åã„ÄÇÊó¢Áü•„ÅÆÁ¢∫ÁéáÂàÜÂ∏É„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ„Åù„ÅÆÂ†¥Âêà„ÄÅ„Éá„Éº„Çø„Çí<strong>ÁµåÈ®ìÁöÑ„Å™ÂàÜÂ∏É</strong>„Å®„Åó„Å¶ËÄÉ„Åà„Çã„Åì„Å®„Åß<span class="math notranslate nohighlight">\(P(\vec{x})\)</span>„Åã„Çâ„Çµ„É≥„Éó„É™„É≥„Ç∞„Åß„Åç„Åæ„Åô„ÄÇ„Åô„Å™„Çè„Å°„ÄÅ„Éá„Éº„ÇøÁÇπ„Çí„Çµ„É≥„Éó„É™„É≥„Ç∞„Åô„Çã„Åì„Å®„Åß<span class="math notranslate nohighlight">\(P(\vec{x})\)</span>„Åã„Çâ„Çµ„É≥„Éó„É™„É≥„Ç∞„Åß„Åç„Åæ„Åô„ÄÇ„Åü„Å†„Åó„ÄÅ<span class="math notranslate nohighlight">\(\vec{x}\)</span>„ÇíÂÖ±„Å´„Çµ„É≥„Éó„É™„É≥„Ç∞„Åô„ÇãÂøÖË¶Å„Åå„ÅÇ„Çã„Åü„ÇÅÂ∞ë„ÅóË§áÈõë„Åß„Åô„ÄÇÈô§„Åã„Çå„ÇãÁâπÂæ¥Èáè„Å®„ÅÆÈñì„Å´Áõ∏Èñ¢„Åå„ÅÇ„ÇãÂ†¥Âêà„ÄÅÂÄã„ÄÖ„ÅÆÁâπÂæ¥„Çí„É©„É≥„ÉÄ„É†„Å´Ê∑∑„Åú„Çã„Åì„Å®„ÅØ„Åß„Åç„Åæ„Åõ„Çì„ÄÇ</p>
<p>Strumbelj„Çâ<span id="id29">[<a class="reference internal" href="#id210" title="Erik ≈†trumbelj and Igor Kononenko. Explaining prediction models and individual predictions with feature contributions. Knowledge and information systems, 41(3):647‚Äì665, 2014.">vStrumbeljK14</a>]</span>„ÅØ<span class="math notranslate nohighlight">\(i\)</span>Áï™ÁõÆ„ÅÆ„Ç∑„É£„Éº„Éó„É¨„Ç§ÂÄ§„ÇíÁõ¥Êé•Êé®ÂÆö„Åß„Åç„Çã„Åì„Å®„ÇíÁ§∫„Åó„Åæ„Åó„Åü„ÄÇ</p>
<div class="amsmath math notranslate nohighlight" id="equation-a680914b-b140-4e97-8b3f-70b77c32bb66">
<span class="eqno">(12.9)<a class="headerlink" href="#equation-a680914b-b140-4e97-8b3f-70b77c32bb66" title="Permalink to this equation">¬∂</a></span>\[\begin{equation}
\phi_i(\vec{x}) = \frac{1}{M}\sum^M \hat{f}\left(\vec{z}_{+i}\right) - \hat{f}\left(\vec{z}_{-i}\right)
\end{equation}\]</div>
<p><span class="math notranslate nohighlight">\(\vec{z}\)</span>„ÅØ„ÄÅÂÆüÈöõ„ÅÆ‰æã<span class="math notranslate nohighlight">\(\vec{x}\)</span>„Å®„É©„É≥„ÉÄ„É†„Å™Êº´ÁÑ∂„Å®„Åó„Åü‰æã<span class="math notranslate nohighlight">\(\vec{x}'\)</span>„Åã„ÇâÊàê„Çã„Äå„Ç≠„É°„É©„Äç„ÅÆ‰æã„Åß„Åô„ÄÇ<span class="math notranslate nohighlight">\(\vec{x}\)</span>„Å®<span class="math notranslate nohighlight">\(\vec{x}'\)</span>„Åã„Çâ„É©„É≥„ÉÄ„É†„Å´ÈÅ∏Êäû„Åó„ÄÅ<span class="math notranslate nohighlight">\(\vec{z}\)</span>„ÇíÊßãÊàê„Åó„Åæ„Åô„ÄÇ<span class="math notranslate nohighlight">\(\vec{z}_{+i}\)</span>„ÅØ‰æã<span class="math notranslate nohighlight">\(\vec{x}\)</span>„ÅÆ<span class="math notranslate nohighlight">\(i\)</span>Áï™ÁõÆ„ÅÆÁâπÂæ¥Èáè„ÇíÊåÅ„Å°„ÄÅ<span class="math notranslate nohighlight">\(\vec{z}_{-i}\)</span>„ÅØ„É©„É≥„ÉÄ„É†„Å™‰æã<span class="math notranslate nohighlight">\(\vec{x}'\)</span>„ÅÆ<span class="math notranslate nohighlight">\(i\)</span>Áï™ÁõÆ„ÅÆÁâπÂæ¥Èáè„ÇíÊåÅ„Å°„Åæ„Åô„ÄÇ<span class="math notranslate nohighlight">\(M\)</span>„ÅØ„Åì„ÅÆÂÄ§„Å´ÂØæ„Åó„Å¶ËâØ„ÅÑ„Çµ„É≥„Éó„É´„ÇíÂæó„Çã„Åü„ÇÅ„Å´ÂçÅÂàÜ„Å´Â§ß„Åç„ÅèÈÅ∏„Å∞„Çå„Åæ„Åô„ÄÇ<span id="id30">[<a class="reference internal" href="#id210" title="Erik ≈†trumbelj and Igor Kononenko. Explaining prediction models and individual predictions with feature contributions. Knowledge and information systems, 41(3):647‚Äì665, 2014.">vStrumbeljK14</a>]</span>„ÅØ<span class="math notranslate nohighlight">\(M\)</span>„ÅÆÈÅ∏ÊäûÊñπÊ≥ï„Å´Èñ¢„Åô„ÇãÊåáÈáù„ÇíÁ§∫„Åó„Å¶„ÅÑ„Åæ„Åô„Åå„ÄÅÂü∫Êú¨ÁöÑ„Å´„ÅØË®àÁÆóÂèØËÉΩ„ÅßÂ¶•ÂΩì„Å™ÁØÑÂõ≤„ÅßÂ§ß„Åç„Å™<span class="math notranslate nohighlight">\(M\)</span>„ÇíÈÅ∏Êäû„Åó„Åæ„Åô„ÄÇ„Åì„ÅÆËøë‰ºº„ÅÆ‰∏Ä„Å§„ÅÆÂ§âÊõ¥ÁÇπ„ÅØ„ÄÅÊúüÂæÖÂÄ§Ôºà„Å®„Åç„Å´„ÅØ<span class="math notranslate nohighlight">\(\phi_0\)</span>„Å®Ë°®Ë®ò„Åï„Çå„ÇãÔºâ„ÇíË°®„ÅôÊòéÁ§∫ÁöÑ„Å™È†Ö„Çí‰Ωø„Å£„Å¶„ÅÑ„Çã„Åì„Å®„Åß„ÄÅ„ÄåÂÆåÂÖ®ÊÄß„Äç„ÇíÊúâ„Åô„ÇãÊñπÁ®ãÂºè„ÅØÊ¨°„ÅÆ„Çà„ÅÜ„Å´„Å™„Çä„Åæ„Åô„ÄÇ</p>
<div class="amsmath math notranslate nohighlight" id="equation-e084c33f-5b78-4cc8-8183-857c52df5d76">
<span class="eqno">(12.10)<a class="headerlink" href="#equation-e084c33f-5b78-4cc8-8183-857c52df5d76" title="Permalink to this equation">¬∂</a></span>\[\begin{equation}
\sum_i \phi_i(\vec{x}) = \hat{f}(\vec{x}) - E[\hat{f}(\vec{x})]
\end{equation}\]</div>
<p>ÊúüÂæÖÂÄ§„Çí\phi_0<span class="math notranslate nohighlight">\(„Å®„Åó„Å¶ÊòéÁ§∫ÁöÑ„Å´Âê´„ÇÅ„ÇãÂ†¥Âêà„ÄÅ„Åù„Çå„ÅØ\)</span>\vec{x}$„Å´‰æùÂ≠ò„Åó„Åæ„Åõ„Çì„ÄÇ</p>
<div class="amsmath math notranslate nohighlight" id="equation-5b87aad5-c675-40cd-a9c6-8f753b16f57c">
<span class="eqno">(12.11)<a class="headerlink" href="#equation-5b87aad5-c675-40cd-a9c6-8f753b16f57c" title="Permalink to this equation">¬∂</a></span>\[\begin{equation}
\phi_0 + \sum_{i=1} \phi_i(\vec{x}) = \hat{f}(\vec{x})
\end{equation}\]</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>ÁâπÂæ¥Èáè„ÇíÂë®Ëæ∫Âåñ„Åô„Çã„Åì„Å®„ÅØ„ÄÅÁâπÂæ¥Èáè„Çí„Åù„ÅÆÂπ≥Âùá„Å´ÁΩÆ„ÅçÊèõ„Åà„Çã„Åì„Å®„Å®„ÅØ<em>Áï∞„Å™„Çä„Åæ„Åô</em>„ÄÇ</p>
</aside>
<p>„Åì„ÅÆÂäπÁéáÁöÑ„Å™Ëøë‰ººÊñπÊ≥ï„ÄÅÂº∑Âäõ„Å™ÁêÜË´ñ„ÄÅ„É¢„Éá„É´Èùû‰æùÂ≠òÁîü„Å´„Çà„Çä„ÄÅ„Ç∑„É£„Éº„Éó„É¨„Ç§ÂÄ§„ÅØ‰∫àÊ∏¨ÂÄ§„Å´ÂØæ„Åô„ÇãÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶„ÇíË®òËø∞„Åô„Çã„ÅÆ„Å´ÂÑ™„Çå„ÅüÈÅ∏ÊäûËÇ¢„Å®„Å™„Çä„Åæ„Åô„ÄÇ</p>
</section>
</section>
<section id="notebook">
<h2><span class="section-number">12.3. </span>Notebook„ÅÆÂÆüË°å<a class="headerlink" href="#notebook" title="Permalink to this headline">¬∂</a></h2>
<p>„Åì„ÅÆ„Éö„Éº„Ç∏‰∏äÈÉ®„ÅÆ ¬†<i aria-label="Launch interactive content" class="fas fa-rocket"></i>¬† „ÇíÊäº„Åô„Å®„ÄÅ„Åì„ÅÆ„Éé„Éº„Éà„Éñ„ÉÉ„ÇØ„ÅåGoogle Colab.„ÅßÈñã„Åã„Çå„Åæ„Åô„ÄÇÂøÖË¶Å„Å™„Éë„ÉÉ„Ç±„Éº„Ç∏„ÅÆ„Ç§„É≥„Çπ„Éà„Éº„É´ÊñπÊ≥ï„Å´„Å§„ÅÑ„Å¶„ÅØ‰ª•‰∏ã„ÇíÂèÇÁÖß„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
<div class="dropdown admonition tip">
<p class="admonition-title">Tip</p>
<p>ÂøÖË¶Å„Å™„Éë„ÉÉ„Ç±„Éº„Ç∏„Çí„Ç§„É≥„Çπ„Éà„Éº„É´„Åô„Çã„Å´„ÅØ„ÄÅÊñ∞Ë¶è„Çª„É´„Çí‰ΩúÊàê„Åó„Å¶Ê¨°„ÅÆ„Ç≥„Éº„Éâ„ÇíÂÆüË°å„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!pip install dmol-book
</pre></div>
</div>
<p>„ÇÇ„Åó„Ç§„É≥„Çπ„Éà„Éº„É´„Åå„ÅÜ„Åæ„Åè„ÅÑ„Åã„Å™„ÅÑÂ†¥Âêà„ÄÅ„Éë„ÉÉ„Ç±„Éº„Ç∏„ÅÆ„Éê„Éº„Ç∏„Éß„É≥‰∏ç‰∏ÄËá¥„ÅåÂéüÂõ†„Åß„ÅÇ„ÇãÂèØËÉΩÊÄß„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇÂãï‰ΩúÁ¢∫Ë™ç„Åå„Å®„Çå„ÅüÊúÄÊñ∞„Éê„Éº„Ç∏„Éß„É≥„ÅÆ‰∏ÄË¶ß„ÅØ<a class="reference external" href="https://github.com/whitead/dmol-book/blob/master/package/requirements.txt">„Åì„Åì</a>„Åã„ÇâÂèÇÁÖß„Åß„Åç„Åæ„Åô</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">haiku</span> <span class="k">as</span> <span class="nn">hk</span>
<span class="kn">import</span> <span class="nn">jax</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">jnp</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">urllib</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">from</span> <span class="nn">jax.example_libraries</span> <span class="kn">import</span> <span class="n">optimizers</span> <span class="k">as</span> <span class="n">opt</span>
<span class="kn">import</span> <span class="nn">dmol</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">ALPHABET</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;-&quot;</span><span class="p">,</span>
    <span class="s2">&quot;A&quot;</span><span class="p">,</span>
    <span class="s2">&quot;R&quot;</span><span class="p">,</span>
    <span class="s2">&quot;N&quot;</span><span class="p">,</span>
    <span class="s2">&quot;D&quot;</span><span class="p">,</span>
    <span class="s2">&quot;C&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Q&quot;</span><span class="p">,</span>
    <span class="s2">&quot;E&quot;</span><span class="p">,</span>
    <span class="s2">&quot;G&quot;</span><span class="p">,</span>
    <span class="s2">&quot;H&quot;</span><span class="p">,</span>
    <span class="s2">&quot;I&quot;</span><span class="p">,</span>
    <span class="s2">&quot;L&quot;</span><span class="p">,</span>
    <span class="s2">&quot;K&quot;</span><span class="p">,</span>
    <span class="s2">&quot;M&quot;</span><span class="p">,</span>
    <span class="s2">&quot;F&quot;</span><span class="p">,</span>
    <span class="s2">&quot;P&quot;</span><span class="p">,</span>
    <span class="s2">&quot;S&quot;</span><span class="p">,</span>
    <span class="s2">&quot;T&quot;</span><span class="p">,</span>
    <span class="s2">&quot;W&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Y&quot;</span><span class="p">,</span>
    <span class="s2">&quot;V&quot;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>„Åæ„Åö„ÄÅ„Ç¢„Éü„ÉéÈÖ∏ÈÖçÂàó„Å®one-hot„Éô„ÇØ„Éà„É´„ÇíÁõ∏‰∫í„Å´Â§âÊèõ„Åô„ÇãÈñ¢Êï∞„ÇíÂÆöÁæ©„Åó„Åæ„Åó„Çá„ÅÜ„ÄÇ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">seq2array</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="mi">200</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">ALPHABET</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">seq</span><span class="p">)),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">array2oh</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">o</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="mi">21</span><span class="p">))</span>
    <span class="n">o</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)),</span> <span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">o</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>


<span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span>
    <span class="s2">&quot;https://github.com/whitead/dmol-book/raw/master/data/hemolytic.npz&quot;</span><span class="p">,</span>
    <span class="s2">&quot;hemolytic.npz&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;hemolytic.npz&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">r</span><span class="p">:</span>
    <span class="n">pos_data</span><span class="p">,</span> <span class="n">neg_data</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="s2">&quot;positives&quot;</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="s2">&quot;negatives&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id31">
<h2><span class="section-number">12.4. </span>ÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶„ÅÆ‰æã<a class="headerlink" href="#id31" title="Permalink to this headline">¬∂</a></h2>
<p>„Éö„Éó„ÉÅ„Éâ„ÅåËµ§Ë°ÄÁêÉ„ÇíÁ†¥Â£ä„Åô„Çã„Åã„Å©„ÅÜ„ÅãÔºàÊ∫∂Ë°ÄÊÄßÔºâ„Çí‰∫àÊ∏¨„Åô„Çã„Éö„Éó„ÉÅ„Éâ‰∫àÊ∏¨„Çø„Çπ„ÇØ„Åß„ÄÅÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶Ê≥ï„ÅÆ‰æã„ÇíË¶ã„Å¶„Åø„Åæ„Åó„Çá„ÅÜ„ÄÇ
„Åì„Çå„ÅØ<a class="reference internal" href="layers.html"><span class="doc">Standard Layers</span></a>„ÅÆÊ∫∂Ëß£Â∫¶‰∫àÊ∏¨„ÅÆ‰æã„Å´‰ºº„Å¶„ÅÑ„Åæ„Åô„ÄÇ„Éá„Éº„Çø„ÅØ<span id="id32">[<a class="reference internal" href="#id211" title="Rainier Barrett and Andrew D. White. Investigating active learning and meta-learning for iterative peptide design. Journal of Chemical Information and Modeling, 61(1):95‚Äì105, 2021. URL: https://doi.org/10.1021/acs.jcim.0c00946, doi:10.1021/acs.jcim.0c00946.">BW21</a>]</span>„ÇíÂà©Áî®„Åó„Åæ„Åô„ÄÇ
„É¢„Éá„É´„ÅØ„Éö„Éó„ÉÅ„ÉâÈÖçÂàóÔºà‰æãÔºö<code class="docutils literal notranslate"><span class="pre">DDFRD</span></code>Ôºâ„ÇíÂèñ„ÇäËæº„Åø„ÄÅ„Åù„ÅÆ„Éö„Éó„ÉÅ„Éâ„ÅåÊ∫∂Ë°ÄÊÄß„Åß„ÅÇ„ÇãÁ¢∫Áéá„Çí‰∫àÊ∏¨„Åó„Åæ„Åô„ÄÇ
„Åì„Åì„Åß„ÅÆÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶Ê≥ï„ÅÆÁõÆÊ®ô„ÅØ„ÄÅ„Å©„ÅÆ„Ç¢„Éü„ÉéÈÖ∏„ÅåÊ∫∂Ë°ÄÊ¥ªÊÄß„Å´ÊúÄ„ÇÇÈáçË¶Å„Åß„ÅÇ„Çã„Åã„ÇíÁâπÂÆö„Åô„Çã„Åì„Å®„Åß„Åô„ÄÇ
‰∏ã„ÅÆÈñâ„Åò„Åü„Çª„É´„ÅØ„Éá„Éº„Çø„Çí„É≠„Éº„Éâ„ÅóÂá¶ÁêÜ„Åó„Å¶„Éá„Éº„Çø„Çª„ÉÉ„Éà„Å´„Åó„Åæ„Åô„ÄÇ</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create labels and stich it all into one</span>
<span class="c1"># tensor</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
    <span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">pos_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pos_data</span><span class="o">.</span><span class="n">dtype</span><span class="p">),</span>
        <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">neg_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pos_data</span><span class="o">.</span><span class="n">dtype</span><span class="p">),</span>
    <span class="p">),</span>
    <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">pos_data</span><span class="p">,</span> <span class="n">neg_data</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># we now need to shuffle before creating TF dataset</span>
<span class="c1"># so that our train/test/val splits are random</span>
<span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">pos_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>

<span class="c1"># need to add token for empty amino acid</span>
<span class="c1"># dataset just has all zeros currently</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">features</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">L</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">features</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">features</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">full_data</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">from_tensor_slices</span><span class="p">((</span><span class="n">features</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> <span class="n">labels</span><span class="p">))</span>

<span class="c1"># now split into val, test, train</span>
<span class="n">N</span> <span class="o">=</span> <span class="n">pos_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">neg_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">split</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">N</span><span class="p">)</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="n">full_data</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">split</span><span class="p">)</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">batch_size</span><span class="p">)</span>
<span class="n">nontest</span> <span class="o">=</span> <span class="n">full_data</span><span class="o">.</span><span class="n">skip</span><span class="p">(</span><span class="n">split</span><span class="p">)</span>
<span class="n">val_data</span><span class="p">,</span> <span class="n">train_data</span> <span class="o">=</span> <span class="n">nontest</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">split</span><span class="p">)</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">batch_size</span><span class="p">),</span> <span class="n">nontest</span><span class="o">.</span><span class="n">skip</span><span class="p">(</span>
    <span class="n">split</span>
<span class="p">)</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">batch_size</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>JaxÔºà<a class="reference external" href="https://github.com/deepmind/dm-haiku">Haiku</a>„Çí‰ΩøÁî®Ôºâ„ÅßÁï≥„ÅøËæº„Åø„É¢„Éá„É´„ÇíÂÜçÊßãÁØâ„Åó„ÄÅÂãæÈÖç„Çí„ÇÇ„ÅÜÂ∞ë„ÅóÁ∞°Âçò„Å´Êâ±„Åà„Çã„Çà„ÅÜ„Å´„Åó„Åæ„Åô„ÄÇ„Åæ„Åü„Åù„ÅÆ‰ªñ„Å´„ÇÇ„ÅÑ„Åè„Å§„Åã„É¢„Éá„É´„Å´Â§âÊõ¥„ÇíÂä†„Åà„Å¶„ÅÑ„Åæ„Åô„ÄÇÁï≥„ÅøËæº„Åø„Å´Âä†„Åà„Å¶„ÄÅÈÖçÂàó„ÅÆÈï∑„Åï„Å®„Ç¢„Éü„ÉéÈÖ∏„ÅÆÂâ≤Âêà„ÇÇËøΩÂä†ÊÉÖÂ†±„Å®„Åó„Å¶Ê∏°„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">binary_cross_entropy</span><span class="p">(</span><span class="n">logits</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Binary cross entropy without sigmoid. Works with logits directly&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">jnp</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">logits</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-</span> <span class="n">logits</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">jnp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">logits</span><span class="p">)))</span>
    <span class="p">)</span>


<span class="k">def</span> <span class="nf">model_fn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="c1"># get fractions, excluding skip character</span>
    <span class="n">aa_fracs</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">:]</span>
    <span class="c1"># compute convolutions/poolings</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">:],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">kernel</span><span class="p">,</span> <span class="n">pool</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">Conv1D</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">mask</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">MaxPool</span><span class="p">(</span><span class="n">pool</span><span class="p">,</span> <span class="n">pool</span><span class="p">,</span> <span class="s2">&quot;VALID&quot;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">MaxPool</span><span class="p">(</span><span class="n">pool</span><span class="p">,</span> <span class="n">pool</span><span class="p">,</span> <span class="s2">&quot;VALID&quot;</span><span class="p">)(</span><span class="n">mask</span><span class="p">)</span>
    <span class="c1"># combine fractions, length, and convolution ouputs</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">hk</span><span class="o">.</span><span class="n">Flatten</span><span class="p">()(</span><span class="n">x</span><span class="p">),</span> <span class="n">aa_fracs</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># dense layers. no bias, so zeros give P=0.5</span>
    <span class="n">logits</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="n">hk</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="n">with_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
            <span class="n">jax</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">tanh</span><span class="p">,</span>
            <span class="n">hk</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">with_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
            <span class="n">jax</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">tanh</span><span class="p">,</span>
            <span class="n">hk</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">with_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
        <span class="p">]</span>
    <span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">logits</span>


<span class="n">model</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">without_apply_rng</span><span class="p">(</span><span class="n">hk</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">model_fn</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">loss_fn</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">logits</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">binary_cross_entropy</span><span class="p">(</span><span class="n">logits</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>


<span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span> <span class="nf">hemolytic_prob</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">logits</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">jax</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">logits</span><span class="p">))</span>


<span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span> <span class="nf">accuracy_fn</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">logits</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">logits</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">logits</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">y</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rng</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">xi</span><span class="p">,</span> <span class="n">yi</span> <span class="o">=</span> <span class="n">features</span><span class="p">[:</span><span class="n">batch_size</span><span class="p">],</span> <span class="n">labels</span><span class="p">[:</span><span class="n">batch_size</span><span class="p">]</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">rng</span><span class="p">,</span> <span class="n">xi</span><span class="p">)</span>

<span class="n">opt_init</span><span class="p">,</span> <span class="n">opt_update</span><span class="p">,</span> <span class="n">get_params</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">adam</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">)</span>
<span class="n">opt_state</span> <span class="o">=</span> <span class="n">opt_init</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>


<span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">opt_state</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">value</span><span class="p">,</span> <span class="n">grads</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">value_and_grad</span><span class="p">(</span><span class="n">loss_fn</span><span class="p">)(</span><span class="n">get_params</span><span class="p">(</span><span class="n">opt_state</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">opt_state</span> <span class="o">=</span> <span class="n">opt_update</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">grads</span><span class="p">,</span> <span class="n">opt_state</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">value</span><span class="p">,</span> <span class="n">opt_state</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:absl:No GPU/TPU found, falling back to CPU. (Set TF_CPP_MIN_LOG_LEVEL=0 and rerun for more info.)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span> <span class="o">=</span> <span class="mi">32</span>
<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
    <span class="n">avg_v</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train_data</span><span class="p">):</span>
        <span class="n">v</span><span class="p">,</span> <span class="n">opt_state</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">opt_state</span><span class="p">,</span> <span class="n">xi</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="n">yi</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
        <span class="n">avg_v</span> <span class="o">+=</span> <span class="n">v</span>
<span class="n">opt_params</span> <span class="o">=</span> <span class="n">get_params</span><span class="p">(</span><span class="n">opt_state</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">opt_params</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">predict_prob</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">hemolytic_prob</span><span class="p">(</span><span class="n">opt_params</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>„ÇÇ„Åó„ÄÅ„Ç≥„Éº„Éâ„ÇíËøΩ„ÅÜ„ÅÆ„ÅåÂ§ßÂ§â„Åß„ÇÇÂ§ß‰∏àÂ§´„Åß„ÅôÔºÅ„Åì„ÅÆÁ´†„ÅÆ„Ç¥„Éº„É´„ÅØ„É¢„Éá„É´„ÅÆË™¨Êòé„ÇíÂæó„ÇãÊñπÊ≥ï„ÇíÁ§∫„Åô„Åì„Å®„Åß„ÅÇ„Çä„ÄÅÂøÖ„Åö„Åó„ÇÇ„É¢„Éá„É´„ÇíÊßãÁØâ„Åô„ÇãÊñπÊ≥ï„Åß„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ„Åß„Åô„Åã„Çâ„ÄÅÊ¨°„ÅÆÊï∞Ë°å„Å´Ê≥®ÁõÆ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ„Åì„Åì„Åß„ÅØ„ÄÅ‰∫àÊ∏¨ÂÄ§„ÇíÂæó„Å¶„Åù„Çå„ÇíË™¨Êòé„Åô„Çã„Åü„ÇÅ„Å´„ÄÅ„Å©„ÅÆ„Çà„ÅÜ„Å´„É¢„Éá„É´„Çí‰Ωø„ÅÜ„Åã„ÇíË™¨Êòé„Åó„Åæ„Åô„ÄÇ„É¢„Éá„É´„ÅØ„ÄÅlogits„ÅÆÂ†¥Âêà„ÅØ <code class="docutils literal notranslate"><span class="pre">predict(x)</span></code> „ÄÅÁ¢∫Áéá„ÅÆÂ†¥Âêà„ÅØ <code class="docutils literal notranslate"><span class="pre">predict_prob</span></code> „Çí‰ªã„Åó„Å¶Âëº„Å≥Âá∫„Åï„Çå„Åæ„Åô„ÄÇ</p>
<aside class="margin sidebar">
<p class="sidebar-title">Sequence Models</p>
<p>one-hot„Ç®„É≥„Ç≥„Éº„Éá„Ç£„É≥„Ç∞„Å®ÈÖçÂàó„É¢„Éá„É´„Å´„Å§„ÅÑ„Å¶„ÅØ<a class="reference internal" href="NLP.html"><span class="doc">Deep Learning on Sequences</span></a>„ÇíÂèÇÁÖß„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
</aside>
<p>„Ç¢„Éü„ÉéÈÖ∏ÈÖçÂàó„ÄÅ„Éö„Éó„ÉÅ„Éâ„ÇíË©¶„Åó„Å¶„ÄÅ„É¢„Éá„É´„ÅÆ„Ç§„É°„Éº„Ç∏„Çí„Å§„Åã„Çì„Åß„Åø„Åæ„Åó„Çá„ÅÜ„ÄÇ„É¢„Éá„É´„ÅØlogitsÔºà„Ç™„ÉÉ„Ç∫„ÅÆÂØæÊï∞Ôºâ„ÇíÂá∫Âäõ„Åó„ÄÅ„Åì„Çå„Çí„Ç∑„Ç∞„É¢„Ç§„ÉâÈñ¢Êï∞„Å´„Åã„Åë„Çã„Å®Á¢∫Áéá„ÅåÂæó„Çâ„Çå„Åæ„Åô„ÄÇ„Éö„Éó„ÉÅ„Éâ„ÅØÈÖçÂàó„Åã„Çâone-hot„Éô„ÇØ„Éà„É´„ÅÆË°åÂàó„Å´Â§âÊèõ„Åô„ÇãÂøÖË¶Å„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ„Åì„Åì„Åß„ÅØ„ÄÅ2„Å§„ÅÆÊó¢Áü•„ÅÆÈÖçÂàó„ÇíË©¶„Åó„Å¶„Åø„Åæ„Åó„Çá„ÅÜ„ÄÇQ„ÅØÊ∫∂Ë°ÄÁîüÊÆãÂü∫„Å®„Åó„Å¶„Çà„ÅèÁü•„Çâ„Çå„Å¶„Åä„Çä„ÄÅ2Áï™ÁõÆ„ÅÆÈÖçÂàó„ÅØ„Éù„É™G„Åß„ÄÅ„Åì„Çå„ÅØÊúÄ„ÇÇÂçòÁ¥î„Å™„Ç¢„Éü„ÉéÈÖ∏„Åß„Åô„ÄÇ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;QQQQQ&quot;</span>
<span class="n">sm</span> <span class="o">=</span> <span class="n">array2oh</span><span class="p">(</span><span class="n">seq2array</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">predict_prob</span><span class="p">(</span><span class="n">sm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Probability </span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2"> of being hemolytic </span><span class="si">{</span><span class="n">p</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;GGGGG&quot;</span>
<span class="n">sm</span> <span class="o">=</span> <span class="n">array2oh</span><span class="p">(</span><span class="n">seq2array</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">predict_prob</span><span class="p">(</span><span class="n">sm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Probability </span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2"> of being hemolytic </span><span class="si">{</span><span class="n">p</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Probability QQQQQ of being hemolytic 1.00
Probability GGGGG of being hemolytic 0.00
</pre></div>
</div>
</div>
</div>
<p>„Åì„Çå„ÅØÂ¶•ÂΩì„Å™ÁµêÊûú„Å´Ë¶ã„Åà„Åæ„Åô„ÄÇ„É¢„Éá„É´„ÅÆÂá∫Âäõ„ÅØ„ÄÅ„Åì„Çå„Çâ„ÅÆ2„Å§„ÅÆÈÖçÂàó„Å´Èñ¢„Åô„ÇãÁßÅ„Åü„Å°„ÅÆÁõ¥ÊÑü„Å´‰∏ÄËá¥„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ</p>
<p>„Åï„Å¶„ÄÅ„Åì„ÅÆ„É¢„Éá„É´„ÅÆÊ≠£Á¢∫Â∫¶„ÇíË®àÁÆó„Åó„Åæ„Åó„Çá„ÅÜ„ÄÇÈùûÂ∏∏„Å´ËâØ„ÅÑÁµêÊûú„ÅåÂæó„Çâ„Çå„Åæ„Åô„ÄÇ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">acc</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">xi</span><span class="p">,</span> <span class="n">yi</span> <span class="ow">in</span> <span class="n">test_data</span><span class="p">:</span>
    <span class="n">acc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_fn</span><span class="p">(</span><span class="n">opt_params</span><span class="p">,</span> <span class="n">xi</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="n">yi</span><span class="o">.</span><span class="n">numpy</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">acc</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.95208335
</pre></div>
</div>
</div>
</div>
<section id="id33">
<h3><span class="section-number">12.4.1. </span>ÂãæÈÖç<a class="headerlink" href="#id33" title="Permalink to this headline">¬∂</a></h3>
<p>„Åß„ÅØ„ÄÅ<em>„Å™„Åú</em>„ÅÇ„ÇãÈÖçÂàó„ÅåÊ∫∂Ë°ÄÊÄß„Å®„Å™„Çã„ÅÆ„ÅãË™ø„Åπ„Å¶„Åø„Åæ„Åó„Çá„ÅÜ„ÄÇ„Åæ„Åö„ÄÅÂÖ•Âäõ„Å´ÂØæ„Åô„ÇãÂãæÈÖç„ÇíË®àÁÆó„Åô„Çã„Åì„Å®„Åã„ÇâÂßã„ÇÅ„Åæ„Åô„ÄÇ„Åì„Çå„ÅØÁ¥†Êú¥„Å™„Ç¢„Éó„É≠„Éº„ÉÅ„Åßshattered gradients„Å´„Å™„Çä„ÇÑ„Åô„ÅÑ„Åß„Åô„Åå„ÄÅ„Åì„ÅÆÂæåË®àÁÆó„Åô„Çãintegrated gradients„Å®smooth gradients„ÅÆ„Éó„É≠„Çª„Çπ„ÅÆ‰∏ÄÈÉ®„Åß„ÅÇ„Çä„ÄÅÁÑ°ÈßÑ„Åß„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ„Åù„Çå„Åß„ÅØÊ∫∂Ë°ÄÊÄß„Åß„ÅÇ„Çã„Åì„Å®„ÅåÁü•„Çâ„Çå„Å¶„ÅÑ„Çã„ÄÅ„Çà„ÇäË§áÈõë„Å™„Éö„Éó„ÉÅ„ÉâÈÖçÂàó„Çí‰Ωø„Å£„Å¶„ÄÅ„Çà„ÇäËààÂë≥Ê∑±„ÅÑËß£Êûê„Çí„Åó„Å¶„Åø„Åæ„Åó„Çá„ÅÜ„ÄÇ</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_grad</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="c1"># g = np.array(g)</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)),</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">ALPHABET</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">s</span><span class="p">))]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">g</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)),</span> <span class="n">height</span><span class="o">=</span><span class="n">h</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Amino Acid $x_i$&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Gradient $\frac{\partial \hat</span><span class="si">{f}</span><span class="s2">(\vec</span><span class="si">{x}</span><span class="s2">)}{\partial x_i}$&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;RAGLQFPVGRLLRRLLRRLLR&quot;</span>
<span class="n">sm</span> <span class="o">=</span> <span class="n">array2oh</span><span class="p">(</span><span class="n">seq2array</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">predict_prob</span><span class="p">(</span><span class="n">sm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Probability </span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2"> of being hemolytic </span><span class="si">{</span><span class="n">p</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Probability RAGLQFPVGRLLRRLLRRLLR of being hemolytic 1.00
</pre></div>
</div>
</div>
</div>
<p>„Ç≥„Éº„Éâ„ÅØËá≥„Å£„Å¶„Ç∑„É≥„Éó„É´„Åß„Åô„ÄÇ„Åù„Çå„Åß„ÅØÂãæÈÖç„ÇíË®àÁÆó„Åó„Å¶„Åø„Åæ„Åó„Çá„ÅÜ„ÄÇ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gradient</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">grad</span><span class="p">(</span><span class="n">predict</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">gradient</span><span class="p">(</span><span class="n">sm</span><span class="p">)</span>
<span class="n">plot_grad</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/xai_24_0.png" src="../_images/xai_24_0.png" />
</div>
</div>
<p>„É¢„Éá„É´„ÅØlogits„ÇíÂá∫Âäõ„Åô„Çã„Åì„Å®„ÇíÂøò„Çå„Å™„ÅÑ„Åß„Åè„Å†„Åï„ÅÑ„ÄÇÂãæÈÖç„ÅåÊ≠£„ÅÆÂÄ§„Åß„ÅÇ„Çå„Å∞„ÄÅ„Åù„ÅÆ„Ç¢„Éü„ÉéÈÖ∏„ÅåÊ∫∂Ë°ÄÊÄß„Åß„ÅÇ„ÇãÁ¢∫Áéá„ÇíÈ´ò„ÇÅ„ÄÅË≤†„ÅÆÂÄ§„Åß„ÅÇ„Çå„Å∞„Åù„ÅÆ„Ç¢„Éü„ÉéÈÖ∏ÈÖçÂàó„ÅåÈùûÊ∫∂Ë°ÄÊÄß„Åß„ÅÇ„ÇãÁ¢∫Áéá„ÇíÈ´ò„ÇÅ„Çã„Åì„Å®„ÇíÊÑèÂë≥„Åó„Åæ„Åô„ÄÇËààÂë≥Ê∑±„ÅÑ„Åì„Å®„Å´„ÄÅ„É≠„Ç§„Ç∑„É≥(L)„Å®„Ç¢„É´„ÇÆ„Éã„É≥(R)„ÅØÂº∑„ÅÑ‰ΩçÁΩÆ‰æùÂ≠òÊÄß„Åå„ÅÇ„Çã„Åì„Å®„Åå„Çè„Åã„Çä„Åæ„Åô„ÄÇ</p>
</section>
<section id="integrated-gradients">
<h3><span class="section-number">12.4.2. </span>Integrated Gradients<a class="headerlink" href="#integrated-gradients" title="Permalink to this headline">¬∂</a></h3>
<p>Ê¨°„Å´integrated gradientsÊ≥ï„ÇíÂÆüË£Ö„Åó„Åæ„Åô„ÄÇ3„Å§„ÅÆÂü∫Êú¨ÁöÑ„Å™„Çπ„ÉÜ„ÉÉ„Éó„ÇíË∏è„Åø„Åæ„Åô„ÄÇ</p>
<ol class="simple">
<li><p>„Éô„Éº„Çπ„É©„Ç§„É≥„Åã„ÇâÂÖ•Âäõ„Éö„Éó„ÉÅ„Éâ„Å´Âêë„Åã„ÅÜÂÖ•ÂäõÈÖçÂàóÔºàÁµåË∑ØÔºâ„Çí‰Ωú„Çä„Åæ„Åô„ÄÇ</p></li>
<li><p>ÂêÑÂÖ•Âäõ„Å´ÂØæ„Åó„Å¶ÂãæÈÖç„ÇíË®àÁÆó„Åó„Åæ„Åô„ÄÇ</p></li>
<li><p>ÂãæÈÖç„ÅÆÂêàË®à„ÇíË®àÁÆó„Åó„ÄÅ„Åù„Çå„Å´„Éô„Éº„Çπ„É©„Ç§„É≥„Å®„Éö„Éó„ÉÅ„Éâ„ÅÆÂ∑Æ„Çí‰πó„Åò„Åæ„Åô„ÄÇ</p></li>
</ol>
<p>„Éô„Éº„Çπ„É©„Ç§„É≥„ÅØ„Åô„Åπ„Å¶0„Åß„ÅÇ„Çä„ÄÅ0.5„ÅÆÁ¢∫Áéá„Çí‰∏é„Åà„Åæ„Åô (logits = 0, a model root)„ÄÇ„Åì„ÅÆ„Éô„Éº„Çπ„É©„Ç§„É≥„ÅØ„Åæ„Åï„Å´Ê±∫ÂÆöÂ¢ÉÁïå‰∏ä„Å´„ÅÇ„Çä„Åæ„Åô„ÄÇ„Åô„Åπ„Å¶„ÅÆ„Ç∞„É™„Ç∑„É≥„ÇÑ„Ç¢„É©„Éã„É≥„ÅÆ„Çà„ÅÜ„Å´‰ªñ„ÅÆ„Éô„Éº„Çπ„É©„Ç§„É≥„Çí‰Ωø„ÅÜ„Åì„Å®„ÇÇ„Åß„Åç„Åæ„Åô„Åå„ÄÅ„Åù„Çå„Çâ„ÅØ0.5„ÅÆÁ¢∫Áéá„Åã„Åù„Çå„Å´Ëøë„ÅÑ„ÇÇ„ÅÆ„Åß„ÅÇ„Çã„Åπ„Åç„Åß„Åô„ÄÇ„Éô„Éº„Çπ„É©„Ç§„É≥ÈÅ∏Êäû„ÅÆË©≥Á¥∞„Å®„Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„Éñ„Å™Êé¢Á¥¢„ÅØ<span id="id34">[<a class="reference internal" href="#id209" title="Pascal Sturmfels, Scott Lundberg, and Su-In Lee. Visualizing the impact of feature attribution baselines. Distill, 2020. https://distill.pub/2020/attribution-baselines. doi:10.23915/distill.00022.">SLL20</a>]</span>„ÇíË¶ã„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">integrated_gradients</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="n">baseline</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="mi">21</span><span class="p">))</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">baseline</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">sm</span> <span class="o">*</span> <span class="n">t</span>

    <span class="k">def</span> <span class="nf">get_grad</span><span class="p">(</span><span class="n">pi</span><span class="p">):</span>
        <span class="c1"># compute gradient</span>
        <span class="c1"># add/remove batch axes</span>
        <span class="k">return</span> <span class="n">gradient</span><span class="p">(</span><span class="n">pi</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="o">...</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">gs</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="n">get_grad</span><span class="p">)(</span><span class="n">path</span><span class="p">)</span>
    <span class="c1"># sum pieces (Riemann sum), multiply by (x - x&#39;)</span>
    <span class="n">ig</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">gs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">sm</span> <span class="o">-</span> <span class="n">baseline</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ig</span>


<span class="n">ig</span> <span class="o">=</span> <span class="n">integrated_gradients</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_grad</span><span class="p">(</span><span class="n">ig</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/xai_27_0.png" src="../_images/xai_27_0.png" />
</div>
</div>
<p>‰ΩçÁΩÆ‰æùÂ≠òÊÄß„Åå„Çà„ÇäÈ°ïËëó„Å´„Å™„Çä„ÄÅ„Ç¢„É´„ÇÆ„Éã„É≥„ÅØ‰ΩçÁΩÆ„Å´ÂØæ„Åó„Å¶ÈùûÂ∏∏„Å´ÊïèÊÑü„Åß„ÅÇ„Çã„Åì„Å®„Åå„Çè„Åã„Çä„Åæ„Åô„ÄÇÂÖàÁ®ã„ÅÆÈÄöÂ∏∏„ÅÆÂãæÈÖç„Å®ÊØîËºÉ„Åô„Çã„Å®„ÄÅË≥™ÁöÑ„Å™Â§âÂåñ„ÅØ„ÅÇ„Åæ„Çä„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ</p>
</section>
<section id="smoothgrad">
<h3><span class="section-number">12.4.3. </span>SmoothGrad<a class="headerlink" href="#smoothgrad" title="Permalink to this headline">¬∂</a></h3>
<p>SmmotGrad„ÇíË°å„ÅÜ„Çπ„ÉÜ„ÉÉ„Éó„ÅØintegrated gradients„Å®„Åª„Å®„Çì„Å©Âêå„Åò„Åß„Åô„ÄÇ</p>
<ol class="simple">
<li><p>ÂÖ•Âäõ„Éö„Éó„ÉÅ„Éâ„Å´„É©„É≥„ÉÄ„É†„Å™ÊëÇÂãï„ÇíÂä†„Åà„ÅüÂÖ•ÂäõÈÖçÂàóÔºàÁµåË∑ØÔºâ„Çí‰ΩúÊàê„Åó„Åæ„Åô„ÄÇ</p></li>
<li><p>ÂêÑÂÖ•Âäõ„ÅÆÂãæÈÖç„ÇíË®àÁÆó„Åó„Åæ„Åô„ÄÇ</p></li>
<li><p>ÂãæÈÖç„ÅÆÂπ≥Âùá„ÇíË®àÁÆó„Åó„Åæ„Åô„ÄÇ</p></li>
</ol>
<p>„Éè„Ç§„Éë„Éº„Éë„É©„É°„Éº„Çø„Å®„Åó„Å¶„ÄÅ<span class="math notranslate nohighlight">\(\sigma\)</span>„Åå„ÅÇ„Çä„ÄÅÂéüÁêÜÁöÑ„Å´„ÅØ„É¢„Éá„É´„ÅÆÂá∫Âäõ„ÇíÂ§âÂåñ„Åï„Åõ„Å™„Åå„Çâ„ÄÅ„Åß„Åç„Çã„Å†„ÅëÂ∞è„Åï„Åè„Åô„ÇãÂøÖË¶Å„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">smooth_gradients</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">rng</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">):</span>
    <span class="n">baseline</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="mi">21</span><span class="p">))</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">rng</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">sm</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sm</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span> <span class="o">*</span> <span class="n">sigma</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">sm</span> <span class="o">+</span> <span class="n">t</span>
    <span class="c1"># remove examples that are negative and force summing to 1</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">path</span> <span class="o">/=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_grad</span><span class="p">(</span><span class="n">pi</span><span class="p">):</span>
        <span class="c1"># compute gradient</span>
        <span class="c1"># add/remove batch axes</span>
        <span class="k">return</span> <span class="n">gradient</span><span class="p">(</span><span class="n">pi</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="o">...</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">gs</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="n">get_grad</span><span class="p">)(</span><span class="n">path</span><span class="p">)</span>
    <span class="c1"># mean</span>
    <span class="n">ig</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">gs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ig</span>


<span class="n">sg</span> <span class="o">=</span> <span class="n">smooth_gradients</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">plot_grad</span><span class="p">(</span><span class="n">sg</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/xai_29_0.png" src="../_images/xai_29_0.png" />
</div>
</div>
<p>ÈÄöÂ∏∏„ÅÆÂãæÈÖç„ÅÆÁµêÊûú„Å´ÈÖ∑‰ºº„Åó„Å¶„ÅÑ„Çã„Çà„ÅÜ„Å´Ë¶ã„Åà„Åæ„Åô„ÄÇ„Åì„Çå„ÅØ„ÄÅ1Ê¨°ÂÖÉ„ÅÆÂÖ•Âäõ„Å®ÊµÖ„ÅÑ„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„Åå„ÄÅshattered gradients„Å´ÂØæ„Åó„Å¶„Åù„Çå„Åª„Å©ÊïèÊÑü„Åß„ÅØ„Å™„ÅÑ„Åü„ÇÅ„Å®ÊÄù„Çè„Çå„Åæ„Åô„ÄÇ</p>
</section>
<section id="id35">
<h3><span class="section-number">12.4.4. </span>„Ç∑„É£„Éº„Éó„É¨„Ç§ÂÄ§<a class="headerlink" href="#id35" title="Permalink to this headline">¬∂</a></h3>
<p>Ê¨°„Å´„ÄÅÂºè10.9„Çí‰Ωø„Å£„Å¶ÂêÑÁâπÂæ¥Èáè„Å´ÂØæ„Åô„Çã„Ç∑„É£„Éº„Éó„É¨„Ç§ÂÄ§„ÇíËøë‰ºº„Åó„Å¶„Åø„Åæ„Åó„Çá„ÅÜ„ÄÇ„Ç∑„É£„Éº„Éó„É¨„Ç§ÂÄ§„ÅÆË®àÁÆó„ÅØÂãæÈÖç„ÇíÂøÖË¶Å„Å®„Åó„Å™„ÅÑ„Åü„ÇÅ„ÄÅ„Åì„Çå„Åæ„Åß„ÅÆ„Ç¢„Éó„É≠„Éº„ÉÅ„Å®„ÅØÁï∞„Å™„Çä„Åæ„Åô„ÄÇÂü∫Êú¨ÁöÑ„Å™„Ç¢„É´„Ç¥„É™„Ç∫„É†„ÅØÊ¨°„ÅÆ„Çà„ÅÜ„Å´„Å™„Çä„Åæ„Åô„ÄÇ</p>
<ol class="simple">
<li><p>„É©„É≥„ÉÄ„É†„Å™ÁÇπx‚Äô„ÇíÈÅ∏Êäû„Åó„Åæ„Åô„ÄÇ</p></li>
<li><p>x„Å®x‚Äô„ÇíÁµÑ„ÅøÂêà„Çè„Åõ„Å¶ÁÇπ<span class="math notranslate nohighlight">\(z\)</span>„Çí‰Ωú„Çä„Åæ„Åô„ÄÇ</p></li>
<li><p>‰∫àÊ∏¨Èñ¢Êï∞„ÅÆÂ§âÂåñ„ÇíË®àÁÆó„Åó„Åæ„Åô„ÄÇ</p></li>
</ol>
<p>ÂäπÁéáÂåñ„ÅÆ„Åü„ÇÅ„Å´Ë°å„Å£„Åü1„Å§„ÅÆÂ∑•Â§´„ÅØ„ÄÅ„Éë„Éá„Ç£„É≥„Ç∞„ÅßÈÖçÂàó„ÇíÂ§âÊõ¥„Åó„Å™„ÅÑ„Çà„ÅÜ„Å´„Åô„Çã„Åì„Å®„Åß„Åô„ÄÇÂü∫Êú¨ÁöÑ„Å´ÈÖçÂàó„ÇíÈï∑„Åè„Åô„Çã„Çà„ÅÜ„Å™„Åì„Å®„ÅØ„Åó„Å™„ÅÑ„Çà„ÅÜ„Å´„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">shapley</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">sm</span><span class="p">,</span> <span class="n">sampled_x</span><span class="p">,</span> <span class="n">rng</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
    <span class="n">M</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">sampled_x</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">z_choice</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">bernoulli</span><span class="p">(</span><span class="n">rng</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">F</span><span class="p">))</span>
    <span class="c1"># only swap out features within length of sm</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">sm</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">:],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">z_choice</span> <span class="o">*=</span> <span class="n">mask</span>
    <span class="n">z_choice</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">z_choice</span>
    <span class="c1"># construct with and w/o ith feature</span>
    <span class="n">z_choice</span> <span class="o">=</span> <span class="n">z_choice</span><span class="o">.</span><span class="n">at</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">z_choice_i</span> <span class="o">=</span> <span class="n">z_choice</span><span class="o">.</span><span class="n">at</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="c1"># select them via multiplication</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">sm</span> <span class="o">*</span> <span class="n">z_choice</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">+</span> <span class="n">sampled_x</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">z_choice</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">newaxis</span><span class="p">])</span>
    <span class="n">z_i</span> <span class="o">=</span> <span class="n">sm</span> <span class="o">*</span> <span class="n">z_choice_i</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">+</span> <span class="n">sampled_x</span> <span class="o">*</span> <span class="p">(</span>
        <span class="mi">1</span> <span class="o">-</span> <span class="n">z_choice_i</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">z_i</span><span class="p">)</span> <span class="o">-</span> <span class="n">model</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>


<span class="c1"># assume data is alrady shuffled, so just take M</span>
<span class="n">M</span> <span class="o">=</span> <span class="mi">4096</span>
<span class="n">sl</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="n">sampled_x</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">unbatch</span><span class="p">()</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="o">.</span><span class="n">as_numpy_iterator</span><span class="p">()</span><span class="o">.</span><span class="n">next</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># make batched shapley so we can compute for all features</span>
<span class="n">bshapley</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="n">shapley</span><span class="p">,</span> <span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
<span class="n">sv</span> <span class="o">=</span> <span class="n">bshapley</span><span class="p">(</span>
    <span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">sl</span><span class="p">),</span>
    <span class="n">sm</span><span class="p">,</span>
    <span class="n">sampled_x</span><span class="p">,</span>
    <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">sl</span><span class="p">),</span>
    <span class="n">predict</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># compute global expectation</span>
<span class="n">eyhat</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">xi</span><span class="p">,</span> <span class="n">yi</span> <span class="ow">in</span> <span class="n">full_data</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="o">.</span><span class="n">as_numpy_iterator</span><span class="p">():</span>
    <span class="n">eyhat</span> <span class="o">+=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">predict</span><span class="p">(</span><span class="n">xi</span><span class="p">))</span>
<span class="n">eyhat</span> <span class="o">/=</span> <span class="nb">len</span><span class="p">(</span><span class="n">full_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>„Ç∑„É£„Éº„Éó„É¨„Ç§ÂÄ§„Å´Èñ¢„Åô„Çã‰∏Ä„Å§„ÅÆËâØ„ÅÑ„ÉÅ„Çß„ÉÉ„ÇØ„ÅØ„ÄÅ„Åù„Çå„Çâ„ÅÆÂêàË®à„Åå„É¢„Éá„É´Èñ¢Êï∞„ÅÆÂÄ§„Åã„Çâ„Åô„Åπ„Å¶„ÅÆ„Ç§„É≥„Çπ„Çø„É≥„Çπ„Å´„Çè„Åü„ÇãÊúüÂæÖÂÄ§„ÇíÂºï„ÅÑ„Åü„ÇÇ„ÅÆ„Å´Á≠â„Åó„ÅÑ„Åì„Å®„ÇíÁ¢∫Ë™ç„Åô„Çã„Åì„Å®„Åß„Åô„ÄÇ„Åü„Å†„Åó
<span id="id36">[<a class="reference internal" href="#id210" title="Erik ≈†trumbelj and Igor Kononenko. Explaining prediction models and individual predictions with feature contributions. Knowledge and information systems, 41(3):647‚Äì665, 2014.">vStrumbeljK14</a>]</span>„ÅÆÂºè„ÇíËøë‰ºº„Åó„Å¶‰ΩøÁî®„Åó„Å¶„ÅÑ„Çã„ÅÆ„Åß„ÄÅÂÆåÂÖ®„Å™‰∏ÄËá¥„ÅØÊúüÂæÖ„Åß„Åç„Åæ„Åõ„Çì„ÄÇ„Åì„ÅÆÂÄ§„ÅØÊ¨°„ÅÆ„Çà„ÅÜ„Å´Ë®àÁÆó„Åï„Çå„Åæ„Åô„ÄÇ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">sv</span><span class="p">),</span> <span class="n">predict</span><span class="p">(</span><span class="n">sm</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6.7373457 8.068422
</pre></div>
</div>
</div>
</div>
<p>‰∫àÊÉ≥ÈÄö„Çä„ÄÅ„ÅÑ„Åè„Çâ„ÅãÈÅï„ÅÑ„Åæ„Åô„ÄÇ„Åì„Çå„ÅØ‰ªäÂõû‰Ωø„Å£„Å¶„ÅÑ„ÇãËøë‰ººÊ≥ï„ÅÆÂΩ±Èüø„Åß„Åô„ÄÇ„Çµ„É≥„Éó„É´Êï∞„Åå„Ç∑„É£„Éº„Éó„É¨„Ç§ÂÄ§„ÅÆÂêàË®à„Å´„Å©„ÅÆ„Çà„ÅÜ„Å´ÂΩ±Èüø„Åô„Çã„Åã„ÇíË™ø„Åπ„Çã„Åì„Å®„Åß„ÄÅ„Åù„Çå„ÇíÁ¢∫Ë™ç„Åô„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ</p>
<figure class="align-default" id="shapley-convg">
<div class="cell_output docutils container">
<img alt="../_images/xai_33_0.png" src="../_images/xai_33_0.png" />
</div>
<figcaption>
<p><span class="caption-number">Fig. 12.1 </span><span class="caption-text">„Ç∑„É£„Éº„Éó„É¨„Ç§ÂÄ§Ëøë‰ºº„Å´„Åä„Åë„Çã„ÄÅ„Ç∑„É£„Éº„Éó„É¨„Ç§ÂÄ§„ÅÆÁ∑èÂíå„Å®„Çµ„É≥„Éó„É´Êï∞„ÅÆÈñ¢Êï∞„ÅÆÈñìÊï∞ÂÄ§„ÅÆÊØîËºÉ</span><a class="headerlink" href="#shapley-convg" title="Permalink to this image">¬∂</a></p>
</figcaption>
</figure>
<p>Âæê„ÄÖ„Å´ÂèéÊùü„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇÊúÄÂæå„Å´„ÄÅÂÄã„ÄÖ„ÅÆ„Ç∑„É£„Éº„Éó„É¨„Ç§ÂÄ§„ÇíË°®Á§∫„Åó„Å¶Ë¶ã„Åæ„Åó„Çá„ÅÜ„ÄÇ„Åù„Çå„Åå‰∫àÊ∏¨„Å´ÂØæ„Åô„ÇãË™¨Êòé„Å®„Å™„Çä„Åæ„Åô„ÄÇ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_grad</span><span class="p">(</span><span class="n">sv</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/xai_37_0.png" src="../_images/xai_37_0.png" />
</div>
</div>
<p>„Åì„Åì„Åæ„Åß„Å´Ë¶ã„Å¶„Åç„Åü4„Å§„ÅÆÊâãÊ≥ï„ÄÅÂãæÈÖçÊ≥ï„ÄÅIntegrated GradientÊ≥ï„ÄÅSmoothGradÊ≥ï„ÄÅ„Ç∑„É£„Éº„Éó„É¨„Ç§ÂÄ§„ÅÆÁµêÊûú„Çí‰∏¶„Åπ„Å¶Á§∫„Åó„Åæ„Åô„ÄÇ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">heights</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">gi</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="n">g</span><span class="p">,</span> <span class="n">ig</span><span class="p">,</span> <span class="n">sg</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;Gradient&quot;</span><span class="p">,</span> <span class="s2">&quot;Integrated&quot;</span><span class="p">,</span> <span class="s2">&quot;Smooth&quot;</span><span class="p">])):</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">gi</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)),</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">ALPHABET</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">s</span><span class="p">))]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">i</span> <span class="o">/</span> <span class="mi">5</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">5</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">l</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">5</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="n">sv</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">5</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Shapley&quot;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Amino Acid $x_i$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Importance [logits]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/xai_39_0.png" src="../_images/xai_39_0.png" />
</div>
</div>
<p>ÊôÆÊÆµ„Åã„Çâ„Éö„Éó„ÉÅ„Éâ„ÇíÊâ±„Å£„Å¶„ÅÑ„ÇãËÄÖ„Å®„Åó„Å¶„ÄÅ„Åì„Åì„Åß„ÅØ„Ç∑„É£„Éº„Éó„É¨„Ç§ÂÄ§„ÅåÊúÄ„ÇÇÊ≠£Á¢∫„Å†„Å®ÊÄù„ÅÑ„Åæ„Åô„ÄÇL„Å®R„ÅÆ„Éë„Çø„Éº„É≥„ÅåÈáçË¶Å„Å†„Å®„ÅØËÄÉ„Åà„Å¶„ÅÑ„Åæ„Åõ„Çì„Åß„Åó„Åü„Åå„ÄÅ„Ç∑„É£„Éº„Éó„É¨„Ç§ÂÄ§„ÅØ„Åù„ÅÜÁ§∫„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ„Åæ„Åü‰ªñ„ÅÆÊâãÊ≥ï„ÅÆÁµêÊûú„Å®Áï∞„Å™„Çä„ÄÅ„Ç∑„É£„Éº„Éó„É¨„Ç§ÂÄ§„ÅØ„Éï„Çß„Éã„É´„Ç¢„É©„Éã„É≥(F)„ÅåÈáçË¶Å„Å™ÂäπÊûú„ÇíÊåÅ„Å§„Å®„ÅØÁ§∫„Åó„Å¶„ÅÑ„Åæ„Åõ„Çì„ÄÇ</p>
<p>„Åì„ÅÆÁµêÊûú„Åã„Çâ‰Ωï„ÇíÁµêË´ñ„Å•„Åë„Çã„Åì„Å®„Åå„Åß„Åç„Çã„Åß„Åó„Çá„ÅÜ„Åã„ÄÇ„Åä„Åù„Çâ„ÅèÊ¨°„ÅÆ„Çà„ÅÜ„Å™Ë™¨Êòé„ÇíÂä†„Åà„Çã„Åì„Å®„Åå„Åß„Åç„Çã„Åß„Åó„Çá„ÅÜ„ÄÇ„Äå„Åì„ÅÆÈÖçÂàó„ÅØ„ÄÅ‰∏ª„Å´„Ç∞„É´„Çø„Éü„É≥„ÄÅ„Éó„É≠„É™„É≥„ÄÅ„Åù„Åó„Å¶„É≠„Ç§„Ç∑„É≥„Å®„Ç¢„É´„ÇÆ„Éã„É≥„ÅÆÈÖçÂàó„Å´„Çà„Å£„Å¶Ê∫∂Ë°ÄÊÄß„Åß„ÅÇ„Çã„Å®‰∫àÊ∏¨„Åï„Çå„Å¶„ÅÑ„Åæ„Åô„Äç„ÄÇ</p>
</section>
</section>
<section id="id37">
<h2><span class="section-number">12.5. </span>ÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶„ÅØ‰Ωï„ÅÆ„Åü„ÇÅ„Å´„ÅÇ„Çã„ÅÆ„ÅãÔºü<a class="headerlink" href="#id37" title="Permalink to this headline">¬∂</a></h2>
<p>ÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶„ÅØ„ÄÅÂÆüÁî®ÁöÑ„Å™‰∫àÊ∏¨„ÇÑÊ¥ûÂØü„Çí‰∏é„Åà„ÇãÊòéÁ¢∫„Å™Ë™¨Êòé„Å´„Å§„Å™„Åå„Çã„Åì„Å®„ÅØ„Åª„Å®„Çì„Å©„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇÂõ†ÊûúÈñ¢‰øÇ„Åå„Å™„ÅÑ„Åü„ÇÅ„ÄÅÂ≠òÂú®„Åó„Å™„ÅÑÁâπÂæ¥Èáè„ÅÆË™¨Êòé„Å´ÊÑèÂë≥„ÇíË¶ãÂá∫„Åô„Åì„Å®„Å´Áπã„Åå„Çä„Åã„Å≠„Åæ„Åõ„Çì<span id="id38">[<a class="reference internal" href="#id246" title="Kangway V Chuang and Michael J Keiser. Comment on ‚Äúpredicting reaction performance in c‚Äìn cross-coupling using machine learning‚Äù. Science, 362(6416):eaat8603, 2018.">CK18</a>]</span>„ÄÇ„ÇÇ„ÅÜ‰∏Ä„Å§„ÅÆÊ≥®ÊÑèÁÇπ„ÅØ„ÄÅÂÆüÈöõ„ÅÆÂåñÂ≠¶Áâ©Ë≥™„ÅÆ‰ΩìÁ≥ª„Åß„ÅØ„Å™„Åè„ÄÅ<em>„É¢„Éá„É´</em>„ÇíË™¨Êòé„Åó„Å¶„ÅÑ„Çã„Å®„ÅÑ„ÅÜ„Åì„Å®„Åß„Åô„ÄÇ‰æã„Åà„Å∞„ÄÅ„ÄåÊ∫∂Ë°ÄÊ¥ªÊÄß„ÅØ5Áï™ÁõÆ„ÅÆ„Ç∞„É´„Çø„Éü„É≥„Å´„Çà„Çã„ÇÇ„ÅÆ„Åß„Åô„Äç„Å®Ëß£Èáà„Åô„Çã„ÅÆ„ÅØÈÅø„Åë„Åæ„Åó„Çá„ÅÜ„ÄÇ‰ª£„Çè„Çä„Å´„Äå„É¢„Éá„É´„ÅØ5Áï™ÁõÆ„Å´„Ç∞„É´„Çø„Éü„É≥„Åå‰ΩçÁΩÆ„Åô„Çã„Åü„ÇÅÊ∫∂Ë°ÄÊ¥ªÊÄß„Åß„ÅÇ„Çã„Å®‰∫àÊ∏¨„Åó„Åæ„Åó„Åü„Äç„Å®„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
<p><em>ÂÆüÁî®ÁöÑ„Å™</em>Ë™¨Êòé„ÅØ„ÄÅÁâπÂæ¥Èáè„Çí„Å©„ÅÆ„Çà„ÅÜ„Å´Â§â„Åà„Çå„Å∞ÁµêÊûú„Å´ÂΩ±Èüø„Åô„Çã„Åã„ÇíÁ§∫„Åô„ÇÇ„ÅÆ„Åß„ÄÅÁµêÊûú„ÅÆÂéüÂõ†„ÇíÁü•„Å£„Å¶„ÅÑ„Çã„Åì„Å®„Å´‰ºº„Å¶„ÅÑ„Åæ„Åô„ÄÇ„Åó„Åü„Åå„Å£„Å¶„ÄÅ‰∏äËø∞„ÅÆÁêÜÁî±„Åã„Çâ„ÄÅÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶„Å´Ë™¨ÊòéÊÄß„Åå„ÅÇ„Çã„Åã„Å©„ÅÜ„Åã„Å´„Å§„ÅÑ„Å¶„ÅØË≠∞Ë´ñ„ÅåÁ∂ö„ÅÑ„Å¶„ÅÑ„Åæ„Åô<span id="id39">[<a class="reference internal" href="#id237" title="Zachary C Lipton. The mythos of model interpretability: in machine learning, the concept of interpretability is both important and slippery. Queue, 16(3):31‚Äì57, 2018.">Lip18</a>]</span>„ÄÇÂèÇËÄÉ„Åæ„Åß„Å´„ÄÅÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶„Çí‰∫∫„ÅÆ<em>Ê¶ÇÂøµ</em>„Å´Áµê„Å≥„Å§„Åë„Çà„ÅÜ„Å®„Åô„ÇãÁ†îÁ©∂ÂàÜÈáé„ÅØ„ÄÅtesting with concept activation vectorsÔºàTCAVÔºâ<span id="id40">[<a class="reference internal" href="#id236" title="Been Kim, Martin Wattenberg, Justin Gilmer, Carrie Cai, James Wexler, Fernanda Viegas, and others. Interpretability beyond feature attribution: quantitative testing with concept activation vectors (tcav). In International conference on machine learning, 2668‚Äì2677. PMLR, 2018.">KWG+18</a>]</span>„Å®Âëº„Å∞„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ„Å°„Å™„Åø„Å´ÁßÅËá™Ë∫´„ÅØXAI„ÅÆ„Åü„ÇÅ„Å´ÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶„Çí„ÅÇ„Åæ„Çä‰Ωø„Å£„Å¶„ÅÑ„Åæ„Åõ„Çì„ÄÇ„Åù„Çå„ÅØ„ÄÅË™¨Êòé„ÅåÂÆüÁî®ÁöÑ„Åß„ÇÇÂõ†ÊûúÈñ¢‰øÇ„ÇíÁ§∫„Åô„ÇÇ„ÅÆ„Åß„ÇÇ„Å™„Åè„ÄÅ„Åó„Å∞„Åó„Å∞‰ªñ„ÅÆÊ∑∑‰π±„ÇíÊãõ„Åè„Åã„Çâ„Åß„Åô„ÄÇ</p>
</section>
<section id="id41">
<h2><span class="section-number">12.6. </span>Â≠¶Áøí„Éá„Éº„Çø„ÅÆÈáçË¶ÅÂ∫¶<a class="headerlink" href="#id41" title="Permalink to this headline">¬∂</a></h2>
<p>„ÇÇ„ÅÜ‰∏Ä„Å§„ÅÆÁßÅ„Åü„Å°„ÅåÊúüÂæÖ„Åô„ÇãË™¨Êòé„ÇÑËß£Èáà„ÅØ„ÄÅ<em>„Å©„ÅÆ</em>Â≠¶Áøí„Éá„Éº„ÇøÁÇπ„Åå‰∫àÊ∏¨„Å´ÊúÄ„ÇÇË≤¢ÁåÆ„Åó„Å¶„ÅÑ„Çã„Åã„Å®„ÅÑ„ÅÜ„Åì„Å®„Åß„Åô„ÄÇ„Åì„Çå„ÅØÊ¨°„ÅÆË≥™Âïè„Å´ÂØæ„Åô„Çã„Çà„ÇäÁõ¥Êé•ÁöÑ„Å™ÂõûÁ≠î„Å´„Å™„Çä„Åæ„Åô„ÄÇ„Äå„Å™„ÅúÁßÅ„ÅÆ„É¢„Éá„É´„ÅØ„Åì„Çå„Çí‰∫àÊ∏¨„Åó„Åü„ÅÆ„Åß„Åó„Çá„ÅÜ„Åã„Äç„ÄÇ„Éã„É•„Éº„É©„É´„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„ÅØÂ≠¶Áøí„Éá„Éº„Çø„ÅÆÁµêÊûú„Åß„ÅÇ„Çä„ÄÅ„Å™„Åú„Åù„ÅÆ‰∫àÊ∏¨„Åå„Å™„Åï„Çå„Åü„ÅÆ„Åã„Å´ÂØæ„Åô„ÇãÁ≠î„Åà„ÅØÂ≠¶Áøí„Éá„Éº„Çø„ÇíËæø„Çã„Åì„Å®„ÅßÂæó„Çâ„Çå„Åæ„Åô„ÄÇ„ÅÇ„Çã‰∫àÊ∏¨„Å´ÂØæ„Åó„Å¶Â≠¶Áøí„Éá„Éº„Çø„Çí„É©„É≥„ÇØ‰ªò„Åë„Åô„Çã„Åì„Å®„Åß„ÄÅ„Å©„ÅÆÂ≠¶Áøí„Éá„Éº„ÇøÁÇπ„Åå„Éã„É•„Éº„É©„É´„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„ÅÆ‰∫àÊ∏¨„Å´ÂΩ±Èüø„Çí‰∏é„Åà„Å¶„ÅÑ„Çã„ÅÆ„Åã„Å´Èñ¢„Åô„ÇãÊ¥ûÂØü„ÇíÂæó„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ„Åì„Çå„ÅØÂΩ±ÈüøÈñ¢Êï∞<span class="math notranslate nohighlight">\(\mathcal{I}(x_i, x)\)</span>„ÅÆ„Çà„ÅÜ„Åß„ÅÇ„Çä„ÄÅÂ≠¶Áøí„Éá„Éº„ÇøÁÇπ<span class="math notranslate nohighlight">\(i\)</span>„Å®ÂÖ•Âäõ<span class="math notranslate nohighlight">\(x\)</span>„Å´ÂØæ„Åô„ÇãÂΩ±ÈüøÂ∫¶„Çπ„Ç≥„Ç¢„Çí‰∏é„Åà„Åæ„Åô„ÄÇÂΩ±ÈüøÂ∫¶„ÇíË®àÁÆó„Åô„ÇãÊúÄ„ÇÇÁ∞°Âçò„Å™ÊñπÊ≥ï„ÅØ„ÄÅ„Éã„É•„Éº„É©„É´„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„Å´<span class="math notranslate nohighlight">\(x_i\)</span>„Åå„ÅÇ„ÇãÂ†¥ÂêàÔºà„Å§„Åæ„Çä<span class="math notranslate nohighlight">\(\hat{f}(x)\)</span>Ôºâ„Å®„Å™„ÅÑÂ†¥ÂêàÔºà„Å§„Åæ„Çä<span class="math notranslate nohighlight">\(\hat{f}_{-x_i}(x)\)</span>Ôºâ„ÇíÂ≠¶Áøí„Åó„Å¶„ÄÅÂΩ±ÈüøÂ∫¶„Çí‰ª•‰∏ã„ÅÆ„Çà„ÅÜ„Å´ÂÆöÁæ©„Åó„Åæ„Åô„ÄÇ</p>
<div class="amsmath math notranslate nohighlight" id="equation-c34d473f-12ff-44cd-a2a9-0e60bac43aa8">
<span class="eqno">(12.12)<a class="headerlink" href="#equation-c34d473f-12ff-44cd-a2a9-0e60bac43aa8" title="Permalink to this equation">¬∂</a></span>\[\begin{equation}
\mathcal{I}(x_i, x) = \hat{f}_{-x_i}(x) - \hat{f}(x)
\end{equation}\]</div>
<p>‰æã„Åà„Å∞„ÄÅÂ≠¶Áøí„Éá„Éº„Çø„Åã„ÇâÂ≠¶Áøí„Éá„Éº„ÇøÁÇπ<span class="math notranslate nohighlight">\(x_i\)</span>„ÇíÈô§„ÅÑ„ÅüÂæå„ÄÅ‰∫àÊ∏¨ÂÄ§„ÅåÈ´ò„Åè„Å™„Çå„Å∞„ÄÅ„Åù„ÅÆÁÇπ„ÅØÊ≠£„ÅÆÂΩ±ÈüøÂäõ„ÇíÊåÅ„Å£„Å¶„ÅÑ„Çã„Å®„ÅÑ„ÅÜ„Åì„Å®„Å´„Å™„Çä„Åæ„Åô„ÄÇ„Åì„ÅÆÂΩ±ÈüøÈñ¢Êï∞„ÅÆË®àÁÆó„ÅØÈÄöÂ∏∏„Éá„Éº„ÇøÁÇπ„ÅÆÊï∞„Å†„Åë„É¢„Éá„É´„ÇíÁπ∞„ÇäËøî„ÅóÂ≠¶Áøí„Åô„ÇãÂøÖË¶Å„Åå„ÅÇ„Çä„Åæ„Åô„Åå„ÄÅÈÄöÂ∏∏„ÅØË®àÁÆó„Åß„Åç„Åæ„Åõ„Çì„ÄÇ <span id="id42">[<a class="reference internal" href="#id196" title="Pang Wei Koh and Percy Liang. Understanding black-box predictions via influence functions. In International Conference on Machine Learning, 1885‚Äì1894. PMLR, 2017.">KL17</a>]</span> show a way to approximate this by looking at infinitesimal changes to the <em>weights</em> of each training point. „Åì„Çå„Çâ„ÅÆÂΩ±ÈüøÈñ¢Êï∞„ÇíË®àÁÆó„Åô„Çã„Å´„ÅØÊêçÂ§±Èñ¢Êï∞„Å´Èñ¢„Åô„ÇãHessian„ÇíË®àÁÆó„Åô„ÇãÂøÖË¶Å„Åå„ÅÇ„Çã„Åü„ÇÅ„ÄÅ‰∏ÄËà¨ÁöÑ„Å´„ÅØ‰ΩøÁî®„Åï„Çå„Åæ„Åõ„Çì„ÄÇ„Åó„Åã„Åó„ÄÅJAX„Çí‰Ωø„Å£„Å¶„ÅÑ„ÇãÂ†¥Âêà„ÅØ„ÄÅ„Åù„ÅÆË®àÁÆó„ÇíÁ∞°Âçò„Å´Ë°å„ÅÜ„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>„Ç´„Éº„Éç„É´„É¢„Éá„É´„ÇíÂà©Áî®„Åô„ÇãÂ†¥Âêà„ÄÅÂ≠¶Áøí„Éá„Éº„Çø„ÅåÁâπÂæ¥Èáè„Å®„Å™„Çä„Åæ„Åô„ÄÇintergrated gradients„ÅÆ„Çà„ÅÜ„Å™‰∏äË®ò„ÅÆÊñπÊ≥ï„ÅØ„ÄÅÂ≠¶Áøí„Éá„Éº„Çø„ÅÆÈáçË¶ÅÂ∫¶„Çí‰∏é„Åà„Åæ„Åô„ÄÇ</p>
</aside>
<p>Â≠¶Áøí„Éá„Éº„Çø„ÅÆÈáçË¶ÅÂ∫¶„ÅØ„Éá„Ç£„Éº„Éó„É©„Éº„Éã„É≥„Ç∞„ÅÆÂ∞ÇÈñÄÂÆ∂„Å´„Å®„Å£„Å¶ÊúâÁî®„Å™Ëß£Èáà„ÇíÊèê‰æõ„Åó„Åæ„Åô„ÄÇ„ÅÇ„Çã‰∫àÊ∏¨„Å´ÂØæ„Åó„Å¶„Å©„ÅÆÂ≠¶Áøí„Éá„Éº„ÇøÁÇπ„ÅåÊúÄ„ÇÇÂΩ±ÈüøÂäõ„ÇíÊåÅ„Å£„Å¶„ÅÑ„Çã„ÅÆ„Åã„ÇíÊïô„Åà„Å¶„Åè„Çå„Åæ„Åô„ÄÇ„Åì„Çå„ÅØ„Éá„Éº„Çø„Å´Èñ¢„Åô„ÇãÂïèÈ°å„Å´ÂØæÂá¶„Åô„ÇãÂ†¥Âêà„ÇÑÂÅΩÈôΩÊÄß„Å´ÂØæ„Åô„ÇãË™¨Êòé„ÇíËæø„Çã„ÅÆ„Å´ÂΩπÁ´ã„Å°„Åæ„Åô„ÄÇ„Åó„Åã„Åó„ÄÅ„Éá„Ç£„Éº„Éó„É©„Éº„Éã„É≥„Ç∞„É¢„Éá„É´„ÅÆ‰∫àÊ∏¨ÁµêÊûú„ÇíÂà©Áî®„Åô„Çã‰∏ÄËà¨„ÅÆÂà©Áî®ËÄÖ„ÅØ„ÄÅ„Åä„Åù„Çâ„ÅèÂ≠¶Áøí„Éá„Éº„Çø„ÅÆ„É©„É≥„ÇØ‰ªò„Åë„Å†„Åë„Åß„ÅØÊ∫ÄË∂≥„Åó„Å™„ÅÑ„Åß„Åó„Çá„ÅÜ„ÄÇ</p>
</section>
<section id="id43">
<h2><span class="section-number">12.7. </span>„Çµ„É≠„Ç≤„Éº„Éà„É¢„Éá„É´<a class="headerlink" href="#id43" title="Permalink to this headline">¬∂</a></h2>
<p>Ëß£ÈáàÂèØËÉΩÊÄß„Å´„Åä„Åë„Çã„Çà„Çä‰∏ÄËà¨ÁöÑ„Å™ËÄÉ„ÅàÊñπ„ÅÆ‰∏Ä„Å§„ÅØ„ÄÅËß£ÈáàÂèØËÉΩ„Å™„É¢„Éá„É´„Çí„Éñ„É©„ÉÉ„ÇØ„Éú„ÉÉ„ÇØ„Çπ„É¢„Éá„É´„Å´<em>ÁâπÂÆö„ÅÆ‰æã„ÅÆËøëÂÇç</em>„ÅßÈÅ©Âêà„Åï„Åõ„Çã„Åì„Å®„Åß„Åó„Çá„ÅÜ„ÄÇ„Å™„Åú„Å™„Çâ„ÄÅËß£ÈáàÂèØËÉΩ„Å™„É¢„Éá„É´„ÅØ„Åü„ÅÑ„Å¶„ÅÑÂ§ßÂüüÁöÑ„Å´„Éñ„É©„ÉÉ„ÇØ„Éú„ÉÉ„ÇØ„Çπ„É¢„Éá„É´„Å´ÈÅ©Âêà„Åï„Åõ„Çã„Åì„Å®„ÅØ„Åß„Åç„Å™„ÅÑ„Åã„Çâ„Åß„Åô„ÄÇ„Åù„ÅÜ„Åß„Å™„Åë„Çå„Å∞„ÄÅÊúÄÂàù„Åã„ÇâËß£ÈáàÂèØËÉΩ„Å™„É¢„Éá„É´„Çí‰Ωø„ÅÑ„ÄÅ„Éñ„É©„ÉÉ„ÇØ„Éú„ÉÉ„ÇØ„Çπ„É¢„Éá„É´„ÅØ‰Ωø„Çè„Å™„ÅÑ„Åß„Åó„Çá„ÅÜ„ÄÇ„Åó„Åã„Åó„ÄÅËß£ÈáàÂèØËÉΩ„Å™„É¢„Éá„É´„ÅØËààÂë≥„ÅÇ„Çã‰æã„ÅÆÂë®Ëæ∫„ÅÆÂ∞è„Åï„Å™È†òÂüü„Å´„Å†„ÅëÂΩì„Å¶„ÅØ„ÇÅ„Çå„Å∞„ÄÅÂ±ÄÊâÄÁöÑ„Å´Ê≠£„Åó„ÅÑËß£ÈáàÂèØËÉΩ„Å™„É¢„Éá„É´„Çí‰Ωø„Å£„Å¶Ë™¨Êòé„Çí‰∏é„Åà„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ„Åì„ÅÆËß£ÈáàÂèØËÉΩ„Å™„É¢„Éá„É´„Çí<strong>„É≠„Éº„Ç´„É´„Çµ„É≠„Ç≤„Éº„Éà„É¢„Éá„É´</strong>„Å®Âëº„Å≥„Åæ„Åô„ÄÇËß£ÈáàÂèØËÉΩ„Å™„É≠„Éº„Ç´„É´„Çµ„É≠„Ç≤„Éº„Éà„É¢„Éá„É´„Å´„ÅØ„ÄÅÊ±∫ÂÆöÊú®„ÄÅÁ∑öÂΩ¢„É¢„Éá„É´„ÄÅÔºàÁ∞°ÊΩî„Å™Ë™¨Êòé„ÅÆ„Åü„ÇÅ„ÅÆÔºâ„Çπ„Éë„Éº„ÇπÁ∑öÂΩ¢„É¢„Éá„É´„ÄÅ„Éä„Ç§„Éº„Éñ„Éô„Ç§„Ç∫ÂàÜÈ°ûÂô®„Å™„Å©„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ</p>
<p>„É≠„Éº„Ç´„É´„Çµ„É≠„Ç≤„Éº„Éà„É¢„Éá„É´„Å®„Åó„Å¶‰∏ÄËà¨ÁöÑ„Å´Áü•„Çâ„Çå„Å¶„ÅÑ„Çã„Ç¢„É´„Ç¥„É™„Ç∫„É†„ÅØLocal Interpretable Model-Agnostic Explanations (LIME) <span id="id44">[<a class="reference internal" href="#id194" title="Marco Tulio Ribeiro, Sameer Singh, and Carlos Guestrin. &quot; why should i trust you?&quot; explaining the predictions of any classifier. In Proceedings of the 22nd ACM SIGKDD international conference on knowledge discovery and data mining, 1135‚Äì1144. 2016.">RSG16a</a>]</span>„Å®Âëº„Å∞„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇLIME„ÅØ„ÄÅÂÖÉ„ÅÆ„Éñ„É©„ÉÉ„ÇØ„Éú„ÉÉ„ÇØ„Çπ„É¢„Éá„É´„ÇíÂ≠¶Áøí„Åï„Åõ„ÅüÊêçÂ§±Èñ¢Êï∞„ÇíÂà©Áî®„Åó„Å¶„ÄÅ„É≠„Éº„Ç´„É´„Çµ„É≠„Ç≤„Éº„Éà„É¢„Éá„É´„ÇíËààÂë≥„ÅÇ„Çã‰æã„ÅÆËøëÂÇç„Å´„Éï„Ç£„ÉÉ„Éà„Åï„Åõ„Åæ„Åô„ÄÇ„É≠„Éº„Ç´„É´„Çµ„É≠„Ç≤„Éº„Éà„É¢„Éá„É´„ÅÆÊêçÂ§±Èñ¢Êï∞„ÅØ„ÄÅ„Çµ„É≠„Ç≤„Éº„Éà„É¢„Éá„É´„ÇíÂõûÂ∏∞„Åô„ÇãÈöõ„Å´„ÄÅËààÂë≥„ÅÇ„Çã‰æã„Å´Ëøë„ÅÑÁÇπ„ÇíË©ï‰æ°„Åô„Çã„Çà„ÅÜÈáç„Åø‰ªò„Åë„Åï„Çå„Åæ„Åô„ÄÇLIME„ÅÆË´ñÊñá„Åß„ÅØ„ÄÅ„Çµ„É≠„Ç≤„Éº„Éà„É¢„Éá„É´„ÅÆ„Çπ„Éë„Éº„ÇπÂåñ„ÇíË°®Ë®ò„Å´Âê´„ÇÅ„Å¶„ÅÑ„Åæ„Åô„Åå„ÄÅ„Åù„Çå„ÅØ„É≠„Éº„Ç´„É´„Çµ„É≠„Ç≤„Éº„Éà„É¢„Éá„É´„ÅÆÁâπÊÄß„Åß„ÅØ„Å™„ÅÑ„Åü„ÇÅ„ÄÅ„Åì„Åì„Åß„ÅØ‰∏ÄÊó¶ÁúÅ„Åç„Åæ„Åô„ÄÇ„Çà„Å£„Å¶„ÄÅ„Çµ„É≠„Ç≤„Éº„Éà„É¢„Éá„É´„ÅÆÊêçÂ§±„ÅØÊ¨°„ÅÆ„Çà„ÅÜ„Å´ÂÆöÁæ©„Åï„Çå„Åæ„Åô„ÄÇ</p>
<div class="amsmath math notranslate nohighlight" id="equation-8d0fb7d1-b99d-40b0-b8af-043cfa356278">
<span class="eqno">(12.13)<a class="headerlink" href="#equation-8d0fb7d1-b99d-40b0-b8af-043cfa356278" title="Permalink to this equation">¬∂</a></span>\[\begin{equation}
\mathcal{l^s}\left(x'\right) = w(x', x)\mathcal{l}\left(\hat{f}_s(x'), \hat{f}(x')\right)
\end{equation}\]</div>
<p><span class="math notranslate nohighlight">\(w(x', x)\)</span>„ÅØËààÂë≥„ÅÇ„Çã‰æã<span class="math notranslate nohighlight">\(x\)</span>„ÅÆËøë„Åè„Å´„ÅÇ„ÇãÁÇπ„Å´Èáç„Åø„Çí‰ªò„Åë„ÇãÈáç„Åø„Ç´„Éº„Éç„É´Èñ¢Êï∞„ÄÅ <span class="math notranslate nohighlight">\(\mathcal{l}(\cdot,\cdot)\)</span>„ÅØÂÖÉ„ÅÆ„Éñ„É©„ÉÉ„ÇØ„Éú„ÉÉ„ÇØ„Çπ„É¢„Éá„É´„ÅÆÊêçÂ§±„ÄÅ<span class="math notranslate nohighlight">\(\hat{f}(\cdot)\)</span> „ÅØ„Éñ„É©„ÉÉ„ÇØ„Éú„ÉÉ„ÇØ„Çπ„É¢„Éá„É´„ÄÅ<span class="math notranslate nohighlight">\(\hat{f}_s(\cdot)\)</span>„ÅØ„Çµ„É≠„Ç≤„Éº„Éà„É¢„Éá„É´„ÇíË°®„Åó„Åæ„Åô„ÄÇ</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p><span id="id45">[<a class="reference internal" href="#id194" title="Marco Tulio Ribeiro, Sameer Singh, and Carlos Guestrin. &quot; why should i trust you?&quot; explaining the predictions of any classifier. In Proceedings of the 22nd ACM SIGKDD international conference on knowledge discovery and data mining, 1135‚Äì1144. 2016.">RSG16a</a>]</span>„ÅßÂÆöÂºèÂåñ„Åï„Çå„Å¶„ÅÑ„ÇãLIME„ÅØÁâπÂæ¥Èáè„ÅÆÈáçË¶ÅÂ∫¶„Å´Èñ¢„Åô„ÇãË®òËø∞„Çí‰∏é„Åà„Åæ„Åô„Åå„ÄÅ„Çµ„É≠„Ç≤„Éº„Éà„É¢„Éá„É´„Å´„Çà„Å£„Å¶„ÅØËß£ÈáàÂèØËÉΩ„Å™Â†¥Âêà„ÇÇ„ÅÇ„Çä„Åæ„Åô„ÄÇ‰æã„Åà„Å∞Ê±∫ÂÆöÊú®„ÅÆ„Çà„ÅÜ„Å™„ÇÇ„ÅÆ„Åß„Åô„ÄÇ</p>
</aside>
<p>Èáç„ÅøÈñ¢Êï∞„ÅØÂ∞ë„Åó„Ç¢„Éâ„Éõ„ÉÉ„ÇØ„Åß„Åô„ÄÇ„Å§„Åæ„Çä„Éá„Éº„ÇøÂûã„Å´‰æùÂ≠ò„Åó„Åæ„Åô„ÄÇ„Çπ„Ç´„É©„Éº„É©„Éô„É´„ÅÆÂõûÂ∏∞„Çø„Çπ„ÇØ„Åß„ÅØ„ÄÅ„Ç´„Éº„Éç„É´Èñ¢Êï∞„Çí‰Ωø„ÅÑ„Åæ„Åô„Åå„ÄÅÊßò„ÄÖ„Å™ÈÅ∏ÊäûËÇ¢„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ„Ç¨„Ç¶„Ç∑„Ç¢„É≥„ÄÅ„Ç≥„Çµ„Ç§„É≥„ÄÅ„Ç®„Éë„Éç„ÉÅ„Ç≥„Éï„Å™„Å©„Åß„Åô„ÄÇ„ÉÜ„Ç≠„Çπ„Éà„Éá„Éº„Çø„Åß„ÅØ„ÄÅLIME„ÅÆÂÆüË£Ö„Åß„ÅØ„ÄÅ<a class="reference external" href="https://en.wikipedia.org/wiki/Hamming_distance">„Éè„Éü„É≥„Ç∞Ë∑ùÈõ¢</a>„Çí‰Ωø„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇ„Åì„Çå„ÅØÂçò„Å´2„Å§„ÅÆÊñáÂ≠óÂàó„ÅÆÈñì„Åß‰∏ÄËá¥„Åó„Å™„ÅÑ„ÉÜ„Ç≠„Çπ„Éà„Éà„Éº„ÇØ„É≥„ÅÆÊï∞„Çí„Ç´„Ç¶„É≥„Éà„Åô„Çã„ÇÇ„ÅÆ„Åß„Åô„ÄÇÁîªÂÉè„ÇÇ„Éè„Éü„É≥„Ç∞Ë∑ùÈõ¢„Çí‰Ωø„ÅÑ„Åæ„Åô„Åå„ÄÅ„Çπ„Éº„Éë„Éº„Éî„ÇØ„Çª„É´„ÅØ‰æã„Å®Âêå„Åò„ÅãÁ©∫ÁôΩ„Å®„Åó„Åæ„Åô„ÄÇ</p>
<p>ÁÇπ <span class="math notranslate nohighlight">\(x'\)</span>„ÅØ„Å©„ÅÆ„Çà„ÅÜ„Å´ÁîüÊàê„Åï„Çå„Çã„ÅÆ„Åß„Åó„Çá„ÅÜ„Åã„ÄÇÈÄ£Á∂öÂÄ§„ÅÆÂ†¥Âêà„ÄÅ<span class="math notranslate nohighlight">\(x'\)</span>„ÅØ<em>‰∏ÄÊßò„Å´</em>„Çµ„É≥„Éó„É™„É≥„Ç∞„Åï„Çå„Åæ„Åô„Åå„ÄÅÁâπÂæ¥Á©∫Èñì„ÅØ„Åó„Å∞„Åó„Å∞Èñâ„Åò„Å¶„ÅÑ„Å™„ÅÑ„Åü„ÇÅ„ÄÅ„Åì„Çå„ÅØÈùûÂ∏∏„Å´Èõ£„Åó„ÅÑ„Åì„Å®„Åß„Åô„ÄÇÈáç„Åø‰ªò„ÅçÈñ¢Êï∞„Å´Âæì„Å£„Å¶<span class="math notranslate nohighlight">\(x'\)</span>„Çí„Çµ„É≥„Éó„É™„É≥„Ç∞„Åó„ÄÅÈáç„Åø‰ªò„Åë„ÇíÁúÅÁï•„Åô„Çå„Å∞„ÄÅÔºà„Åù„Çå„Å´Âæì„Å£„Å¶„Çµ„É≥„Éó„É™„É≥„Ç∞„Åï„Çå„Åü„ÅÆ„ÅßÔºâÈñâ„Åò„Å¶„ÅÑ„Å™„ÅÑÁâπÂæ¥Á©∫Èñì„ÅÆ„Çà„ÅÜ„Å™ÂïèÈ°å„ÇíÈÅø„Åë„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ‰∏ÄËà¨„Å´„ÄÅÈÄ£Á∂ö„Éô„ÇØ„Éà„É´ÁâπÂæ¥Á©∫Èñì„Åß„ÅØ„ÄÅLIME„ÅØÂ∞ë„Åó‰∏ªË¶≥ÁöÑ„Åß„Åô„ÄÇÁîªÂÉè„ÇÑ„ÉÜ„Ç≠„Çπ„Éà„ÅÆÂ†¥Âêà„ÄÅ<span class="math notranslate nohighlight">\(x'\)</span>„ÅØ„Éà„Éº„ÇØ„É≥ÔºàÂçòË™ûÔºâ„Çí„Éû„Çπ„Ç≠„É≥„Ç∞„Åô„Çã„ÄÅ„Çπ„Éº„Éë„Éº„Éî„ÇØ„Çª„É´„Çí„Çº„É≠ÂåñÔºàÈªíÂåñÔºâ„Åô„Çã„Åì„Å®„Å´„Çà„ÇäÂΩ¢Êàê„Åï„Çå„Åæ„Åô„ÄÇ„Åì„Çå„ÅØ„ÄÅ„Ç∑„É£„Éº„Éó„É¨„Ç§ÂÄ§„Å´„Åã„Å™„ÇäËøë„ÅÑË™¨Êòé„Å®„Å™„Çã„ÅØ„Åö„Åß„ÄÅÂÆüÈöõ„ÄÅLIME„Åå„Ç∑„É£„Éº„Éó„É¨„Ç§ÂÄ§„Å®ÂêåÁ≠â„Åß„ÅÇ„Çã„Åì„Å®„Çí„ÄÅ„ÅÑ„Åè„Å§„Åã„ÅÆÂ∞è„Åï„Å™Ë°®Ë®òÊ≥ï„ÅÆÂ§âÊõ¥„ÅßÁ§∫„Åô„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ</p>
</section>
<section id="id46">
<h2><span class="section-number">12.8. </span>ÂèçÂÆü‰ªÆÊÉ≥<a class="headerlink" href="#id46" title="Permalink to this headline">¬∂</a></h2>
<aside class="margin sidebar">
<p class="sidebar-title">ÂèçÂÆü‰ªÆÊÉ≥</p>
<p>ÊúÄÈÅ©Âåñ„ÅÆÂÆöÂºèÂåñ„ÅØXAI„Åß‰Ωø„Çè„Çå„Å¶„ÅÑ„Çã„ÇÇ„ÅÆ„Åß„Åô„Åå„ÄÅ‰ªñ„ÅÆÊñáËÑà„ÅÆÂèçÂÆü‰ªÆÊÉ≥„ÅØ‚ÄùËøë„Åï‚Äù„ÅÆÂü∫Ê∫ñ„ÇíÊåÅ„Å£„Å¶„ÅÑ„Åæ„Åõ„Çì„ÄÇ</p>
</aside>
<p>ÂèçÂÆü‰ªÆÊÉ≥„ÅØÊúÄÈÅ©ÂåñÂïèÈ°å„ÅÆËß£„Åß„Åô„ÄÇ<span class="math notranslate nohighlight">\(x\)</span>„Å®Áï∞„Å™„Çã„É©„Éô„É´„ÇíÊåÅ„Å°„ÄÅ<span class="math notranslate nohighlight">\(x\)</span>„Å´„Åß„Åç„Çã„Å†„ÅëËøë„ÅÑ‰æã<span class="math notranslate nohighlight">\(x'\)</span>„ÇíË¶ã„Å§„Åë„Åæ„Åô<span id="id47">[<a class="reference internal" href="#id197" title="Sandra Wachter, Brent Mittelstadt, and Chris Russell. Counterfactual explanations without opening the black box: automated decisions and the gdpr. Harv. JL &amp; Tech., 31:841, 2017.">WMR17</a>]</span>„ÄÇ„Åì„Çå„ÅØÊ¨°„ÅÆ„Çà„ÅÜ„Å´ÂÆöÂºèÂåñ„Åß„Åç„Åæ„Åô„ÄÇ</p>
<div class="math notranslate nohighlight" id="equation-cf">
<span class="eqno">(12.14)<a class="headerlink" href="#equation-cf" title="Permalink to this equation">¬∂</a></span>\[\begin{split}\textrm{minimize}\qquad d(x, x')\\
\textrm{such that}\qquad \hat{f}(x) \neq \hat{f}(x')\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(\hat{f}(x)\)</span>„Åå„Çπ„Ç´„É©„Éº„ÇíÂá∫Âäõ„Åô„ÇãÂõûÂ∏∞ÂïèÈ°å„Åß„ÅØ„ÄÅÂà∂Á¥ÑÊù°‰ª∂„Çí<span class="math notranslate nohighlight">\(\hat{f}(x)\)</span>„Åã„Çâ„ÅÇ„Çã<span class="math notranslate nohighlight">\(\Delta\)</span>„Å†„ÅëÈõ¢„Åô„Çà„ÅÜ„Å´‰øÆÊ≠£„Åô„ÇãÂøÖË¶Å„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ„Åì„ÅÆÊúÄÈÅ©ÂåñÂïèÈ°å„ÇíÊ∫Ä„Åü„Åô<span class="math notranslate nohighlight">\(x'\)</span> „ÅØÂèçÂÆü‰ªÆÊÉ≥ÔºàÁô∫Áîü„Åó„Å™„Åã„Å£„ÅüÊù°‰ª∂„ÄÅÁï∞„Å™„ÇãÁµêÊûú„ÇíÂ∞é„ÅÑ„Åü„Åß„ÅÇ„Çç„ÅÜÊù°‰ª∂Ôºâ„Å®Âëº„Å∞„Çå„Åæ„Åô„ÄÇÈÄöÂ∏∏„ÄÅ<span class="math notranslate nohighlight">\(x'\)</span>„ÇíÊ±Ç„ÇÅ„Çã„Åì„Å®„ÅØ„ÄÅÁÑ°ÂæÆÂàÜÊúÄÈÅ©Âåñ„Å®„Åó„Å¶Êâ±„Çè„Çå„Åæ„Åô„ÄÇ<span class="math notranslate nohighlight">\(\frac{\partial \hat{f}}{\partial x'}\)</span>„ÇíË®àÁÆó„Åó„Å¶Âà∂Á¥Ñ‰ªò„ÅçÊúÄÈÅ©Âåñ„Åó„Åæ„Åô„Åå„ÄÅÂÆüÈöõ„Å´„ÅØ„É¢„É≥„ÉÜ„Ç´„É´„É≠ÊúÄÈÅ©Âåñ„ÅÆ„Çà„ÅÜ„Å´ <span class="math notranslate nohighlight">\(\hat{f}(x) \neq \hat{f}(x')\)</span>„Åæ„Åß„É©„É≥„ÉÄ„É†„Å´<span class="math notranslate nohighlight">\(x\)</span>„ÇíÊëÇÂãï„Åï„Åõ„ÅüÊñπ„ÅåÈÄü„ÅÑÂ†¥Âêà„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇÊïôÂ∏´„Å™„ÅóÂ≠¶Áøí„ÅßÊñ∞„Åó„ÅÑ<span class="math notranslate nohighlight">\(x'\)</span>„ÇíÊèêÊ°à„Åß„Åç„ÇãÁîüÊàê„É¢„Éá„É´„Çí‰ΩøÁî®„Åô„Çã„Åì„Å®„ÇÇ„Åß„Åç„Åæ„Åô„ÄÇÂàÜÂ≠ê„Å´Èñ¢„Åô„ÇãÊôÆÈÅçÁöÑ„Å™ÂèçÂÆü‰ªÆÊÉ≥ÁîüÊàêÂô®„Å´„Å§„ÅÑ„Å¶„ÅØ<span id="id48">[<a class="reference internal" href="#id215" title="Geemi P Wellawatte, Aditi Seshadri, and Andrew D White. Model agnostic generation of counterfactual explanations for molecules. Chem. Sci., pages -, 2022. URL: http://dx.doi.org/10.1039/D1SC05259D, doi:10.1039/D1SC05259D.">WSW22</a>]</span>„ÇíÂèÇÁÖß„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇÂàÜÂ≠ê„ÅÆ„Ç∞„É©„Éï„Éã„É•„Éº„É©„É´„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„Å´ÁâπÂåñ„Åó„ÅüÊâãÊ≥ï„Å´„Å§„ÅÑ„Å¶„ÅØ<span id="id49">[<a class="reference internal" href="#id212" title="Danilo Numeroso and Davide Bacciu. Explaining deep graph networks with molecular counterfactuals. arXiv preprint arXiv:2011.05134, 2020.">NB20</a>]</span>„ÇíÂèÇÁÖß„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
<p>Ë∑ùÈõ¢„ÅÆÂÆöÁæ©„ÅØ„ÄÅLIME„ÅÆË™¨Êòé„ÅÆ‰∏≠„Åß„ÇÇËø∞„Åπ„Åü„Çà„ÅÜ„Å´„ÄÅÈáçË¶Å„Å™‰∏ªË¶≥ÁöÑÈñ¢ÂøÉ„Åî„Å®„Åß„Åô„ÄÇÂàÜÂ≠êÊßãÈÄ†„ÅÆÊñáËÑà„Åß‰Ωø„Çè„Çå„Çã‰∏ÄËà¨ÁöÑ„Å™Ë∑ùÈõ¢„ÅÆ‰æã„ÅØ„ÄÅMoragn„Éï„Ç£„É≥„Ç¨„Éº„Éó„É™„É≥„Éà<span id="id50">[<a class="reference internal" href="#id247" title="David Rogers and Mathew Hahn. Extended-connectivity fingerprints. Journal of chemical information and modeling, 50(5):742‚Äì754, 2010.">RH10</a>]</span>„ÅÆ„Çà„ÅÜ„Å™ÂàÜÂ≠ê„Éï„Ç£„É≥„Ç¨„Éº„Éó„É™„É≥„Éà/Ë®òËø∞Â≠ê„ÅÆ„Çø„Éã„É¢„Éà‰øÇÊï∞Ôºà„Åæ„Åü„ÅØJaccard‰øÇÊï∞Ôºâ„Åß„Åô„ÄÇ</p>
<p>ÂèçÂÆü‰ªÆÊÉ≥„ÅØ„Ç∑„É£„Éº„Éó„É¨„Ç§ÂÄ§„Å®ÊØîËºÉ„Åó„Å¶‰∏Ä„Å§Ê¨†ÁÇπ„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ„Åù„Çå„ÅØ<em>ÂÆåÂÖ®„Å™</em>Ë™¨Êòé„Çí‰∏é„Åà„Å¶„ÅØ„Åè„Çå„Å™„ÅÑ„Åì„Å®„Åß„Åô„ÄÇ„Ç∑„É£„Éº„Éó„É¨„Ç§ÂÄ§„ÅØ‰∫àÊ∏¨ÂÄ§„ÅÆÂêàË®à„Åß„ÅÇ„Çä„ÄÅË™¨Êòé„ÅÆ„Å©„ÅÆ„Çà„ÅÜ„Å™ÈÉ®ÂàÜ„ÇÇË¶ãÈÄÉ„Åó„Å¶„ÅÑ„Å™„ÅÑ„Åì„Å®„ÇíÊÑèÂë≥„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ‰∏ÄÊñπ„ÄÅÂèçÂÆü‰ªÆÊÉ≥„ÅØ„Åß„Åç„Çã„Å†„ÅëÂ∞ë„Å™„ÅÑÁâπÂæ¥Èáè„ÇíÂ§â„Åà„ÇãÔºàË∑ùÈõ¢„ÇíÊúÄÂ∞èÂåñ„Åô„ÇãÔºâ„Åü„ÇÅ„ÄÅ‰∫àÊ∏¨„Å´ÂØÑ‰∏é„Åó„Å¶„ÅÑ„Çã‰∏ÄÈÉ®„ÅÆÁâπÂæ¥Èáè„Å´„Å§„ÅÑ„Å¶„ÅÆÊÉÖÂ†±„ÇíË¶ãÈÄÉ„Åó„Å¶„Åó„Åæ„ÅÜ„Åì„Å®„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ„Åæ„Åü„Ç∑„É£„Éº„Éó„É¨„Ç§ÂÄ§„ÅÆÂà©ÁÇπ„ÅØÂÆüÁî®ÁöÑ„Åß„ÅÇ„Çã„Åì„Å®„Åß„Åô„Åå„ÄÅÂèçÂÆü‰ªÆÊÉ≥„ÅØÁõ¥Êé•‰ΩøÁî®„Åô„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ</p>
<section id="id51">
<h3><span class="section-number">12.8.1. </span>‰æã<a class="headerlink" href="#id51" title="Permalink to this headline">¬∂</a></h3>
<p>‰∏äË®ò„ÅÆ„Éö„Éó„ÉÅ„Éâ„ÅÆ‰æã„Åß„Åì„ÅÆ„Ç¢„Ç§„Éá„Ç¢„ÇíÁ¥†Êó©„ÅèÂÆüË£Ö„Åô„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇË∑ùÈõ¢„ÅØ„Éè„Éü„É≥„Ç∞Ë∑ùÈõ¢„Å®ÂÆöÁæ©„Åó„Åæ„Åô„ÄÇ„Åù„Åó„Å¶<span class="math notranslate nohighlight">\(x'\)</span>„ÅØ‰∏Ä„Å§„ÅÆ„Ç¢„Éü„ÉéÈÖ∏ÁΩÆÊèõ„Åß„Åô„ÄÇ„Åì„Çå„ÇíÂàóÊåô„Åó„Å¶„É©„Éô„É´„ÅÆÁΩÆÊèõ„Åå„Åß„Åç„Çã„Åã„Å©„ÅÜ„ÅãË©¶„Åó„Å¶„Åø„Åæ„Åó„Çá„ÅÜ„ÄÇ„Åæ„Åö1Âõû„ÅÆÁΩÆÊèõ„ÇíË°å„ÅÜÈñ¢Êï∞„ÇíÂÆöÁæ©„Åó„Åæ„Åô„ÄÇ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">check_cf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
    <span class="c1"># copy</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="c1"># substitute</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">at</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">at</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>


<span class="n">check_cf</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DeviceArray(8.552943, dtype=float32)
</pre></div>
</div>
</div>
</div>
<p>Ê¨°„Å´„ÄÅ<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.meshgrid.html#jax.numpy.meshgrid" title="(in JAX)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">jnp.meshgrid</span></code></a>„ÅßÂèØËÉΩ„Å™„Åô„Åπ„Å¶„ÅÆÁΩÆÊèõ„Çí‰Ωú„Çä„ÄÅ<code class="xref py py-obj docutils literal notranslate"><span class="pre">vmap</span></code>„ÅßÂÖà„Åª„Å©ÂÆöÁæ©„Åó„ÅüÈñ¢Êï∞„ÇíÈÅ©Âøú„Åó„Åæ„Åô„ÄÇravel()&lt;jax.numpy.ravel&gt;`„ÅØ„Ç§„É≥„Éá„ÉÉ„ÇØ„Çπ„ÅÆÈÖçÂàó„Çí‰∏ÄÊ¨°ÂÖÉ„Å´„Åô„Çã„Åü„ÇÅ„ÄÅË§áÈõë„Å™vmap„ÇíË°å„ÅÜÂøÖË¶Å„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ii</span><span class="p">,</span> <span class="n">jj</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">sl</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">21</span><span class="p">))</span>
<span class="n">ii</span><span class="p">,</span> <span class="n">jj</span> <span class="o">=</span> <span class="n">ii</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">jj</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="n">check_cf</span><span class="p">,</span> <span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))(</span><span class="n">sm</span><span class="p">,</span> <span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Ê¨°„Å´„ÄÅ‰∫àÊ∏¨ÂÄ§„ÅåË≤†„Å´„Å™„Å£„ÅüÔºà„Åô„Å™„Çè„Å°logits„Åå0„Çà„ÇäÂ∞è„Åï„ÅÑÔºâ„Ç¢„Éü„ÉéÈÖ∏ÁΩÆÊèõ„Çí„Åô„Åπ„Å¶Ë°®Á§∫„Åó„Åæ„Åô„ÄÇ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span>

<span class="n">out</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&lt;tt&gt;&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ii</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">],</span> <span class="n">jj</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]):</span>
    <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">s</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&lt;span style=&quot;color:red;&quot;&gt;</span><span class="si">{</span><span class="n">ALPHABET</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="si">}</span><span class="s1">&lt;/span&gt;</span><span class="si">{</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span><span class="si">}</span><span class="s1">&lt;br/&gt;&#39;</span><span class="p">)</span>
<span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&lt;/tt&gt;&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><tt>RAGL<span style="color:red;">-</span>FPVGRLLRRLLRRLLR<br/>RAGLQF<span style="color:red;">-</span>VGRLLRRLLRRLLR<br/>RAGL<span style="color:red;">A</span>FPVGRLLRRLLRRLLR<br/>RAGLQF<span style="color:red;">A</span>VGRLLRRLLRRLLR<br/>RAGL<span style="color:red;">C</span>FPVGRLLRRLLRRLLR<br/>RAGLQF<span style="color:red;">C</span>VGRLLRRLLRRLLR<br/>RAGLQFP<span style="color:red;">C</span>GRLLRRLLRRLLR<br/>RAGL<span style="color:red;">I</span>FPVGRLLRRLLRRLLR<br/>RAGLQF<span style="color:red;">I</span>VGRLLRRLLRRLLR<br/>RAGL<span style="color:red;">L</span>FPVGRLLRRLLRRLLR<br/>RAGLQF<span style="color:red;">L</span>VGRLLRRLLRRLLR<br/>RAGL<span style="color:red;">F</span>FPVGRLLRRLLRRLLR<br/>RAGLQF<span style="color:red;">F</span>VGRLLRRLLRRLLR<br/>RAGLQFP<span style="color:red;">F</span>GRLLRRLLRRLLR<br/>RAGL<span style="color:red;">P</span>FPVGRLLRRLLRRLLR<br/>RAGL<span style="color:red;">T</span>FPVGRLLRRLLRRLLR<br/>RAGL<span style="color:red;">W</span>FPVGRLLRRLLRRLLR<br/>RAGL<span style="color:red;">V</span>FPVGRLLRRLLRRLLR<br/>RAGLQF<span style="color:red;">V</span>VGRLLRRLLRRLLR<br/></tt></div></div>
</div>
<p>Ëß£Èáà„ÅØ„ÅÑ„Åè„Å§„Åã„ÅÇ„Çä„Åæ„Åô„Åå„ÄÅÂü∫Êú¨ÁöÑ„Å´„ÅØ„Ç∞„É´„Çø„Éü„É≥„ÇíÁñèÊ∞¥Âü∫„Å®‰∫§Êèõ„Åô„Çã„Åã„ÄÅ„Éó„É≠„É™„É≥„ÇíV„ÄÅF„ÄÅA„ÄÅC„Å´ÁΩÆ„ÅçÊèõ„Åà„Çã„Åì„Å®„Åß„Éö„Éó„ÉÅ„Éâ„ÇíÈùûÊ∫∂Ë°ÄÊÄß„Å´„Åô„Çã„Å®„ÅÑ„ÅÜËß£Èáà„Åß„Åô„ÄÇÂèçÂÆü‰ªÆÊÉ≥„Å®„Åó„Å¶Ëø∞„Åπ„Çã„Å®„ÄÅ„Äå„ÇÇ„Åó„Ç∞„É´„Çø„Éü„É≥„ÇíÁñéÊ∞¥ÊÄß„Ç¢„Éü„ÉéÈÖ∏„Å´‰∫§Êèõ„Åô„Çå„Å∞„ÄÅ„Åù„ÅÆ„Éö„Éó„ÉÅ„Éâ„ÅØÈùûÊ∫∂Ë°ÄÊÄß„Å´„Å™„Çã„Åß„Åó„Çá„ÅÜ„Äç„Å®„ÅÑ„ÅÜ„Åì„Å®„Å´„Å™„Çä„Åæ„Åô„ÄÇ</p>
</section>
</section>
<section id="id52">
<h2><span class="section-number">12.9. </span>ÁâπÂÆö„ÅÆ„Ç¢„Éº„Ç≠„ÉÜ„ÇØ„ÉÅ„É£„ÅÆË™¨Êòé<a class="headerlink" href="#id52" title="Permalink to this headline">¬∂</a></h2>
<p>‰∏äË®ò„Å®Âêå„ÅòÂéüÂâá„ÅåGNN„Å´„ÇÇÈÅ©Áî®„Åï„Çå„Åæ„Åô„Åå„ÄÅ„Åì„Çå„Çâ„ÅÆ„Ç¢„Ç§„Éá„Ç¢„Çí„Ç∞„É©„Éï‰∏ä„ÅßÂãï‰Ωú„Åô„Çã„Çà„ÅÜ„Å´Â§âÊèõ„Åô„ÇãÊúÄÈÅ©„Å™ÊñπÊ≥ï„Å´„Å§„ÅÑ„Å¶„ÅØÊßò„ÄÖ„Å™„Ç¢„Ç§„Éá„Ç¢„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇGNN„Å´ÁâπÂåñ„Åó„ÅüËß£ÈáàÂèØËÉΩÊÄß„ÅÆÁêÜË´ñ„Å´„Å§„ÅÑ„Å¶„ÅØ<span id="id53">[<a class="reference internal" href="#id213" title="Chirag Agarwal, Marinka Zitnik, and Himabindu Lakkaraju. Towards a rigorous theoretical analysis and evaluation of gnn explanations. arXiv preprint arXiv:2106.09078, 2021.">AZL21</a>]</span>„Çí„ÄÅGNN„ÅßË™¨Êòé„ÇíÊßãÁØâ„Åô„Çã„Åü„ÇÅ„Å´Âà©Áî®„Åß„Åç„ÇãÊâãÊ≥ï„Å´„Å§„ÅÑ„Å¶„ÅØ<span id="id54">[<a class="reference internal" href="#id214" title="Hao Yuan, Haiyang Yu, Shurui Gui, and Shuiwang Ji. Explainability in graph neural networks: a taxonomic survey. arXiv preprint arXiv:2012.15445, 2020.">YYGJ20</a>]</span>„ÇíÂèÇÁÖß„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
<p>NLP„ÅØË™¨Êòé„Å®Ëß£Èáà„ÇíÊßãÁØâ„Åô„Çã„Åü„ÇÅ„ÅÆÁâπÂà•„Å™„Ç¢„Éó„É≠„Éº„ÉÅ„ÅåÂ≠òÂú®„Åô„Çã„ÇÇ„ÅÜ‰∏Ä„Å§„ÅÆÂàÜÈáé„Åß„Åô„ÄÇÊúÄËøë„ÅÆË™øÊüª„Å®„Åó„Å¶<span id="id55">[<a class="reference internal" href="#id217" title="Andreas Madsen, Siva Reddy, and Sarath Chandar. Post-hoc interpretability for neural nlp: a survey. arXiv preprint arXiv:2108.04840, 2021.">MRC21</a>]</span>„ÇíÂèÇÁÖß„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
</section>
<section id="id56">
<h2><span class="section-number">12.10. </span>„É¢„Éá„É´Èùû‰æùÂ≠òÁöÑ„Å™ÂàÜÂ≠ê„ÅÆÂèçÂÆü‰ªÆÊÉ≥„ÅÆË™¨Êòé<a class="headerlink" href="#id56" title="Permalink to this headline">¬∂</a></h2>
<p>ÂåñÂ≠¶„Å´„Åä„Åë„ÇãÂèçÂÆü‰ªÆÊÉ≥„Å´Èñ¢ÈÄ£„Åô„Çã‰∏ª„Å™Ë™≤È°å„ÅØ<a class="reference internal" href="#equation-cf">(12.14)</a>„ÅÆÂæÆÂàÜ„ÇíË®àÁÆó„Åô„Çã„Åì„Å®„ÅÆÈõ£„Åó„Åï„Åß„Åô„ÄÇ„Åó„Åü„Åå„Å£„Å¶„ÄÅ„Åì„ÅÆ„Çø„Çπ„ÇØ„Å´ÁÑ¶ÁÇπ„ÇíÂΩì„Å¶„Åü„Åª„Å®„Çì„Å©„ÅÆÊâãÊ≥ï„ÅØ„ÄÅ„Åì„Çå„Åæ„ÅßË¶ã„Å¶„Åç„Åü„Çà„ÅÜ„Å´„É¢„Éá„É´„ÅÆ„Ç¢„Éº„Ç≠„ÉÜ„ÇØ„ÉÅ„É£„Å´ÁâπÂåñ„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇWellawatte„Çâ<span id="id57">[<a class="reference internal" href="#id215" title="Geemi P Wellawatte, Aditi Seshadri, and Andrew D White. Model agnostic generation of counterfactual explanations for molecules. Chem. Sci., pages -, 2022. URL: http://dx.doi.org/10.1039/D1SC05259D, doi:10.1039/D1SC05259D.">WSW22</a>]</span>„ÅØ„É¢„Éá„É´„ÅÆ„Ç¢„Éº„Ç≠„ÉÜ„ÇØ„ÉÅ„É£„Å´Èñ¢‰øÇ„Å™„ÅèÂàÜÂ≠ê„Å´ÂØæ„Åó„Å¶„Åì„Çå„ÇíË°å„ÅÜMolecular Model Agnostic Counterfactual ExplanationsÔºàMMACEÔºâ„Å®„ÅÑ„ÅÜÊñπÊ≥ï„ÇíÂ∞éÂÖ•„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ</p>
<p>MMACEÊ≥ï„ÅØ<code class="docutils literal notranslate"><span class="pre">exmol</span></code>„Éë„ÉÉ„Ç±„Éº„Ç∏„ÅßÂÆüË£Ö„Åï„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇÂàÜÂ≠ê„Å®„É¢„Éá„É´„Çí‰∏é„Åà„Çã„Å®„ÄÅ<code class="docutils literal notranslate"><span class="pre">exmol</span></code>„ÅØÂ±ÄÊâÄÁöÑ„Å™ÂèçÂÆü‰ªÆÊÉ≥ÁöÑË™¨Êòé„ÇíÁîüÊàê„Åô„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇMMACEÊ≥ï„Å´„ÅØ2„Å§„ÅÆ‰∏ªË¶Å„Å™„Çπ„ÉÜ„ÉÉ„Éó„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ„Åæ„Åö„ÄÅ‰∏é„Åà„Çâ„Çå„ÅüÂü∫Êú¨ÂàÜÂ≠ê„Çí‰∏≠ÂøÉ„Å´Â±ÄÊâÄÁöÑ„Å™ÂåñÂ≠¶Á©∫Èñì„ÇíÂ±ïÈñã„Åó„Åæ„Åô„ÄÇÊ¨°„Å´„ÄÅÂêÑ„Çµ„É≥„Éó„É´ÁÇπ„Å´„ÄÅ„É¶„Éº„Ç∂„ÅåÊåáÂÆö„Åó„Åü„É¢„Éá„É´„Ç¢„Éº„Ç≠„ÉÜ„ÇØ„ÉÅ„É£„ÅÆ„É©„Éô„É´„Çí‰ªò„Åë„Åæ„Åô„ÄÇ„Åì„Çå„Çâ„ÅÆ„É©„Éô„É´„ÅØ„ÄÅÂ±ÄÊâÄÁöÑ„Å™ÂåñÂ≠¶Á©∫Èñì„Å´„Åä„Åë„ÇãÂèçÂÆü‰ªÆÊÉ≥„ÇíÁâπÂÆö„Åô„Çã„Åü„ÇÅ„Å´‰ΩøÁî®„Åï„Çå„Åæ„Åô„ÄÇMMACEÊ≥ï„ÅØ„É¢„Éá„É´Èùû‰æùÂ≠òÁöÑ„Åß„ÄÅ<code class="docutils literal notranslate"><span class="pre">exmol</span></code>„Éë„ÉÉ„Ç±„Éº„Ç∏„ÅØÂàÜÈ°û„Å®ÂõûÂ∏∞„ÅÆ‰∏°Êñπ„ÅÆ„Çø„Çπ„ÇØ„Å´ÂØæ„Åó„Å¶ÂèçÂÆü‰ªÆÊÉ≥„ÇíÁîüÊàê„Åô„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ</p>
<p>„Åù„Çå„Åß„ÅØ„ÄÅ<code class="docutils literal notranslate"><span class="pre">exmol</span></code>„Çí‰Ωø„Å£„Å¶„Å©„ÅÆ„Çà„ÅÜ„Å´ÂèçÂÆü‰ªÆÊÉ≥„ÇíÁîüÊàê„Åô„Çã„ÅÆ„ÅãË¶ã„Å¶„Åø„Åæ„Åó„Çá„ÅÜ„ÄÇ„Åì„ÅÆ‰æã„Åß„ÅØ„ÄÅÂàÜÂ≠ê„ÅÆËá®Â∫äÊØíÊÄß„Çí‰∫àÊ∏¨„Åô„Çã„É©„É≥„ÉÄ„É†„Éï„Ç©„É¨„Çπ„Éà„É¢„Éá„É´„ÇíÂ≠¶Áøí„Åó„Åæ„Åô„ÄÇ„Åì„ÅÆ‰∫åÂÄ§ÂàÜÈ°û„Çø„Çπ„ÇØ„Åß„ÅØ„ÄÅMoleculeNet„Ç∞„É´„Éº„Éó<span id="id58">[<a class="reference internal" href="../ml/classification.html#id31" title="Zhenqin Wu, Bharath Ramsundar, Evan N Feinberg, Joseph Gomes, Caleb Geniesse, Aneesh S Pappu, Karl Leswing, and Vijay Pande. Moleculenet: a benchmark for molecular machine learning. Chemical science, 9(2):513‚Äì530, 2018.">WRF+18</a>]</span>„ÅåÁô∫Ë°®„Åó„Åü<a class="reference internal" href="../ml/classification.html"><span class="doc">Classification</span></a>Á´†„Åß‰ΩøÁî®„Åó„Åü„ÅÆ„Å®Âêå„Åò„Éá„Éº„Çø„Çª„ÉÉ„Éà„Çí‰Ωø„ÅÑ„Åæ„Åô„ÄÇ</p>
</section>
<section id="id59">
<h2><span class="section-number">12.11. </span>Notebook„ÅÆÂÆüË°å<a class="headerlink" href="#id59" title="Permalink to this headline">¬∂</a></h2>
<p>‰∏ä„ÅÆ„ÄÄ¬†<i aria-label="Launch interactive content" class="fas fa-rocket"></i>¬† „Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶„Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„Éñ„Å™Google Colab„Åß„Åì„ÅÆ„Éö„Éº„Ç∏„ÇíÈñãÂßã„Åó„Åæ„Åó„Çá„ÅÜ„ÄÇ„ÅîËá™Ë∫´„ÅÆÁí∞Â¢É„Åß„ÇÇGoogle Colab„Åß„ÇÇ„ÄÅ„Éë„ÉÉ„Ç±„Éº„Ç∏„ÅÆ„Ç§„É≥„Çπ„Éà„Éº„É´Èñ¢„Åô„ÇãË©≥Á¥∞„ÅØ‰ª•‰∏ã„ÇíÂèÇÁÖß„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
<div class="dropdown admonition tip">
<p class="admonition-title">Tip</p>
<p>„Éë„ÉÉ„Ç±„Éº„Ç∏„Çí„Ç§„É≥„Çπ„Éà„Éº„É´„Åô„Çã„Å´„ÅØ„ÄÅÊñ∞Ë¶è„Çª„É´„Çí‰ΩúÊàê„Åó„Å¶Ê¨°„ÅÆ„Ç≥„Éº„Éâ„ÇíÂÆüË°å„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!pip install exmol jupyter-book matplotlib numpy pandas seaborn sklearn mordred[full] rdkit-pypi
</pre></div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">rdkit</span><span class="o">,</span> <span class="nn">rdkit.Chem</span><span class="o">,</span> <span class="nn">rdkit.Chem.Draw</span>
<span class="kn">from</span> <span class="nn">rdkit.Chem.Draw</span> <span class="kn">import</span> <span class="n">IPythonConsole</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">mordred</span><span class="o">,</span> <span class="nn">mordred.descriptors</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">tensorflow</span> <span class="kn">import</span> <span class="n">keras</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.wrappers.scikit_learn</span> <span class="kn">import</span> <span class="n">KerasClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">StratifiedKFold</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="kn">import</span> <span class="nn">exmol</span>

<span class="n">IPythonConsole</span><span class="o">.</span><span class="n">ipython_useSVG</span> <span class="o">=</span> <span class="kc">True</span>


<span class="n">toxdata</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;https://github.com/whitead/dmol-book/raw/master/data/clintox.csv.gz&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># make object that can compute descriptors</span>
<span class="n">calc</span> <span class="o">=</span> <span class="n">mordred</span><span class="o">.</span><span class="n">Calculator</span><span class="p">(</span><span class="n">mordred</span><span class="o">.</span><span class="n">descriptors</span><span class="p">,</span> <span class="n">ignore_3D</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># make subsample from pandas df</span>
<span class="n">molecules</span> <span class="o">=</span> <span class="p">[</span><span class="n">rdkit</span><span class="o">.</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">smi</span><span class="p">)</span> <span class="k">for</span> <span class="n">smi</span> <span class="ow">in</span> <span class="n">toxdata</span><span class="o">.</span><span class="n">smiles</span><span class="p">]</span>

<span class="c1"># view one molecule to make sure things look good.</span>
<span class="n">molecules</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><?xml version='1.0' encoding='iso-8859-1'?>
<svg version='1.1' baseProfile='full'
              xmlns='http://www.w3.org/2000/svg'
                      xmlns:rdkit='http://www.rdkit.org/xml'
                      xmlns:xlink='http://www.w3.org/1999/xlink'
                  xml:space='preserve'
width='450px' height='150px' viewBox='0 0 450 150'>
<!-- END OF HEADER -->
<rect style='opacity:1.0;fill:#FFFFFF;stroke:none' width='450.0' height='150.0' x='0.0' y='0.0'> </rect>
<path class='bond-0 atom-0 atom-1' d='M 126.3,33.3 L 141.2,27.3' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-1 atom-1 atom-2' d='M 139.4,27.0 L 141.5,12.4' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-1 atom-1 atom-2' d='M 143.0,27.5 L 145.0,12.9' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-2 atom-1 atom-3' d='M 141.2,27.3 L 155.4,38.4' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-3 atom-3 atom-4' d='M 161.2,36.7 L 160.7,35.6' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:1.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-3 atom-3 atom-4' d='M 167.0,35.0 L 166.1,32.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:1.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-3 atom-3 atom-4' d='M 172.8,33.3 L 171.4,30.0' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:1.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-4 atom-4 atom-5' d='M 172.1,31.6 L 186.3,42.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-5 atom-5 atom-6' d='M 186.3,42.8 L 203.0,36.0' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-6 atom-6 atom-7' d='M 203.0,36.0 L 217.2,47.2' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-7 atom-7 atom-8' d='M 217.2,47.2 L 231.4,41.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-8 atom-8 atom-9' d='M 236.5,42.4 L 248.2,51.6' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-9 atom-9 atom-10' d='M 250.0,51.8 L 247.9,66.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-9 atom-9 atom-10' d='M 246.4,51.3 L 244.3,66.0' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-10 atom-9 atom-11' d='M 248.2,51.6 L 262.0,46.0' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-11 atom-11 atom-12' d='M 267.8,47.1 L 279.1,55.9' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-12 atom-12 atom-13' d='M 279.1,55.9 L 295.8,49.2' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-13 atom-13 atom-14' d='M 295.8,49.2 L 307.1,58.0' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-14 atom-14 atom-15' d='M 313.0,59.2 L 326.8,53.6' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-15 atom-3 atom-16' d='M 155.4,38.4 L 153.3,53.1' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-16 atom-16 atom-17' d='M 155.4,58.2 L 167.0,67.4' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-17 atom-17 atom-18' d='M 166.4,65.7 L 180.2,60.1' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-17 atom-17 atom-18' d='M 167.7,69.0 L 181.5,63.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-18 atom-17 atom-19' d='M 167.0,67.4 L 165.0,82.0' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-19 atom-19 atom-20' d='M 167.4,87.5 L 178.7,96.3' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-20 atom-20 atom-21' d='M 178.7,96.3 L 176.2,114.2' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-21 atom-21 atom-22' d='M 176.2,114.2 L 187.4,123.0' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-22 atom-22 atom-23' d='M 189.9,128.6 L 187.8,143.2' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='atom-0' d='M 123.5 33.4
L 124.2 32.7
L 123.2 32.5
L 123.4 31.9
L 124.3 32.4
L 124.2 31.4
L 124.7 31.4
L 124.6 32.4
L 125.5 32.0
L 125.7 32.5
L 124.6 32.6
L 125.4 33.4
L 124.9 33.7
L 124.4 32.8
L 123.9 33.7
L 123.5 33.4
' fill='#000000'/>
<path class='atom-2' d='M 141.4 9.4
Q 141.4 8.2, 142.0 7.5
Q 142.6 6.8, 143.7 6.8
Q 144.9 6.8, 145.5 7.5
Q 146.1 8.2, 146.1 9.4
Q 146.1 10.7, 145.5 11.4
Q 144.8 12.1, 143.7 12.1
Q 142.6 12.1, 142.0 11.4
Q 141.4 10.7, 141.4 9.4
M 143.7 11.5
Q 144.5 11.5, 144.9 11.0
Q 145.3 10.4, 145.3 9.4
Q 145.3 8.4, 144.9 7.9
Q 144.5 7.4, 143.7 7.4
Q 142.9 7.4, 142.5 7.9
Q 142.1 8.4, 142.1 9.4
Q 142.1 10.4, 142.5 11.0
Q 142.9 11.5, 143.7 11.5
' fill='#000000'/>
<path class='atom-8' d='M 232.8 37.9
L 234.5 40.6
Q 234.7 40.9, 234.9 41.3
Q 235.2 41.8, 235.2 41.8
L 235.2 37.9
L 235.9 37.9
L 235.9 43.0
L 235.2 43.0
L 233.4 40.0
Q 233.2 39.7, 233.0 39.3
Q 232.8 38.9, 232.7 38.8
L 232.7 43.0
L 232.0 43.0
L 232.0 37.9
L 232.8 37.9
' fill='#000000'/>
<path class='atom-8' d='M 232.0 32.3
L 232.7 32.3
L 232.7 34.4
L 235.3 34.4
L 235.3 32.3
L 236.0 32.3
L 236.0 37.4
L 235.3 37.4
L 235.3 35.0
L 232.7 35.0
L 232.7 37.4
L 232.0 37.4
L 232.0 32.3
' fill='#000000'/>
<path class='atom-10' d='M 243.3 69.4
Q 243.3 68.2, 243.9 67.5
Q 244.5 66.8, 245.6 66.8
Q 246.8 66.8, 247.4 67.5
Q 248.0 68.2, 248.0 69.4
Q 248.0 70.7, 247.4 71.4
Q 246.8 72.1, 245.6 72.1
Q 244.5 72.1, 243.9 71.4
Q 243.3 70.7, 243.3 69.4
M 245.6 71.5
Q 246.4 71.5, 246.8 71.0
Q 247.3 70.5, 247.3 69.4
Q 247.3 68.4, 246.8 67.9
Q 246.4 67.4, 245.6 67.4
Q 244.9 67.4, 244.4 67.9
Q 244.0 68.4, 244.0 69.4
Q 244.0 70.5, 244.4 71.0
Q 244.9 71.5, 245.6 71.5
' fill='#000000'/>
<path class='atom-11' d='M 262.6 44.8
Q 262.6 43.6, 263.2 42.9
Q 263.8 42.2, 264.9 42.2
Q 266.0 42.2, 266.6 42.9
Q 267.2 43.6, 267.2 44.8
Q 267.2 46.1, 266.6 46.8
Q 266.0 47.5, 264.9 47.5
Q 263.8 47.5, 263.2 46.8
Q 262.6 46.1, 262.6 44.8
M 264.9 46.9
Q 265.7 46.9, 266.1 46.4
Q 266.5 45.9, 266.5 44.8
Q 266.5 43.8, 266.1 43.3
Q 265.7 42.8, 264.9 42.8
Q 264.1 42.8, 263.7 43.3
Q 263.3 43.8, 263.3 44.8
Q 263.3 45.9, 263.7 46.4
Q 264.1 46.9, 264.9 46.9
' fill='#000000'/>
<path class='atom-14' d='M 307.7 60.4
Q 307.7 59.1, 308.3 58.4
Q 308.9 57.8, 310.0 57.8
Q 311.2 57.8, 311.8 58.4
Q 312.4 59.1, 312.4 60.4
Q 312.4 61.6, 311.8 62.3
Q 311.1 63.0, 310.0 63.0
Q 308.9 63.0, 308.3 62.3
Q 307.7 61.6, 307.7 60.4
M 310.0 62.4
Q 310.8 62.4, 311.2 61.9
Q 311.6 61.4, 311.6 60.4
Q 311.6 59.4, 311.2 58.8
Q 310.8 58.3, 310.0 58.3
Q 309.2 58.3, 308.8 58.8
Q 308.4 59.3, 308.4 60.4
Q 308.4 61.4, 308.8 61.9
Q 309.2 62.4, 310.0 62.4
' fill='#000000'/>
<path class='atom-16' d='M 146.3 53.7
L 147.0 53.7
L 147.0 55.9
L 149.6 55.9
L 149.6 53.7
L 150.3 53.7
L 150.3 58.8
L 149.6 58.8
L 149.6 56.4
L 147.0 56.4
L 147.0 58.8
L 146.3 58.8
L 146.3 53.7
' fill='#000000'/>
<path class='atom-16' d='M 151.7 53.7
L 153.4 56.4
Q 153.6 56.7, 153.8 57.1
Q 154.1 57.6, 154.1 57.7
L 154.1 53.7
L 154.8 53.7
L 154.8 58.8
L 154.1 58.8
L 152.3 55.8
Q 152.1 55.5, 151.9 55.1
Q 151.6 54.7, 151.6 54.6
L 151.6 58.8
L 150.9 58.8
L 150.9 53.7
L 151.7 53.7
' fill='#000000'/>
<path class='atom-18' d='M 181.4 60.6
Q 181.4 59.4, 182.0 58.7
Q 182.6 58.0, 183.8 58.0
Q 184.9 58.0, 185.5 58.7
Q 186.1 59.4, 186.1 60.6
Q 186.1 61.9, 185.5 62.6
Q 184.9 63.3, 183.8 63.3
Q 182.6 63.3, 182.0 62.6
Q 181.4 61.9, 181.4 60.6
M 183.8 62.7
Q 184.6 62.7, 185.0 62.2
Q 185.4 61.7, 185.4 60.6
Q 185.4 59.6, 185.0 59.1
Q 184.6 58.6, 183.8 58.6
Q 183.0 58.6, 182.6 59.1
Q 182.2 59.6, 182.2 60.6
Q 182.2 61.7, 182.6 62.2
Q 183.0 62.7, 183.8 62.7
' fill='#000000'/>
<path class='atom-19' d='M 162.2 85.2
Q 162.2 84.0, 162.8 83.3
Q 163.4 82.6, 164.5 82.6
Q 165.6 82.6, 166.2 83.3
Q 166.9 84.0, 166.9 85.2
Q 166.9 86.5, 166.2 87.2
Q 165.6 87.9, 164.5 87.9
Q 163.4 87.9, 162.8 87.2
Q 162.2 86.5, 162.2 85.2
M 164.5 87.3
Q 165.3 87.3, 165.7 86.8
Q 166.1 86.3, 166.1 85.2
Q 166.1 84.2, 165.7 83.7
Q 165.3 83.2, 164.5 83.2
Q 163.7 83.2, 163.3 83.7
Q 162.9 84.2, 162.9 85.2
Q 162.9 86.3, 163.3 86.8
Q 163.7 87.3, 164.5 87.3
' fill='#000000'/>
<path class='atom-22' d='M 188.0 125.3
Q 188.0 124.1, 188.6 123.4
Q 189.2 122.7, 190.4 122.7
Q 191.5 122.7, 192.1 123.4
Q 192.7 124.1, 192.7 125.3
Q 192.7 126.6, 192.1 127.3
Q 191.5 128.0, 190.4 128.0
Q 189.2 128.0, 188.6 127.3
Q 188.0 126.6, 188.0 125.3
M 190.4 127.4
Q 191.1 127.4, 191.6 126.9
Q 192.0 126.4, 192.0 125.3
Q 192.0 124.3, 191.6 123.8
Q 191.1 123.3, 190.4 123.3
Q 189.6 123.3, 189.2 123.8
Q 188.7 124.3, 188.7 125.3
Q 188.7 126.4, 189.2 126.9
Q 189.6 127.4, 190.4 127.4
' fill='#000000'/>
</svg>
</div></div>
</div>
<p>„Éá„Éº„Çø„Çí„Ç§„É≥„Éù„Éº„Éà„Åó„Åü„Çâ„ÄÅ<code class="docutils literal notranslate"><span class="pre">Mordred</span></code>„Éë„ÉÉ„Ç±„Éº„Ç∏„ÅßÂÖ•ÂäõË®òËø∞Â≠ê„ÇíÁîüÊàê„Åó„Åæ„Åô„ÄÇ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get valid molecules from the sample</span>
<span class="n">valid_mol_idx</span> <span class="o">=</span> <span class="p">[</span><span class="nb">bool</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">molecules</span><span class="p">]</span>
<span class="n">valid_mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">molecules</span> <span class="k">if</span> <span class="n">m</span><span class="p">]</span>
<span class="c1"># Compute molecular descriptors using Mordred</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">valid_mols</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">toxdata</span><span class="p">[</span><span class="n">valid_mol_idx</span><span class="p">]</span><span class="o">.</span><span class="n">FDA_APPROVED</span>
<span class="c1"># Standardize the features</span>
<span class="n">features</span> <span class="o">-=</span> <span class="n">features</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">features</span> <span class="o">/=</span> <span class="n">features</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="c1"># we have some nans in features, likely because std was 0</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">features</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">features_select</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">features</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">features</span><span class="p">[:,</span> <span class="n">features_select</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;We have </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)</span><span class="si">}</span><span class="s2"> features per molecule&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>We have 1478 features per molecule
</pre></div>
</div>
</div>
</div>
<p>„Åì„ÅÆ‰æã„Åß„ÅØ„ÄÅ<code class="docutils literal notranslate"><span class="pre">Keras</span></code>„ÅßÂÆüË£Ö„Åï„Çå„Åü„Ç∑„É≥„Éó„É´„ÅßÂØÜ„Å™„Éã„É•„Éº„É©„É´„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØÂàÜÈ°ûÂô®„Çí‰ΩøÁî®„Åó„Åæ„Åô„ÄÇ„Åæ„Åö„ÄÅ„Åì„ÅÆ„Ç∑„É≥„Éó„É´„Å™ÂàÜÈ°ûÂô®„ÇíÂ≠¶Áøí„Åó„ÄÅ„Åù„Çå„Çí‰Ωø„Å£„Å¶<code class="docutils literal notranslate"><span class="pre">exmol</span></code>„ÅÆÂèçÂÆü‰ªÆÊÉ≥„ÅÆ„É©„Éô„É´„ÇíÁîüÊàê„Åó„Åæ„Åô„ÄÇÂ≠¶ÁøíÊ∏à„Åø„É¢„Éá„É´„ÅÆÊÄßËÉΩ„ÇíÊîπÂñÑ„Åô„Çã„Åì„Å®„Åß„ÄÅ„Çà„ÇäÊ≠£Á¢∫„Å™ÁµêÊûú„ÇíÊúüÂæÖ„Åô„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„Åå„ÄÅexmol„ÅÆ‰ªïÁµÑ„Åø„ÇíÁêÜËß£„Åô„Çã„Å´„ÅØ„ÄÅ‰ªä„ÅÆ„Å®„Åì„Çç‰ª•‰∏ã„ÅÆ‰æã„ÅßÂçÅÂàÜ„Åß„Åô„ÄÇ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Train and test spit</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">ft_shape</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># reshape data</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ft_shape</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ft_shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>„Åù„Çå„Åß„ÅØ„É¢„Éá„É´„ÇíÊßãÁØâ„Åó„Å¶ÂÆüË°å„Åó„Å¶„Åø„Åæ„Åó„Çá„ÅÜ„ÄÇ<a class="reference internal" href="introduction.html"><span class="doc">„Éá„Ç£„Éº„Éó„É©„Éº„Éã„É≥„Ç∞„ÅÆÊ¶ÇË¶Å</span></a> Á´†„Å´ÂØÜ„Å™„É¢„Éá„É´„Å´Èñ¢„Åô„ÇãË©≥„Åó„ÅÑ„Ç§„É≥„Éà„É≠„ÉÄ„ÇØ„Ç∑„Éß„É≥„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">ft_shape</span><span class="p">,)))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;sigmoid&quot;</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s2">&quot;binary_crossentropy&quot;</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="s2">&quot;adam&quot;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;accuracy&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Model training</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">_</span><span class="p">,</span> <span class="n">accuracy</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model accuracy: </span><span class="si">{</span><span class="n">accuracy</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/10 [==&gt;...........................] - ETA: 1s - loss: 0.1194 - accuracy: 0.9688
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
10/10 [==============================] - 0s 1ms/step - loss: 0.2520 - accuracy: 0.9392
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model accuracy: 93.92%
</pre></div>
</div>
</div>
</div>
<p>ÁßÅ„Åü„Å°„Åå‰Ωú„Å£„Åü„É¢„Éá„É´„ÅÆÊ≠£Á¢∫Â∫¶„ÅØËâØ„Åï„Åù„ÅÜ„Åß„Åô„Å≠ÔºÅ</p>
<p>Ê¨°„Å´„ÄÅSMILESÂèä„Å≥/„Åæ„Åü„ÅØSEFLIES„ÅÆÂàÜÂ≠êË°®Áèæ„ÇíÂèñ„ÇäËæº„Åø„ÄÅÂ≠¶ÁøíÊ∏à„ÅøÂàÜÈ°ûÂô®„Åã„Çâ„É©„Éô„É´„ÅÆ‰∫àÊ∏¨„ÇíÂá∫Âäõ„Åô„Çã„É©„ÉÉ„Éë„ÉºÈñ¢Êï∞„ÇíÊõ∏„Åç„Åæ„Åô„ÄÇSELFIES„ÅÆË©≥„Åó„ÅÑË™¨Êòé„ÅØ<a class="reference internal" href="NLP.html"><span class="doc">Deep Learning on Sequences</span></a>„ÅÆÁ´†„Å´„ÅÇ„Çä„Åæ„Åô„ÄÇ„Åì„ÅÆ„É©„ÉÉ„Éë„ÉºÈñ¢Êï∞„ÅØ <code class="docutils literal notranslate"><span class="pre">exmol</span></code>„ÅÆ<a class="reference external" href="https://ur-whitelab.github.io/exmol/api.html#exmol.exmol.sample_space" title="(in exmol)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">exmol.sample_space</span></code></a>„Å´ÂÖ•Âäõ„Å®„Åó„Å¶‰∏é„Åà„Çâ„Çå„ÄÅ‰∏é„Åà„Çâ„Çå„Åü„Éô„Éº„Çπ„Å®„Å™„ÇãÂàÜÂ≠ê„ÅÆÂë®„Çä„Å´Â±ÄÊâÄÁöÑ„Å™ÂåñÂ≠¶Á©∫Èñì„Çí‰Ωú„Çä„Åæ„Åô„ÄÇ<code class="docutils literal notranslate"><span class="pre">exmol</span></code>„ÅØ„ÄÅSuperfast Traversal, Optimization, Novelty, Exploration and Discovery (STONED)„Ç¢„É´„Ç¥„É™„Ç∫„É†<span id="id60">[<a class="reference internal" href="#id231" title="AkshatKumar Nigam, Robert Pollice, Mario Krenn, Gabriel dos Passos Gomes, and Al√°n Aspuru-Guzik. Beyond generative models: superfast traversal, optimization, novelty, exploration and discovery (stoned) algorithm for molecules using selfies. Chem. Sci., 12:7079‚Äì7090, 2021. URL: http://dx.doi.org/10.1039/D1SC00231G, doi:10.1039/D1SC00231G.">NPK+21</a>]</span>„ÇíÁîüÊàê„Ç¢„É´„Ç¥„É™„Ç∫„É†„Å®„Åó„Å¶‰ΩøÁî®„Åó„Å¶„ÄÅÂ±ÄÊâÄÁ©∫Èñì„ÇíÊã°Âºµ„Åó„Å¶„ÅÑ„Åç„Åæ„Åô„ÄÇ„Éô„Éº„Çπ„Å®„Å™„ÇãÂàÜÂ≠ê„Åå‰∏é„Åà„Çâ„Çå„Çã„Å®„ÄÅSTONED„Ç¢„É´„Ç¥„É™„Ç∫„É†„ÅØÂàÜÂ≠ê„ÅÆSELFIESË°®Áèæ„Çí„É©„É≥„ÉÄ„É†„Å´Â§âÁï∞„Åï„Åõ„Åæ„Åô„ÄÇ„Åì„Çå„Çâ„ÅÆÂ§âÁï∞„ÅØÊñáÂ≠óÂàóÁΩÆÊèõ„ÄÅÊåøÂÖ•„ÄÅÊ¨†Êêç„Åß„Åô„ÄÇ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">model_eval</span><span class="p">(</span><span class="n">smiles</span><span class="p">,</span> <span class="n">selfies</span><span class="p">):</span>
    <span class="n">molecules</span> <span class="o">=</span> <span class="p">[</span><span class="n">rdkit</span><span class="o">.</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">smi</span><span class="p">)</span> <span class="k">for</span> <span class="n">smi</span> <span class="ow">in</span> <span class="n">smiles</span><span class="p">]</span>
    <span class="n">features</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">molecules</span><span class="p">)</span>
    <span class="n">features</span> <span class="o">=</span> <span class="n">features</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">features</span> <span class="o">=</span> <span class="n">features</span><span class="p">[:,</span> <span class="n">features_select</span><span class="p">]</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="n">features</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ft_shape</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">labels</span>
</pre></div>
</div>
</div>
</div>
<p>Ê¨°„Å´„ÄÅSTONED„Çí‰Ωø„Å£„Å¶„ÄÅ<a class="reference external" href="https://ur-whitelab.github.io/exmol/api.html#exmol.exmol.sample_space" title="(in exmol)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">exmol.sample_space</span></code></a>„ÅßÂ±ÄÊâÄÁöÑ„Å™ÂåñÂ≠¶Á©∫Èñì„Çí„Çµ„É≥„Éó„É™„É≥„Ç∞„Åó„Å¶„Åø„Åæ„Åô„ÄÇ„Åì„ÅÆ‰æã„Åß„ÅØ„ÄÅÂºïÊï∞<code class="docutils literal notranslate"><span class="pre">num_samples</span></code>„Åß„Çµ„É≥„Éó„É´Á©∫Èñì„ÅÆÂ§ß„Åç„Åï„ÇíÂ§âÊõ¥„Åó„Åæ„Åô„ÄÇ„Åì„Åì„ÅßÈÅ∏Êäû„Åó„Åü„Éô„Éº„Çπ„Å®„Å™„ÇãÂàÜÂ≠ê„ÅØFDAÈùûÊâøË™çÂàÜÂ≠ê„Åß„Åô„ÄÇ</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">space</span> <span class="o">=</span> <span class="n">exmol</span><span class="o">.</span><span class="n">sample_space</span><span class="p">(</span><span class="s2">&quot;C1CC(=O)NC(=O)C1N2CC3=C(C2=O)C=CC=C3N&quot;</span><span class="p">,</span> <span class="n">model_eval</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>„ÅÑ„Å£„Åü„Çì„Çµ„É≥„Éó„É´Á©∫Èñì„Çí‰ΩúÊàê„Åó„Åü„Çâ„ÄÅ<a class="reference external" href="https://ur-whitelab.github.io/exmol/api.html#exmol.exmol.cf_explain" title="(in exmol)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">exmol.sample_space</span></code></a>Èñ¢Êï∞„Çí‰Ωø„Å£„Å¶Â±ÄÊâÄÁöÑ„Å™ÂåñÂ≠¶Á©∫Èñì„ÅÆÂèçÂÆü‰ªÆÊÉ≥„ÇíÁâπÂÆö„Åß„Åç„Åæ„Åô„ÄÇÂêÑÂèçÂÆü‰ªÆÊÉ≥„ÅØ„ÄÅ‰ªòÂä†ÊÉÖÂ†±„ÇíÂê´„ÇÄpython„ÅÆ<code class="docutils literal notranslate"><span class="pre">dataclass</span></code>„Åß„Åô„ÄÇ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">exps</span> <span class="o">=</span> <span class="n">exmol</span><span class="o">.</span><span class="n">cf_explain</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">exps</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">IndexError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span> <span class="p">[</span><span class="mi">32</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">exps</span> <span class="o">=</span> <span class="n">exmol</span><span class="o">.</span><span class="n">cf_explain</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">exps</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="ne">IndexError</span>: list index out of range
</pre></div>
</div>
</div>
</div>
<p>ÁîüÊàê„Åï„Çå„ÅüÂèçÂÆü‰ªÆÊÉ≥„ÅØ<code class="docutils literal notranslate"><span class="pre">exmol</span></code>„ÅÆ„Éó„É≠„ÉÉ„Éà„Ç≥„Éº„Éâ<a class="reference external" href="https://ur-whitelab.github.io/exmol/api.html#exmol.exmol.plot_space" title="(in exmol)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">exmol.sample_space</span></code></a>„Å®<a class="reference external" href="https://ur-whitelab.github.io/exmol/api.html#exmol.exmol.plot_cf" title="(in exmol)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">exmol.sample_space</span></code></a>„Çí‰Ωø„Å£„Å¶Á∞°Âçò„Å´ÂèØË¶ñÂåñ„Åß„Åç„Åæ„Åô„ÄÇ„Éô„Éº„Çπ„Å®ÂèçÂÆü‰ªÆÊÉ≥„ÅÆÈñì„ÅÆÈ°û‰ººÂ∫¶„ÅØECFP4„Éï„Ç£„É≥„Ç¨„Éº„Éó„É™„É≥„Éà„ÅÆ„Çø„Éã„É¢„Éà‰øÇÊï∞„Åß„Åô„ÄÇ‰∏ä‰Ωç3„Å§„ÅÆÂèçÂÆü‰ªÆÊÉ≥„Çí„Åì„Åì„Å´Á§∫„Åó„Åæ„Åô„ÄÇ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">exmol</span><span class="o">.</span><span class="n">plot_cf</span><span class="p">(</span><span class="n">exps</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>„Åì„Åì„ÅßÈÅ∏Êäû„Åó„Åü„Éô„Éº„Çπ„Å®„Å™„ÇãÂàÜÂ≠ê„ÅØFDAÈùûÊâøË™ç„Åß„Åô„ÄÇÁîüÊàê„Åï„Çå„ÅüÂèçÂÆü‰ªÆÊÉ≥„ÇíË¶ã„Çã„Å®„ÄÅË§áÁ¥†Áí∞ÂºèÂü∫„ÅØÊØíÊÄß„Å´ÂΩ±Èüø„Çí‰∏é„Åà„Çã„Å®ÁµêË´ñ„Å•„Åë„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ„Åó„Åü„Åå„Å£„Å¶„ÄÅÊàë„ÄÖ„ÅÆ„É¢„Éá„É´„Å´„Çà„Çã„Å®„ÄÅË§áÁ¥†Áí∞ÂºèÂü∫„ÇíÂ§âÊõ¥„Åô„Çã„Åì„Å®„Åß„Éô„Éº„Çπ„Å®„Å™„ÇãÂàÜÂ≠ê„ÅØÈùûÊØíÊÄßÂåñ„Åï„Çå„Çã„Åã„ÇÇ„Åó„Çå„Åæ„Åõ„Çì„ÄÇ„Åì„ÅÆ„Åì„Å®„ÅØ„ÄÅÂèçÂÆü‰ªÆÊÉ≥„ÅÆË™¨Êòé„Åå„Å©„ÅÆ„Çà„ÅÜ„Å´‰øÆÊ≠£„ÇíÂä†„Åà„Çã„Åì„Å®„Åå„Åß„Åç„Çã„Åã„Å´„Å§„ÅÑ„Å¶„ÅÆÂÆüÁî®ÁöÑ„Å™Ê¥ûÂØü„Çí‰∏é„Åà„ÇãÁêÜÁî±„ÇÇÁ§∫„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ</p>
<p>ÊúÄÂæå„Å´„ÄÅÁîüÊàê„Åó„ÅüÂåñÂ≠¶Á©∫Èñì„ÇÇÂèØË¶ñÂåñ„Åó„Å¶„Åø„Åæ„Åó„Çá„ÅÜÔºÅ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">exmol</span><span class="o">.</span><span class="n">plot_space</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">exps</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id61">
<h2><span class="section-number">12.12. </span>„Åæ„Å®„ÇÅ<a class="headerlink" href="#id61" title="Permalink to this headline">¬∂</a></h2>
<ul class="simple">
<li><p>„Éá„Ç£„Éº„Éó„É©„Éº„Éã„É≥„Ç∞„É¢„Éá„É´„ÅÆËß£Èáà„ÅØ„ÄÅ„É¢„Éá„É´„ÅÆÊ≠£Á¢∫ÊÄß„Çí‰øùË®º„Åó„ÄÅ‰∫àÊ∏¨„Çí‰∫∫„Å´„Å®„Å£„Å¶ÊúâÁî®„Å™„ÇÇ„ÅÆ„Å´„Åô„Çã„Åü„ÇÅ„Å´ÂøÖË¶Å‰∏çÂèØÊ¨†„Åß„Åô„ÄÇÊ≥ï‰ª§È†ÜÂÆà„ÅÆ„Åü„ÇÅ„Å´Ë¶ÅÊ±Ç„Åï„Çå„Çã„Åì„Å®„ÇÇ„ÅÇ„Çä„Åæ„Åô„ÄÇ</p></li>
<li><p>„Éã„É•„Éº„É©„É´„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„ÅÆËß£ÈáàÂèØËÉΩÊÄß„ÅØ„ÄÅ„Çà„ÇäÂ∫ÉÁØÑ„Å™„Éà„Éî„ÉÉ„ÇØ„Åß„ÅÇ„ÇãAI„Å´„Åä„Åë„ÇãË™¨ÊòéÂèØËÉΩÊÄßÔºàXAIÔºâ„ÅÆ‰∏ÄÈÉ®„Åß„ÅÇ„Çä„ÄÅ„Åì„ÅÆ„Éà„Éî„ÉÉ„ÇØ„ÅØ„Åæ„Å†ÂàùÊúüÊÆµÈöé„Åß„Åô„ÄÇ</p></li>
<li><p><em>Ë™¨Êòé</em>„ÅØ„Åæ„Å†ÂÆöÁæ©„ÅåÊõñÊòß„Åß„Åô„Åå„ÄÅÂ§ö„Åè„ÅÆÂ†¥Âêà„ÄÅ„É¢„Éá„É´„ÅÆÁâπÂæ¥Èáè„ÅßË°®Áèæ„Åï„Çå„Åæ„Åô„ÄÇ</p></li>
<li><p>Ë™¨Êòé„ÅÆÊà¶Áï•„Å®„Åó„Å¶„ÅØ„ÄÅÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶„ÄÅÂ≠¶Áøí„Éá„Éº„Çø„ÅÆÈáçË¶ÅÂ∫¶„ÄÅÂèçÂÆü‰ªÆÊÉ≥„ÄÅÂ±ÄÊâÄÁöÑ„Å´Ê≠£Á¢∫„Å™„Çµ„É≠„Ç≤„Éº„Éà„É¢„Éá„É´„Å™„Å©„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ</p></li>
<li><p>„Åª„Å®„Çì„Å©„ÅÆË™¨Êòé„ÅØ‰æã„Åî„Å®„Å´ÔºàÊé®Ë´ñÊôÇ„Å´ÔºâÁîüÊàê„Åï„Çå„Åæ„Åô„ÄÇ</p></li>
<li><p>ÊúÄ„ÇÇ‰ΩìÁ≥ªÁöÑ„Åß„Åô„Åå„ÄÅË®àÁÆó„Ç≥„Çπ„Éà„ÅÆ„Åã„Åã„ÇãË™¨Êòé„ÅØ„Ç∑„É£„Éº„Éó„É¨„Ç§ÂÄ§„Åß„Åô„ÄÇ</p></li>
<li><p>ÂèçÂÆü‰ªÆÊÉ≥„ÅØÊúÄ„ÇÇÁõ¥ÊÑüÁöÑ„ÅßÊ∫ÄË∂≥„ÅÆ„ÅÑ„ÅèË™¨Êòé„ÇíÊèê‰æõ„Åó„Åæ„Åô„Åå„ÄÅÂÆåÂÖ®„Å™Ë™¨Êòé„Å´„ÅØ„Å™„Çâ„Å™„ÅÑ„Åã„ÇÇ„Åó„Çå„Å™„ÅÑ„Å®„ÅÑ„ÅÜÊÑèË¶ã„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">exmol</span></code>„ÅØ„É¢„Éá„É´Èùû‰æùÂ≠òÁöÑ„Å™ÂàÜÂ≠ê„ÅÆÂèçÂÆü‰ªÆÊÉ≥„ÅÆË™¨Êòé„ÇíÁîüÊàê„Åô„Çã„ÇΩ„Éï„Éà„Ç¶„Çß„Ç¢„Åß„Åô„ÄÇ</p></li>
</ul>
</section>
<section id="cited-references">
<h2><span class="section-number">12.13. </span>Cited References<a class="headerlink" href="#cited-references" title="Permalink to this headline">¬∂</a></h2>
<div class="docutils container" id="id62">
<dl class="citation">
<dt class="label" id="id81"><span class="brackets"><a class="fn-backref" href="#id58">WRF+18</a></span></dt>
<dd><p>Zhenqin Wu, Bharath Ramsundar, Evan¬†N Feinberg, Joseph Gomes, Caleb Geniesse, Aneesh¬†S Pappu, Karl Leswing, and Vijay Pande. Moleculenet: a benchmark for molecular machine learning. <em>Chemical science</em>, 9(2):513‚Äì530, 2018.</p>
</dd>
<dt class="label" id="id190"><span class="brackets"><a class="fn-backref" href="#id2">LS04</a></span></dt>
<dd><p>John¬†D Lee and Katrina¬†A See. Trust in automation: designing for appropriate reliance. <em>Human factors</em>, 46(1):50‚Äì80, 2004.</p>
</dd>
<dt class="label" id="id189"><span class="brackets">DVK17</span><span class="fn-backref">(<a href="#id3">1</a>,<a href="#id9">2</a>)</span></dt>
<dd><p>Finale Doshi-Velez and Been Kim. Towards a rigorous science of interpretable machine learning. <em>arXiv preprint arXiv:1702.08608</em>, 2017.</p>
</dd>
<dt class="label" id="id198"><span class="brackets"><a class="fn-backref" href="#id4">GF17</a></span></dt>
<dd><p>Bryce Goodman and Seth Flaxman. European Union regulations on algorithmic decision-making and a ‚Äúright to explanation‚Äù. <em>AI Magazine</em>, 38(3):50‚Äì57, 2017.</p>
</dd>
<dt class="label" id="id199"><span class="brackets"><a class="fn-backref" href="#id5">Dev19</a></span></dt>
<dd><p>Organisation for Economic Co-operation¬†and Development. Recommendation of the Council on Artificial Intelligence. 2019. URL: <a class="reference external" href="https://legalinstruments.oecd.org/en/instruments/OECD-LEGAL-0449">https://legalinstruments.oecd.org/en/instruments/OECD-LEGAL-0449</a>.</p>
</dd>
<dt class="label" id="id191"><span class="brackets"><a class="fn-backref" href="#id6">CLG+15</a></span></dt>
<dd><p>Rich Caruana, Yin Lou, Johannes Gehrke, Paul Koch, Marc Sturm, and Noemie Elhadad. Intelligible models for healthcare: Predicting pneumonia risk and hospital 30-day readmission. In <em>Proceedings of the 21th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining</em>, 1721‚Äì1730. ACM, 2015.</p>
</dd>
<dt class="label" id="id216"><span class="brackets"><a class="fn-backref" href="#id8">Mil19</a></span></dt>
<dd><p>Tim Miller. Explanation in artificial intelligence: insights from the social sciences. <em>Artificial intelligence</em>, 267:1‚Äì38, 2019.</p>
</dd>
<dt class="label" id="id192"><span class="brackets"><a class="fn-backref" href="#id10">MSK+19</a></span></dt>
<dd><p>James¬†W Murdoch, Chandan Singh, Karl Kumbier, Reza Abbasi-Asl, and Bin Yu. Interpretable machine learning: definitions, methods, and applications. <em>eprint arXiv</em>, pages 1‚Äì11, 2019. URL: <a class="reference external" href="http://arxiv.org/abs/1901.04592">http://arxiv.org/abs/1901.04592</a>.</p>
</dd>
<dt class="label" id="id193"><span class="brackets"><a class="fn-backref" href="#id11">MSMuller18</a></span></dt>
<dd><p>Gr√©goire Montavon, Wojciech Samek, and Klaus-Robert M√ºller. Methods for interpreting and understanding deep neural networks. <em>Digital Signal Processing</em>, 73:1‚Äì15, 2018.</p>
</dd>
<dt class="label" id="id203"><span class="brackets"><a class="fn-backref" href="#id12">BCB14</a></span></dt>
<dd><p>Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Bengio. Neural machine translation by jointly learning to align and translate. <em>arXiv preprint arXiv:1409.0473</em>, 2014.</p>
</dd>
<dt class="label" id="id232"><span class="brackets"><a class="fn-backref" href="#id13">AGFW21</a></span></dt>
<dd><p>Mehrad Ansari, Heta¬†A Gandhi, David¬†G Foster, and Andrew¬†D White. Iterative symbolic regression for learning transport equations. <em>arXiv preprint arXiv:2108.03293</em>, 2021.</p>
</dd>
<dt class="label" id="id233"><span class="brackets"><a class="fn-backref" href="#id13">BD00</a></span></dt>
<dd><p>Lynne Billard and Edwin Diday. Regression analysis for interval-valued data. In <em>Data analysis, classification, and related methods</em>, pages 369‚Äì374. Springer, 2000.</p>
</dd>
<dt class="label" id="id234"><span class="brackets"><a class="fn-backref" href="#id13">UT20</a></span></dt>
<dd><p>Silviu-Marian Udrescu and Max Tegmark. Ai feynman: a physics-inspired method for symbolic regression. <em>Science Advances</em>, 6(16):eaay2631, 2020.</p>
</dd>
<dt class="label" id="id235"><span class="brackets"><a class="fn-backref" href="#id14">CSGB+20</a></span></dt>
<dd><p>Miles Cranmer, Alvaro Sanchez¬†Gonzalez, Peter Battaglia, Rui Xu, Kyle Cranmer, David Spergel, and Shirley Ho. Discovering symbolic models from deep learning with inductive biases. <em>Advances in Neural Information Processing Systems</em>, 33:17429‚Äì17442, 2020.</p>
</dd>
<dt class="label" id="id215"><span class="brackets">WSW22</span><span class="fn-backref">(<a href="#id15">1</a>,<a href="#id48">2</a>,<a href="#id57">3</a>)</span></dt>
<dd><p>Geemi¬†P Wellawatte, Aditi Seshadri, and Andrew¬†D White. Model agnostic generation of counterfactual explanations for molecules. <em>Chem. Sci.</em>, pages ‚Äì, 2022. URL: <a class="reference external" href="http://dx.doi.org/10.1039/D1SC05259D">http://dx.doi.org/10.1039/D1SC05259D</a>, <a class="reference external" href="https://doi.org/10.1039/D1SC05259D">doi:10.1039/D1SC05259D</a>.</p>
</dd>
<dt class="label" id="id194"><span class="brackets">RSG16a</span><span class="fn-backref">(<a href="#id15">1</a>,<a href="#id44">2</a>,<a href="#id45">3</a>)</span></dt>
<dd><p>Marco¬†Tulio Ribeiro, Sameer Singh, and Carlos Guestrin. &quot; why should i trust you?&quot; explaining the predictions of any classifier. In <em>Proceedings of the 22nd ACM SIGKDD international conference on knowledge discovery and data mining</em>, 1135‚Äì1144. 2016.</p>
</dd>
<dt class="label" id="id195"><span class="brackets"><a class="fn-backref" href="#id15">RSG16b</a></span></dt>
<dd><p>Marco¬†Tulio Ribeiro, Sameer Singh, and Carlos Guestrin. Model-agnostic interpretability of machine learning. <em>arXiv preprint arXiv:1606.05386</em>, 2016.</p>
</dd>
<dt class="label" id="id197"><span class="brackets">WMR17</span><span class="fn-backref">(<a href="#id15">1</a>,<a href="#id17">2</a>,<a href="#id47">3</a>)</span></dt>
<dd><p>Sandra Wachter, Brent Mittelstadt, and Chris Russell. Counterfactual explanations without opening the black box: automated decisions and the gdpr. <em>Harv. JL &amp; Tech.</em>, 31:841, 2017.</p>
</dd>
<dt class="label" id="id196"><span class="brackets">KL17</span><span class="fn-backref">(<a href="#id16">1</a>,<a href="#id42">2</a>)</span></dt>
<dd><p>Pang¬†Wei Koh and Percy Liang. Understanding black-box predictions via influence functions. In <em>International Conference on Machine Learning</em>, 1885‚Äì1894. PMLR, 2017.</p>
</dd>
<dt class="label" id="id201"><span class="brackets"><a class="fn-backref" href="#id18">SML+21</a></span></dt>
<dd><p>Wojciech Samek, Gr√©goire Montavon, Sebastian Lapuschkin, Christopher¬†J. Anders, and Klaus-Robert M√ºller. Explaining deep neural networks and beyond: a review of methods and applications. <em>Proceedings of the IEEE</em>, 109(3):247‚Äì278, 2021. <a class="reference external" href="https://doi.org/10.1109/JPROC.2021.3060483">doi:10.1109/JPROC.2021.3060483</a>.</p>
</dd>
<dt class="label" id="id204"><span class="brackets"><a class="fn-backref" href="#id21">BFL+17</a></span></dt>
<dd><p>David Balduzzi, Marcus Frean, Lennox Leary, J.¬†P. Lewis, Kurt¬†Wan-Duo Ma, and Brian McWilliams. The shattered gradients problem: if resnets are the answer, then what is the question? In Doina Precup and Yee¬†Whye Teh, editors, <em>Proceedings of the 34th International Conference on Machine Learning</em>, volume¬†70 of Proceedings of Machine Learning Research, 342‚Äì350. PMLR, 06‚Äì11 Aug 2017. URL: <a class="reference external" href="http://proceedings.mlr.press/v70/balduzzi17b.html">http://proceedings.mlr.press/v70/balduzzi17b.html</a>.</p>
</dd>
<dt class="label" id="id206"><span class="brackets">STY17</span><span class="fn-backref">(<a href="#id22">1</a>,<a href="#id24">2</a>)</span></dt>
<dd><p>Mukund Sundararajan, Ankur Taly, and Qiqi Yan. Axiomatic attribution for deep networks. In <em>International Conference on Machine Learning</em>, 3319‚Äì3328. PMLR, 2017.</p>
</dd>
<dt class="label" id="id207"><span class="brackets">STK+17</span><span class="fn-backref">(<a href="#id23">1</a>,<a href="#id25">2</a>)</span></dt>
<dd><p>Daniel Smilkov, Nikhil Thorat, Been Kim, Fernanda Vi√©gas, and Martin Wattenberg. Smoothgrad: removing noise by adding noise. <em>arXiv preprint arXiv:1706.03825</em>, 2017.</p>
</dd>
<dt class="label" id="id208"><span class="brackets"><a class="fn-backref" href="#id26">MBL+19</a></span></dt>
<dd><p>Gr√©goire Montavon, Alexander Binder, Sebastian Lapuschkin, Wojciech Samek, and Klaus-Robert M√ºller. <em>Layer-Wise Relevance Propagation: An Overview</em>, pages 193‚Äì209. Springer International Publishing, Cham, 2019. URL: <a class="reference external" href="https://link.springer.com/chapter/10.1007%2F978-3-030-28954-6_10">https://link.springer.com/chapter/10.1007%2F978-3-030-28954-6_10</a>.</p>
</dd>
<dt class="label" id="id210"><span class="brackets">vStrumbeljK14</span><span class="fn-backref">(<a href="#id28">1</a>,<a href="#id29">2</a>,<a href="#id30">3</a>,<a href="#id36">4</a>)</span></dt>
<dd><p>Erik ≈†trumbelj and Igor Kononenko. Explaining prediction models and individual predictions with feature contributions. <em>Knowledge and information systems</em>, 41(3):647‚Äì665, 2014.</p>
</dd>
<dt class="label" id="id211"><span class="brackets"><a class="fn-backref" href="#id32">BW21</a></span></dt>
<dd><p>Rainier Barrett and Andrew¬†D. White. Investigating active learning and meta-learning for iterative peptide design. <em>Journal of Chemical Information and Modeling</em>, 61(1):95‚Äì105, 2021. URL: <a class="reference external" href="https://doi.org/10.1021/acs.jcim.0c00946">https://doi.org/10.1021/acs.jcim.0c00946</a>, <a class="reference external" href="https://doi.org/10.1021/acs.jcim.0c00946">doi:10.1021/acs.jcim.0c00946</a>.</p>
</dd>
<dt class="label" id="id209"><span class="brackets"><a class="fn-backref" href="#id34">SLL20</a></span></dt>
<dd><p>Pascal Sturmfels, Scott Lundberg, and Su-In Lee. Visualizing the impact of feature attribution baselines. <em>Distill</em>, 2020. https://distill.pub/2020/attribution-baselines. <a class="reference external" href="https://doi.org/10.23915/distill.00022">doi:10.23915/distill.00022</a>.</p>
</dd>
<dt class="label" id="id246"><span class="brackets"><a class="fn-backref" href="#id38">CK18</a></span></dt>
<dd><p>Kangway¬†V Chuang and Michael¬†J Keiser. Comment on ‚Äúpredicting reaction performance in c‚Äìn cross-coupling using machine learning‚Äù. <em>Science</em>, 362(6416):eaat8603, 2018.</p>
</dd>
<dt class="label" id="id237"><span class="brackets"><a class="fn-backref" href="#id39">Lip18</a></span></dt>
<dd><p>Zachary¬†C Lipton. The mythos of model interpretability: in machine learning, the concept of interpretability is both important and slippery. <em>Queue</em>, 16(3):31‚Äì57, 2018.</p>
</dd>
<dt class="label" id="id236"><span class="brackets"><a class="fn-backref" href="#id40">KWG+18</a></span></dt>
<dd><p>Been Kim, Martin Wattenberg, Justin Gilmer, Carrie Cai, James Wexler, Fernanda Viegas, and others. Interpretability beyond feature attribution: quantitative testing with concept activation vectors (tcav). In <em>International conference on machine learning</em>, 2668‚Äì2677. PMLR, 2018.</p>
</dd>
<dt class="label" id="id212"><span class="brackets"><a class="fn-backref" href="#id49">NB20</a></span></dt>
<dd><p>Danilo Numeroso and Davide Bacciu. Explaining deep graph networks with molecular counterfactuals. <em>arXiv preprint arXiv:2011.05134</em>, 2020.</p>
</dd>
<dt class="label" id="id247"><span class="brackets"><a class="fn-backref" href="#id50">RH10</a></span></dt>
<dd><p>David Rogers and Mathew Hahn. Extended-connectivity fingerprints. <em>Journal of chemical information and modeling</em>, 50(5):742‚Äì754, 2010.</p>
</dd>
<dt class="label" id="id213"><span class="brackets"><a class="fn-backref" href="#id53">AZL21</a></span></dt>
<dd><p>Chirag Agarwal, Marinka Zitnik, and Himabindu Lakkaraju. Towards a rigorous theoretical analysis and evaluation of gnn explanations. <em>arXiv preprint arXiv:2106.09078</em>, 2021.</p>
</dd>
<dt class="label" id="id214"><span class="brackets"><a class="fn-backref" href="#id54">YYGJ20</a></span></dt>
<dd><p>Hao Yuan, Haiyang Yu, Shurui Gui, and Shuiwang Ji. Explainability in graph neural networks: a taxonomic survey. <em>arXiv preprint arXiv:2012.15445</em>, 2020.</p>
</dd>
<dt class="label" id="id217"><span class="brackets"><a class="fn-backref" href="#id55">MRC21</a></span></dt>
<dd><p>Andreas Madsen, Siva Reddy, and Sarath Chandar. Post-hoc interpretability for neural nlp: a survey. <em>arXiv preprint arXiv:2108.04840</em>, 2021.</p>
</dd>
<dt class="label" id="id231"><span class="brackets"><a class="fn-backref" href="#id60">NPK+21</a></span></dt>
<dd><p>AkshatKumar Nigam, Robert Pollice, Mario Krenn, Gabriel dos¬†Passos Gomes, and Al√°n Aspuru-Guzik. Beyond generative models: superfast traversal, optimization, novelty, exploration and discovery (stoned) algorithm for molecules using selfies. <em>Chem. Sci.</em>, 12:7079‚Äì7090, 2021. URL: <a class="reference external" href="http://dx.doi.org/10.1039/D1SC00231G">http://dx.doi.org/10.1039/D1SC00231G</a>, <a class="reference external" href="https://doi.org/10.1039/D1SC00231G">doi:10.1039/D1SC00231G</a>.</p>
</dd>
</dl>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./dl"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="molnets.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">11. </span>Modern Molecular NNs</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="attention.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">13. </span>„Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„É¨„Ç§„É§„Éº</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Andrew D. White<br/>
    
        &copy; Copyright 2022.<br/>
      <div class="extra_footer">
        <a href="http://thewhitelab.org">thewhitelab.org</a> <div id="wh-modal"> <button class="wh-venti-button" aria-label="close modal" id="wh-modal-close">‚úï</button> <img id="wh-modal-img"> </div>
      </div>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>